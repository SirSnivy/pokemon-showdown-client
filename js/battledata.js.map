{"version":3,"sources":["battle-dex.ts","battle-dex-data.ts","battle-log.ts","battle-log-misc.js","battle-text-parser.ts"],"names":[],"mappings":"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","file":"battledata.js","sourcesContent":["/**\r\n * Pokemon Showdown Dex\r\n *\r\n * Roughly equivalent to sim/dex.js in a Pokemon Showdown server, but\r\n * designed for use in browsers rather than in Node.\r\n *\r\n * This is a generic utility library for Pokemon Showdown code: any\r\n * code shared between the replay viewer and the client usually ends up\r\n * here.\r\n *\r\n * Licensing note: PS's client has complicated licensing:\r\n * - The client as a whole is AGPLv3\r\n * - The battle replay/animation engine (battle-*.ts) by itself is MIT\r\n *\r\n * Compiled into battledata.js which includes all dependencies\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license MIT\r\n */\r\n\r\ndeclare var require: any;\r\ndeclare var global: any;\r\n\r\nif (typeof window === 'undefined') {\r\n\t// Node\r\n\t(global as any).window = global;\r\n} else {\r\n\t// browser (possibly NW.js!)\r\n\twindow.exports = window;\r\n}\r\n\r\n// @ts-ignore\r\nwindow.nodewebkit = !!(typeof process !== 'undefined' && process.versions && process.versions['node-webkit']);\r\n\r\nfunction toID(text: any) {\r\n\tif (text?.id) {\r\n\t\ttext = text.id;\r\n\t} else if (text?.userid) {\r\n\t\ttext = text.userid;\r\n\t}\r\n\tif (typeof text !== 'string' && typeof text !== 'number') return '' as ID;\r\n\treturn ('' + text).toLowerCase().replace(/[^a-z0-9]+/g, '') as ID;\r\n}\r\n\r\nfunction toUserid(text: any) {\r\n\treturn toID(text);\r\n}\r\n\r\ntype Comparable = number | string | boolean | Comparable[] | {reverse: Comparable};\r\nconst PSUtils = new class {\r\n\t/**\r\n\t * Like string.split(delimiter), but only recognizes the first `limit`\r\n\t * delimiters (default 1).\r\n\t *\r\n\t * `\"1 2 3 4\".split(\" \", 2) => [\"1\", \"2\"]`\r\n\t *\r\n\t * `splitFirst(\"1 2 3 4\", \" \", 1) => [\"1\", \"2 3 4\"]`\r\n\t *\r\n\t * Returns an array of length exactly limit + 1.\r\n\t */\r\n\tsplitFirst(str: string, delimiter: string, limit: number = 1) {\r\n\t\tlet splitStr: string[] = [];\r\n\t\twhile (splitStr.length < limit) {\r\n\t\t\tlet delimiterIndex = str.indexOf(delimiter);\r\n\t\t\tif (delimiterIndex >= 0) {\r\n\t\t\t\tsplitStr.push(str.slice(0, delimiterIndex));\r\n\t\t\t\tstr = str.slice(delimiterIndex + delimiter.length);\r\n\t\t\t} else {\r\n\t\t\t\tsplitStr.push(str);\r\n\t\t\t\tstr = '';\r\n\t\t\t}\r\n\t\t}\r\n\t\tsplitStr.push(str);\r\n\t\treturn splitStr;\r\n\t}\r\n\r\n\t/**\r\n\t * Compares two variables; intended to be used as a smarter comparator.\r\n\t * The two variables must be the same type (TypeScript will not check this).\r\n\t *\r\n\t * - Numbers are sorted low-to-high, use `-val` to reverse\r\n\t * - Strings are sorted A to Z case-semi-insensitively, use `{reverse: val}` to reverse\r\n\t * - Booleans are sorted true-first (REVERSE of casting to numbers), use `!val` to reverse\r\n\t * - Arrays are sorted lexically in the order of their elements\r\n\t *\r\n\t * In other words: `[num, str]` will be sorted A to Z, `[num, {reverse: str}]` will be sorted Z to A.\r\n\t */\r\n\tcompare(a: Comparable, b: Comparable): number {\r\n\t\tif (typeof a === 'number') {\r\n\t\t\treturn a - (b as number);\r\n\t\t}\r\n\t\tif (typeof a === 'string') {\r\n\t\t\treturn a.localeCompare(b as string);\r\n\t\t}\r\n\t\tif (typeof a === 'boolean') {\r\n\t\t\treturn (a ? 1 : 2) - (b ? 1 : 2);\r\n\t\t}\r\n\t\tif (Array.isArray(a)) {\r\n\t\t\tfor (let i = 0; i < a.length; i++) {\r\n\t\t\t\tconst comparison = PSUtils.compare(a[i], (b as Comparable[])[i]);\r\n\t\t\t\tif (comparison) return comparison;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tif (a.reverse) {\r\n\t\t\treturn PSUtils.compare((b as {reverse: string}).reverse, a.reverse);\r\n\t\t}\r\n\t\tthrow new Error(`Passed value ${a} is not comparable`);\r\n\t}\r\n\t/**\r\n\t * Sorts an array according to the callback's output on its elements.\r\n\t *\r\n\t * The callback's output is compared according to `PSUtils.compare` (in\r\n\t * particular, it supports arrays so you can sort by multiple things).\r\n\t */\r\n\tsortBy<T>(array: T[], callback: (a: T) => Comparable): T[];\r\n\t/**\r\n\t * Sorts an array according to `PSUtils.compare`. (Correctly sorts numbers,\r\n\t * unlike `array.sort`)\r\n\t */\r\n\tsortBy<T extends Comparable>(array: T[]): T[];\r\n\tsortBy<T>(array: T[], callback?: (a: T) => Comparable) {\r\n\t\tif (!callback) return (array as any[]).sort(PSUtils.compare);\r\n\t\treturn array.sort((a, b) => PSUtils.compare(callback(a), callback(b)));\r\n\t}\r\n};\r\n\r\n/**\r\n * Sanitize a room ID by removing anything that isn't alphanumeric or `-`.\r\n * Shouldn't actually do anything except against malicious input.\r\n */\r\nfunction toRoomid(roomid: string) {\r\n\treturn roomid.replace(/[^a-zA-Z0-9-]+/g, '').toLowerCase();\r\n}\r\n\r\nfunction toName(name: any) {\r\n\tif (typeof name !== 'string' && typeof name !== 'number') return '';\r\n\tname = ('' + name).replace(/[\\|\\s\\[\\]\\,\\u202e]+/g, ' ').trim();\r\n\tif (name.length > 18) name = name.substr(0, 18).trim();\r\n\r\n\t// remove zalgo\r\n\tname = name.replace(\r\n\t\t/[\\u0300-\\u036f\\u0483-\\u0489\\u0610-\\u0615\\u064B-\\u065F\\u0670\\u06D6-\\u06DC\\u06DF-\\u06ED\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E]{3,}/g,\r\n\t\t''\r\n\t);\r\n\tname = name.replace(/[\\u239b-\\u23b9]/g, '');\r\n\r\n\treturn name;\r\n}\r\n\r\ninterface SpriteData {\r\n\tw: number;\r\n\th: number;\r\n\ty?: number;\r\n\tgen?: number;\r\n\turl?: string;\r\n\trawHTML?: string;\r\n\tpixelated?: boolean;\r\n\tisFrontSprite?: boolean;\r\n\tcryurl?: string;\r\n\tshiny?: boolean;\r\n}\r\n\r\ninterface TeambuilderSpriteData {\r\n\tx: number;\r\n\ty: number;\r\n\tspriteDir: string;\r\n\tspriteid: string;\r\n\tshiny?: boolean;\r\n}\r\n\r\nconst Dex = new class implements ModdedDex {\r\n\treadonly gen = 8;\r\n\treadonly modid = 'gen8' as ID;\r\n\treadonly cache = null!;\r\n\r\n\treadonly statNames: ReadonlyArray<StatName> = ['hp', 'atk', 'def', 'spa', 'spd', 'spe'];\r\n\treadonly statNamesExceptHP: ReadonlyArray<StatNameExceptHP> = ['atk', 'def', 'spa', 'spd', 'spe'];\r\n\r\n\tpokeballs: string[] | null = null;\r\n\r\n\tresourcePrefix = (() => {\r\n\t\tlet prefix = '';\r\n\t\tif (window.document?.location?.protocol !== 'http:') prefix = 'https:';\r\n\t\treturn `${prefix}//${window.Config ? Config.routes.client : 'play.pokemonshowdown.com'}/`;\r\n\t})();\r\n\r\n\tfxPrefix = (() => {\r\n\t\tif (window.document?.location?.protocol === 'file:') {\r\n\t\t\tif (window.Replays) return `https://${window.Config ? Config.routes.client : 'play.pokemonshowdown.com'}/fx/`;\r\n\t\t\treturn `fx/`;\r\n\t\t}\r\n\t\treturn `//${window.Config ? Config.routes.client : 'play.pokemonshowdown.com'}/fx/`;\r\n\t})();\r\n\r\n\tloadedSpriteData = {xy: 1, bw: 0};\r\n\tmoddedDexes: {[mod: string]: ModdedDex} = {};\r\n\r\n\tmod(modid: ID): ModdedDex {\r\n\t\tif (modid === 'gen8') return this;\r\n\t\tif (!window.BattleTeambuilderTable) return this;\r\n\t\tif (modid in this.moddedDexes) {\r\n\t\t\treturn this.moddedDexes[modid];\r\n\t\t}\r\n\t\tthis.moddedDexes[modid] = new ModdedDex(modid);\r\n\t\treturn this.moddedDexes[modid];\r\n\t}\r\n\tforGen(gen: number) {\r\n\t\tif (!gen) return this;\r\n\t\treturn this.mod(`gen${gen}` as ID);\r\n\t}\r\n\r\n\tresolveAvatar(avatar: string): string {\r\n\t\tif (window.BattleAvatarNumbers && avatar in BattleAvatarNumbers) {\r\n\t\t\tavatar = BattleAvatarNumbers[avatar];\r\n\t\t}\r\n\t\tif (avatar.charAt(0) === '#') {\r\n\t\t\treturn Dex.resourcePrefix + 'sprites/trainers-custom/' + toID(avatar.substr(1)) + '.png';\r\n\t\t}\r\n\t\tif (avatar.includes('.') && window.Config?.server?.registered) {\r\n\t\t\t// custom avatar served by the server\r\n\t\t\tlet protocol = (Config.server.port === 443) ? 'https' : 'http';\r\n\t\t\treturn protocol + '://' + Config.server.host + ':' + Config.server.port +\r\n\t\t\t\t'/avatars/' + encodeURIComponent(avatar).replace(/\\%3F/g, '?');\r\n\t\t}\r\n\t\treturn Dex.resourcePrefix + 'sprites/trainers/' + Dex.sanitizeName(avatar || 'unknown') + '.png';\r\n\t}\r\n\r\n\t/**\r\n\t * This is used to sanitize strings from data files like `moves.js` and\r\n\t * `teambuilder-tables.js`.\r\n\t *\r\n\t * This makes sure untrusted strings can't wreak havoc if someone forgets to\r\n\t * escape it before putting it in HTML.\r\n\t *\r\n\t * None of these characters belong in these files, anyway. (They can be used\r\n\t * in move descriptions, but those are served from `text.js`, which are\r\n\t * definitely always treated as unsanitized.)\r\n\t */\r\n\tsanitizeName(name: any) {\r\n\t\tif (!name) return '';\r\n\t\treturn ('' + name)\r\n\t\t\t.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;')\r\n\t\t\t.slice(0, 50);\r\n\t}\r\n\r\n\tprefs(prop: string) {\r\n\t\t// @ts-ignore\r\n\t\treturn window.Storage?.prefs?.(prop);\r\n\t}\r\n\r\n\tgetShortName(name: string) {\r\n\t\tlet shortName = name.replace(/[^A-Za-z0-9]+$/, '');\r\n\t\tif (shortName.indexOf('(') >= 0) {\r\n\t\t\tshortName += name.slice(shortName.length).replace(/[^\\(\\)]+/g, '').replace(/\\(\\)/g, '');\r\n\t\t}\r\n\t\treturn shortName;\r\n\t}\r\n\r\n\tgetEffect(name: string | null | undefined): PureEffect | Item | Ability | Move {\r\n\t\tname = (name || '').trim();\r\n\t\tif (name.substr(0, 5) === 'item:') {\r\n\t\t\treturn Dex.items.get(name.substr(5).trim());\r\n\t\t} else if (name.substr(0, 8) === 'ability:') {\r\n\t\t\treturn Dex.abilities.get(name.substr(8).trim());\r\n\t\t} else if (name.substr(0, 5) === 'move:') {\r\n\t\t\treturn Dex.moves.get(name.substr(5).trim());\r\n\t\t}\r\n\t\tlet id = toID(name);\r\n\t\treturn new PureEffect(id, name);\r\n\t}\r\n\r\n\tmoves = {\r\n\t\tget: (nameOrMove: string | Move | null | undefined): Move => {\r\n\t\t\tif (nameOrMove && typeof nameOrMove !== 'string') {\r\n\t\t\t\t// TODO: don't accept Moves here\r\n\t\t\t\treturn nameOrMove;\r\n\t\t\t}\r\n\t\t\tlet name = nameOrMove || '';\r\n\t\t\tlet id = toID(nameOrMove);\r\n\t\t\tif (window.BattleAliases && id in BattleAliases) {\r\n\t\t\t\tname = BattleAliases[id];\r\n\t\t\t\tid = toID(name);\r\n\t\t\t}\r\n\t\t\tif (!window.BattleMovedex) window.BattleMovedex = {};\r\n\t\t\tlet data = window.BattleMovedex[id];\r\n\t\t\tif (data && typeof data.exists === 'boolean') return data;\r\n\r\n\t\t\tif (!data && id.substr(0, 11) === 'hiddenpower' && id.length > 11) {\r\n\t\t\t\tlet [, hpWithType, hpPower] = /([a-z]*)([0-9]*)/.exec(id)!;\r\n\t\t\t\tdata = {\r\n\t\t\t\t\t...(window.BattleMovedex[hpWithType] || {}),\r\n\t\t\t\t\tbasePower: Number(hpPower) || 60,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tif (!data && id.substr(0, 6) === 'return' && id.length > 6) {\r\n\t\t\t\tdata = {\r\n\t\t\t\t\t...(window.BattleMovedex['return'] || {}),\r\n\t\t\t\t\tbasePower: Number(id.slice(6)),\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tif (!data && id.substr(0, 11) === 'frustration' && id.length > 11) {\r\n\t\t\t\tdata = {\r\n\t\t\t\t\t...(window.BattleMovedex['frustration'] || {}),\r\n\t\t\t\t\tbasePower: Number(id.slice(11)),\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tif (!data) data = {exists: false};\r\n\t\t\tlet move = new Move(id, name, data);\r\n\t\t\twindow.BattleMovedex[id] = move;\r\n\t\t\treturn move;\r\n\t\t},\r\n\t};\r\n\r\n\tgetGen3Category(type: string) {\r\n\t\treturn [\r\n\t\t\t'Fire', 'Water', 'Grass', 'Electric', 'Ice', 'Psychic', 'Dark', 'Dragon',\r\n\t\t].includes(type) ? 'Special' : 'Physical';\r\n\t}\r\n\r\n\titems = {\r\n\t\tget: (nameOrItem: string | Item | null | undefined): Item => {\r\n\t\t\tif (nameOrItem && typeof nameOrItem !== 'string') {\r\n\t\t\t\t// TODO: don't accept Items here\r\n\t\t\t\treturn nameOrItem;\r\n\t\t\t}\r\n\t\t\tlet name = nameOrItem || '';\r\n\t\t\tlet id = toID(nameOrItem);\r\n\t\t\tif (window.BattleAliases && id in BattleAliases) {\r\n\t\t\t\tname = BattleAliases[id];\r\n\t\t\t\tid = toID(name);\r\n\t\t\t}\r\n\t\t\tif (!window.BattleItems) window.BattleItems = {};\r\n\t\t\tlet data = window.BattleItems[id];\r\n\t\t\tif (data && typeof data.exists === 'boolean') return data;\r\n\t\t\tif (!data) data = {exists: false};\r\n\t\t\tlet item = new Item(id, name, data);\r\n\t\t\twindow.BattleItems[id] = item;\r\n\t\t\treturn item;\r\n\t\t},\r\n\t};\r\n\r\n\tabilities = {\r\n\t\tget: (nameOrAbility: string | Ability | null | undefined): Ability => {\r\n\t\t\tif (nameOrAbility && typeof nameOrAbility !== 'string') {\r\n\t\t\t\t// TODO: don't accept Abilities here\r\n\t\t\t\treturn nameOrAbility;\r\n\t\t\t}\r\n\t\t\tlet name = nameOrAbility || '';\r\n\t\t\tlet id = toID(nameOrAbility);\r\n\t\t\tif (window.BattleAliases && id in BattleAliases) {\r\n\t\t\t\tname = BattleAliases[id];\r\n\t\t\t\tid = toID(name);\r\n\t\t\t}\r\n\t\t\tif (!window.BattleAbilities) window.BattleAbilities = {};\r\n\t\t\tlet data = window.BattleAbilities[id];\r\n\t\t\tif (data && typeof data.exists === 'boolean') return data;\r\n\t\t\tif (!data) data = {exists: false};\r\n\t\t\tlet ability = new Ability(id, name, data);\r\n\t\t\twindow.BattleAbilities[id] = ability;\r\n\t\t\treturn ability;\r\n\t\t},\r\n\t};\r\n\r\n\tspecies = {\r\n\t\tget: (nameOrSpecies: string | Species | null | undefined): Species => {\r\n\t\t\tif (nameOrSpecies && typeof nameOrSpecies !== 'string') {\r\n\t\t\t\t// TODO: don't accept Species' here\r\n\t\t\t\treturn nameOrSpecies;\r\n\t\t\t}\r\n\t\t\tlet name = nameOrSpecies || '';\r\n\t\t\tlet id = toID(nameOrSpecies);\r\n\t\t\tlet formid = id;\r\n\t\t\tif (!window.BattlePokedexAltForms) window.BattlePokedexAltForms = {};\r\n\t\t\tif (formid in window.BattlePokedexAltForms) return window.BattlePokedexAltForms[formid];\r\n\t\t\tif (window.BattleAliases && id in BattleAliases) {\r\n\t\t\t\tname = BattleAliases[id];\r\n\t\t\t\tid = toID(name);\r\n\t\t\t} else if (window.BattlePokedex && !(id in BattlePokedex) && window.BattleBaseSpeciesChart) {\r\n\t\t\t\tfor (const baseSpeciesId of BattleBaseSpeciesChart) {\r\n\t\t\t\t\tif (formid.startsWith(baseSpeciesId)) {\r\n\t\t\t\t\t\tid = baseSpeciesId;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!window.BattlePokedex) window.BattlePokedex = {};\r\n\t\t\tlet data = window.BattlePokedex[id];\r\n\r\n\t\t\tlet species: Species;\r\n\t\t\tif (data && typeof data.exists === 'boolean') {\r\n\t\t\t\tspecies = data;\r\n\t\t\t} else {\r\n\t\t\t\tif (!data) data = {exists: false};\r\n\t\t\t\tif (!data.tier && id.slice(-5) === 'totem') {\r\n\t\t\t\t\tdata.tier = this.species.get(id.slice(0, -5)).tier;\r\n\t\t\t\t}\r\n\t\t\t\tif (!data.tier && data.baseSpecies && toID(data.baseSpecies) !== id) {\r\n\t\t\t\t\tdata.tier = this.species.get(data.baseSpecies).tier;\r\n\t\t\t\t}\r\n\t\t\t\tspecies = new Species(id, name, data);\r\n\t\t\t\twindow.BattlePokedex[id] = species;\r\n\t\t\t}\r\n\r\n\t\t\tif (species.cosmeticFormes) {\r\n\t\t\t\tfor (const forme of species.cosmeticFormes) {\r\n\t\t\t\t\tif (toID(forme) === formid) {\r\n\t\t\t\t\t\tspecies = new Species(formid, name, {\r\n\t\t\t\t\t\t\t...species,\r\n\t\t\t\t\t\t\tname: forme,\r\n\t\t\t\t\t\t\tforme: forme.slice(species.name.length + 1),\r\n\t\t\t\t\t\t\tbaseForme: \"\",\r\n\t\t\t\t\t\t\tbaseSpecies: species.name,\r\n\t\t\t\t\t\t\totherFormes: null,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\twindow.BattlePokedexAltForms[formid] = species;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn species;\r\n\t\t},\r\n\t};\r\n\r\n\ttypes = {\r\n\t\tallCache: null as Type[] | null,\r\n\t\tget: (type: any): Type => {\r\n\t\t\tif (!type || typeof type === 'string') {\r\n\t\t\t\tconst id = toID(type) as string;\r\n\t\t\t\tconst name = id.substr(0, 1).toUpperCase() + id.substr(1);\r\n\t\t\t\ttype = (window.BattleTypeChart && window.BattleTypeChart[id]) || {};\r\n\t\t\t\tif (type.damageTaken) type.exists = true;\r\n\t\t\t\tif (!type.id) type.id = id;\r\n\t\t\t\tif (!type.name) type.name = name;\r\n\t\t\t\tif (!type.effectType) {\r\n\t\t\t\t\ttype.effectType = 'Type';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn type;\r\n\t\t},\r\n\t\tall: (): readonly Type[] => {\r\n\t\t\tif (this.types.allCache) return this.types.allCache;\r\n\t\t\tconst types = [];\r\n\t\t\tfor (const id in (window.BattleTypeChart || {})) {\r\n\t\t\t\ttypes.push(Dex.types.get(id));\r\n\t\t\t}\r\n\t\t\tif (types.length) this.types.allCache = types;\r\n\t\t\treturn types;\r\n\t\t},\r\n\t\tisName: (name: string | null): boolean => {\r\n\t\t\tconst id = toID(name);\r\n\t\t\tif (name !== id.substr(0, 1).toUpperCase() + id.substr(1)) return false;\r\n\t\t\treturn (window.BattleTypeChart || {}).hasOwnProperty(id);\r\n\t\t},\r\n\t};\r\n\r\n\thasAbility(species: Species, ability: string) {\r\n\t\tfor (const i in species.abilities) {\r\n\t\t\t// @ts-ignore\r\n\t\t\tif (ability === species.abilities[i]) return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tloadSpriteData(gen: 'xy' | 'bw') {\r\n\t\tif (this.loadedSpriteData[gen]) return;\r\n\t\tthis.loadedSpriteData[gen] = 1;\r\n\r\n\t\tlet path = $('script[src*=\"pokedex-mini.js\"]').attr('src') || '';\r\n\t\tlet qs = '?' + (path.split('?')[1] || '');\r\n\t\tpath = (path.match(/.+?(?=data\\/pokedex-mini\\.js)/) || [])[0] || '';\r\n\r\n\t\tlet el = document.createElement('script');\r\n\t\tel.src = path + 'data/pokedex-mini-bw.js' + qs;\r\n\t\tdocument.getElementsByTagName('body')[0].appendChild(el);\r\n\t}\r\n\tgetSpriteData(pokemon: Pokemon | Species | string, isFront: boolean, options: {\r\n\t\tgen?: number,\r\n\t\tshiny?: boolean,\r\n\t\tgender?: GenderName,\r\n\t\tafd?: boolean,\r\n\t\tnoScale?: boolean,\r\n\t\tmod?: string,\r\n\t\tdynamax?: boolean,\r\n\t} = {gen: 6}) {\r\n\t\tconst mechanicsGen = options.gen || 6;\r\n\t\tlet isDynamax = !!options.dynamax;\r\n\t\tif (pokemon instanceof Pokemon) {\r\n\t\t\tif (pokemon.volatiles.transform) {\r\n\t\t\t\toptions.shiny = pokemon.volatiles.transform[2];\r\n\t\t\t\toptions.gender = pokemon.volatiles.transform[3];\r\n\t\t\t} else {\r\n\t\t\t\toptions.shiny = pokemon.shiny;\r\n\t\t\t\toptions.gender = pokemon.gender;\r\n\t\t\t}\r\n\t\t\tif (pokemon.volatiles.dynamax && options.dynamax !== false) isDynamax = true;\r\n\t\t\tpokemon = pokemon.getSpeciesForme();\r\n\t\t}\r\n\t\tconst species = Dex.species.get(pokemon);\r\n\t\t// Gmax sprites are already extremely large, so we don't need to double.\r\n\t\tif (species.name.endsWith('-Gmax')) isDynamax = false;\r\n\t\tlet spriteData = {\r\n\t\t\tgen: mechanicsGen,\r\n\t\t\tw: 96,\r\n\t\t\th: 96,\r\n\t\t\ty: 0,\r\n\t\t\turl: Dex.resourcePrefix + 'sprites/',\r\n\t\t\tpixelated: true,\r\n\t\t\tisFrontSprite: false,\r\n\t\t\tcryurl: '',\r\n\t\t\tshiny: options.shiny,\r\n\t\t};\r\n\t\tlet name = species.spriteid;\r\n\t\tlet dir;\r\n\t\tlet facing;\r\n\t\tif (isFront) {\r\n\t\t\tspriteData.isFrontSprite = true;\r\n\t\t\tdir = '';\r\n\t\t\tfacing = 'front';\r\n\t\t} else {\r\n\t\t\tdir = '-back';\r\n\t\t\tfacing = 'back';\r\n\t\t}\r\n\r\n\t\t// Decide which gen sprites to use.\r\n\t\t//\r\n\t\t// There are several different generations we care about here:\r\n\t\t//\r\n\t\t//   - mechanicsGen: the generation number of the mechanics and battle (options.gen)\r\n\t\t//   - graphicsGen: the generation number of sprite/field graphics the user has requested.\r\n\t\t//     This will default to mechanicsGen, but may be altered depending on user preferences.\r\n\t\t//   - spriteData.gen: the generation number of a the specific Pokemon sprite in question.\r\n\t\t//     This defaults to graphicsGen, but if the graphicsGen doesn't have a sprite for the Pokemon\r\n\t\t//     (eg. Darmanitan in graphicsGen 2) then we go up gens until it exists.\r\n\t\t//\r\n\t\tlet graphicsGen = mechanicsGen;\r\n\t\tif (Dex.prefs('nopastgens')) graphicsGen = 6;\r\n\t\tif (Dex.prefs('bwgfx') && graphicsGen >= 6) graphicsGen = 5;\r\n\t\tspriteData.gen = Math.max(graphicsGen, Math.min(species.gen, 5));\r\n\t\tconst baseDir = ['', 'gen1', 'gen2', 'gen3', 'gen4', 'gen5', '', '', ''][spriteData.gen];\r\n\r\n\t\tlet animationData = null;\r\n\t\tlet miscData = null;\r\n\t\tlet speciesid = species.id;\r\n\t\tif (species.isTotem) speciesid = toID(name);\r\n\t\tif (baseDir === '' && window.BattlePokemonSprites) {\r\n\t\t\tanimationData = BattlePokemonSprites[speciesid];\r\n\t\t}\r\n\t\tif (baseDir === 'gen5' && window.BattlePokemonSpritesBW) {\r\n\t\t\tanimationData = BattlePokemonSpritesBW[speciesid];\r\n\t\t}\r\n\t\tif (window.BattlePokemonSprites) miscData = BattlePokemonSprites[speciesid];\r\n\t\tif (!miscData && window.BattlePokemonSpritesBW) miscData = BattlePokemonSpritesBW[speciesid];\r\n\t\tif (!animationData) animationData = {};\r\n\t\tif (!miscData) miscData = {};\r\n\r\n\t\tif (miscData.num !== 0 && miscData.num > -5000) {\r\n\t\t\tlet baseSpeciesid = toID(species.baseSpecies);\r\n\t\t\tspriteData.cryurl = 'audio/cries/' + baseSpeciesid;\r\n\t\t\tlet formeid = species.formeid;\r\n\t\t\tif (species.isMega || formeid && (\r\n\t\t\t\tformeid === '-crowned' ||\r\n\t\t\t\tformeid === '-eternal' ||\r\n\t\t\t\tformeid === '-eternamax' ||\r\n\t\t\t\tformeid === '-hangry' ||\r\n\t\t\t\tformeid === '-lowkey' ||\r\n\t\t\t\tformeid === '-noice' ||\r\n\t\t\t\tformeid === '-primal' ||\r\n\t\t\t\tformeid === '-rapidstrike' ||\r\n\t\t\t\tformeid === '-school' ||\r\n\t\t\t\tformeid === '-sky' ||\r\n\t\t\t\tformeid === '-starter' ||\r\n\t\t\t\tformeid === '-super' ||\r\n\t\t\t\tformeid === '-therian' ||\r\n\t\t\t\tformeid === '-unbound' ||\r\n\t\t\t\tbaseSpeciesid === 'calyrex' ||\r\n\t\t\t\tbaseSpeciesid === 'kyurem' ||\r\n\t\t\t\tbaseSpeciesid === 'cramorant' ||\r\n\t\t\t\tbaseSpeciesid === 'indeedee' ||\r\n\t\t\t\tbaseSpeciesid === 'lycanroc' ||\r\n\t\t\t\tbaseSpeciesid === 'necrozma' ||\r\n\t\t\t\tbaseSpeciesid === 'oricorio' ||\r\n\t\t\t\tbaseSpeciesid === 'slowpoke' ||\r\n\t\t\t\tbaseSpeciesid === 'zygarde'\r\n\t\t\t)) {\r\n\t\t\t\tspriteData.cryurl += formeid;\r\n\t\t\t}\r\n\t\t\tspriteData.cryurl += '.mp3';\r\n\t\t}\r\n\r\n\t\tif (options.shiny && mechanicsGen > 1) dir += '-shiny';\r\n\r\n\t\t// April Fool's 2014\r\n\t\tif (window.Config && Config.server && Config.server.afd || options.afd) {\r\n\t\t\tdir = 'afd' + dir;\r\n\t\t\tspriteData.url += dir + '/' + name + '.png';\r\n\t\t\t// Duplicate code but needed to make AFD tinymax work\r\n\t\t\t// April Fool's 2020\r\n\t\t\tif (isDynamax && !options.noScale) {\r\n\t\t\t\tspriteData.w *= 0.25;\r\n\t\t\t\tspriteData.h *= 0.25;\r\n\t\t\t\tspriteData.y += -22;\r\n\t\t\t} else if (species.isTotem && !options.noScale) {\r\n\t\t\t\tspriteData.w *= 0.5;\r\n\t\t\t\tspriteData.h *= 0.5;\r\n\t\t\t\tspriteData.y += -11;\r\n\t\t\t}\r\n\t\t\treturn spriteData;\r\n\t\t}\r\n\r\n\t\t// Mod Cries\r\n\t\tif (options.mod) {\r\n\t\t\tspriteData.cryurl = `sprites/${options.mod}/audio/${toID(species.baseSpecies)}`;\r\n\t\t\tspriteData.cryurl += '.mp3';\r\n\t\t}\r\n\r\n\t\tif (animationData[facing + 'f'] && options.gender === 'F') facing += 'f';\r\n\t\tlet allowAnim = !Dex.prefs('noanim') && !Dex.prefs('nogif');\r\n\t\tif (allowAnim && spriteData.gen >= 6) spriteData.pixelated = false;\r\n\t\tif (allowAnim && animationData[facing] && spriteData.gen >= 5) {\r\n\t\t\tif (facing.slice(-1) === 'f') name += '-f';\r\n\t\t\tdir = baseDir + 'ani' + dir;\r\n\r\n\t\t\tspriteData.w = animationData[facing].w;\r\n\t\t\tspriteData.h = animationData[facing].h;\r\n\t\t\tspriteData.url += dir + '/' + name + '.gif';\r\n\t\t} else {\r\n\t\t\t// There is no entry or enough data in pokedex-mini.js\r\n\t\t\t// Handle these in case-by-case basis; either using BW sprites or matching the played gen.\r\n\t\t\tdir = (baseDir || 'gen5') + dir;\r\n\r\n\t\t\t// Gender differences don't exist prior to Gen 4,\r\n\t\t\t// so there are no sprites for it\r\n\t\t\tif (spriteData.gen >= 4 && miscData['frontf'] && options.gender === 'F') {\r\n\t\t\t\tname += '-f';\r\n\t\t\t}\r\n\r\n\t\t\tspriteData.url += dir + '/' + name + '.png';\r\n\t\t}\r\n\r\n\t\tif (!options.noScale) {\r\n\t\t\tif (graphicsGen > 4) {\r\n\t\t\t\t// no scaling\r\n\t\t\t} else if (spriteData.isFrontSprite) {\r\n\t\t\t\tspriteData.w *= 2;\r\n\t\t\t\tspriteData.h *= 2;\r\n\t\t\t\tspriteData.y += -16;\r\n\t\t\t} else {\r\n\t\t\t\t// old gen backsprites are multiplied by 1.5x by the 3D engine\r\n\t\t\t\tspriteData.w *= 2 / 1.5;\r\n\t\t\t\tspriteData.h *= 2 / 1.5;\r\n\t\t\t\tspriteData.y += -11;\r\n\t\t\t}\r\n\t\t\tif (spriteData.gen <= 2) spriteData.y += 2;\r\n\t\t}\r\n\t\tif (isDynamax && !options.noScale) {\r\n\t\t\tspriteData.w *= 2;\r\n\t\t\tspriteData.h *= 2;\r\n\t\t\tspriteData.y += -22;\r\n\t\t} else if (species.isTotem && !options.noScale) {\r\n\t\t\tspriteData.w *= 1.5;\r\n\t\t\tspriteData.h *= 1.5;\r\n\t\t\tspriteData.y += -11;\r\n\t\t}\r\n\r\n\t\treturn spriteData;\r\n\t}\r\n\r\n\tgetPokemonIconNum(id: ID, isFemale?: boolean, facingLeft?: boolean) {\r\n\t\tlet num = 0;\r\n\t\tif (window.BattlePokemonSprites?.[id]?.num) {\r\n\t\t\tnum = BattlePokemonSprites[id].num;\r\n\t\t} else if (window.BattlePokedex?.[id]?.num) {\r\n\t\t\tnum = BattlePokedex[id].num;\r\n\t\t}\r\n\t\tif (num < 0) num = 0;\r\n\t\tif (num > 898) num = 0;\r\n\r\n\t\tif (window.BattlePokemonIconIndexes?.[id]) {\r\n\t\t\tnum = BattlePokemonIconIndexes[id];\r\n\t\t}\r\n\r\n\t\tif (isFemale) {\r\n\t\t\tif (['unfezant', 'frillish', 'jellicent', 'meowstic', 'pyroar'].includes(id)) {\r\n\t\t\t\tnum = BattlePokemonIconIndexes[id + 'f'];\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (facingLeft) {\r\n\t\t\tif (BattlePokemonIconIndexesLeft[id]) {\r\n\t\t\t\tnum = BattlePokemonIconIndexesLeft[id];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn num;\r\n\t}\r\n\r\n\tgetPokemonIcon(pokemon: string | Pokemon | ServerPokemon | PokemonSet | null, facingLeft?: boolean) {\r\n\t\tif (pokemon === 'pokeball') {\r\n\t\t\treturn `background:transparent url(${Dex.resourcePrefix}sprites/pokemonicons-pokeball-sheet.png) no-repeat scroll -0px 4px`;\r\n\t\t} else if (pokemon === 'pokeball-statused') {\r\n\t\t\treturn `background:transparent url(${Dex.resourcePrefix}sprites/pokemonicons-pokeball-sheet.png) no-repeat scroll -40px 4px`;\r\n\t\t} else if (pokemon === 'pokeball-fainted') {\r\n\t\t\treturn `background:transparent url(${Dex.resourcePrefix}sprites/pokemonicons-pokeball-sheet.png) no-repeat scroll -80px 4px;opacity:.4;filter:contrast(0)`;\r\n\t\t} else if (pokemon === 'pokeball-none') {\r\n\t\t\treturn `background:transparent url(${Dex.resourcePrefix}sprites/pokemonicons-pokeball-sheet.png) no-repeat scroll -80px 4px`;\r\n\t\t}\r\n\r\n\t\tlet id = toID(pokemon);\r\n\t\tif (!pokemon || typeof pokemon === 'string') pokemon = null;\r\n\t\t// @ts-ignore\r\n\t\tif (pokemon?.speciesForme) id = toID(pokemon.speciesForme);\r\n\t\t// @ts-ignore\r\n\t\tif (pokemon?.species) id = toID(pokemon.species);\r\n\t\t// @ts-ignore\r\n\t\tif (pokemon?.volatiles?.formechange && !pokemon.volatiles.transform) {\r\n\t\t\t// @ts-ignore\r\n\t\t\tid = toID(pokemon.volatiles.formechange[1]);\r\n\t\t}\r\n\t\tlet num = this.getPokemonIconNum(id, pokemon?.gender === 'F', facingLeft);\r\n\r\n\t\tlet top = Math.floor(num / 12) * 30;\r\n\t\tlet left = (num % 12) * 40;\r\n\t\tlet fainted = ((pokemon as Pokemon | ServerPokemon)?.fainted ? `;opacity:.3;filter:grayscale(100%) brightness(.5)` : ``);\r\n\t\treturn `background:transparent url(${Dex.resourcePrefix}sprites/pokemonicons-sheet.png?v6) no-repeat scroll -${left}px -${top}px${fainted}`;\r\n\t}\r\n\r\n\tgetTeambuilderSpriteData(pokemon: any, gen: number = 0): TeambuilderSpriteData {\r\n\t\tlet id = toID(pokemon.species);\r\n\t\tlet spriteid = pokemon.spriteid;\r\n\t\tlet species = Dex.species.get(pokemon.species);\r\n\t\tif (pokemon.species && !spriteid) {\r\n\t\t\tspriteid = species.spriteid || toID(pokemon.species);\r\n\t\t}\r\n\t\tif (species.exists === false) return { spriteDir: 'sprites/gen5', spriteid: '0', x: 10, y: 5 };\r\n\t\tconst spriteData: TeambuilderSpriteData = {\r\n\t\t\tspriteid,\r\n\t\t\tspriteDir: 'sprites/dex',\r\n\t\t\tx: -2,\r\n\t\t\ty: -3,\r\n\t\t};\r\n\t\tif (pokemon.shiny) spriteData.shiny = true;\r\n\t\tif (Dex.prefs('nopastgens')) gen = 6;\r\n\t\tlet xydexExists = (!species.isNonstandard || species.isNonstandard === 'Past' || species.isNonstandard === 'CAP') || [\r\n\t\t\t\"pikachustarter\", \"eeveestarter\", \"meltan\", \"melmetal\", \"pokestarufo\", \"pokestarufo2\", \"pokestarbrycenman\", \"pokestarmt\", \"pokestarmt2\", \"pokestargiant\", \"pokestarhumanoid\", \"pokestarmonster\", \"pokestarf00\", \"pokestarf002\", \"pokestarspirit\",\r\n\t\t].includes(species.id);\r\n\t\tif (species.gen === 8 && species.isNonstandard !== 'CAP') xydexExists = false;\r\n\t\tif ((!gen || gen >= 6) && xydexExists) {\r\n\t\t\tif (species.gen >= 7) {\r\n\t\t\t\tspriteData.x = -6;\r\n\t\t\t\tspriteData.y = -7;\r\n\t\t\t} else if (id.substr(0, 6) === 'arceus') {\r\n\t\t\t\tspriteData.x = -2;\r\n\t\t\t\tspriteData.y = 7;\r\n\t\t\t} else if (id === 'garchomp') {\r\n\t\t\t\tspriteData.x = -2;\r\n\t\t\t\tspriteData.y = 2;\r\n\t\t\t} else if (id === 'garchompmega') {\r\n\t\t\t\tspriteData.x = -2;\r\n\t\t\t\tspriteData.y = 0;\r\n\t\t\t}\r\n\t\t\treturn spriteData;\r\n\t\t}\r\n\t\tspriteData.spriteDir = 'sprites/gen5';\r\n\t\tif (gen <= 1 && species.gen <= 1) spriteData.spriteDir = 'sprites/gen1';\r\n\t\telse if (gen <= 2 && species.gen <= 2) spriteData.spriteDir = 'sprites/gen2';\r\n\t\telse if (gen <= 3 && species.gen <= 3) spriteData.spriteDir = 'sprites/gen3';\r\n\t\telse if (gen <= 4 && species.gen <= 4) spriteData.spriteDir = 'sprites/gen4';\r\n\t\tspriteData.x = 10;\r\n\t\tspriteData.y = 5;\r\n\t\treturn spriteData;\r\n\t}\r\n\r\n\tgetTeambuilderSprite(pokemon: any, gen: number = 0) {\r\n\t\tif (!pokemon) return '';\r\n\t\tconst data = this.getTeambuilderSpriteData(pokemon, gen);\r\n\t\tconst shiny = (data.shiny ? '-shiny' : '');\r\n\t\treturn 'background-image:url(' + Dex.resourcePrefix + data.spriteDir + shiny + '/' + data.spriteid + '.png);background-position:' + data.x + 'px ' + data.y + 'px;background-repeat:no-repeat';\r\n\t}\r\n\r\n\tgetItemIcon(item: any) {\r\n\t\tlet num = 0;\r\n\t\tif (typeof item === 'string' && exports.BattleItems) item = exports.BattleItems[toID(item)];\r\n\t\tif (item?.spritenum) num = item.spritenum;\r\n\r\n\t\tlet top = Math.floor(num / 16) * 24;\r\n\t\tlet left = (num % 16) * 24;\r\n\t\treturn 'background:transparent url(' + Dex.resourcePrefix + 'sprites/itemicons-sheet.png?g8) no-repeat scroll -' + left + 'px -' + top + 'px';\r\n\t}\r\n\r\n\tgetTypeIcon(type: string | null, b?: boolean) { // b is just for utilichart.js\r\n\t\ttype = this.types.get(type).name;\r\n\t\tif (!type) type = '???';\r\n\t\tlet sanitizedType = type.replace(/\\?/g, '%3f');\r\n\t\treturn `<img src=\"${Dex.resourcePrefix}sprites/types/${sanitizedType}.png\" alt=\"${type}\" height=\"14\" width=\"32\" class=\"pixelated${b ? ' b' : ''}\" />`;\r\n\t}\r\n\r\n\tgetCategoryIcon(category: string | null) {\r\n\t\tconst categoryID = toID(category);\r\n\t\tlet sanitizedCategory = '';\r\n\t\tswitch (categoryID) {\r\n\t\tcase 'physical':\r\n\t\tcase 'special':\r\n\t\tcase 'status':\r\n\t\t\tsanitizedCategory = categoryID.charAt(0).toUpperCase() + categoryID.slice(1);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tsanitizedCategory = 'undefined';\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\treturn `<img src=\"${Dex.resourcePrefix}sprites/categories/${sanitizedCategory}.png\" alt=\"${sanitizedCategory}\" height=\"14\" width=\"32\" class=\"pixelated\" />`;\r\n\t}\r\n\r\n\tgetPokeballs() {\r\n\t\tif (this.pokeballs) return this.pokeballs;\r\n\t\tthis.pokeballs = [];\r\n\t\tif (!window.BattleItems) window.BattleItems = {};\r\n\t\tfor (const data of Object.values(window.BattleItems) as AnyObject[]) {\r\n\t\t\tif (!data.isPokeball) continue;\r\n\t\t\tthis.pokeballs.push(data.name);\r\n\t\t}\r\n\t\treturn this.pokeballs;\r\n\t}\r\n};\r\n\r\nclass ModdedDex {\r\n\treadonly gen: number;\r\n\treadonly modid: ID;\r\n\treadonly cache = {\r\n\t\tMoves: {} as any as {[k: string]: Move},\r\n\t\tItems: {} as any as {[k: string]: Item},\r\n\t\tAbilities: {} as any as {[k: string]: Ability},\r\n\t\tSpecies: {} as any as {[k: string]: Species},\r\n\t\tTypes: {} as any as {[k: string]: Effect},\r\n\t};\r\n\tpokeballs: string[] | null = null;\r\n\tconstructor(modid: ID) {\r\n\t\tthis.modid = modid;\r\n\t\tconst gen = parseInt(modid.substr(3, 1), 10);\r\n\t\tif (!modid.startsWith('gen') || !gen) throw new Error(\"Unsupported modid\");\r\n\t\tthis.gen = gen;\r\n\t}\r\n\tmoves = {\r\n\t\tget: (name: string): Move => {\r\n\t\t\tlet id = toID(name);\r\n\t\t\tif (window.BattleAliases && id in BattleAliases) {\r\n\t\t\t\tname = BattleAliases[id];\r\n\t\t\t\tid = toID(name);\r\n\t\t\t}\r\n\t\t\tif (this.cache.Moves.hasOwnProperty(id)) return this.cache.Moves[id];\r\n\r\n\t\t\tlet data = {...Dex.moves.get(name)};\r\n\r\n\t\t\tfor (let i = Dex.gen - 1; i >= this.gen; i--) {\r\n\t\t\t\tconst table = window.BattleTeambuilderTable[`gen${i}`];\r\n\t\t\t\tif (id in table.overrideMoveData) {\r\n\t\t\t\t\tObject.assign(data, table.overrideMoveData[id]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.gen <= 3 && data.category !== 'Status') {\r\n\t\t\t\tdata.category = Dex.getGen3Category(data.type);\r\n\t\t\t}\r\n\t\t\tconst table = window.BattleTeambuilderTable[this.modid];\r\n\t\t\tif (this.modid === 'gen7letsgo' && id in table.overrideMoveData) {\r\n\t\t\t\tObject.assign(data, table.overrideMoveData[id]);\r\n\t\t\t}\r\n\r\n\t\t\tconst move = new Move(id, name, data);\r\n\t\t\tthis.cache.Moves[id] = move;\r\n\t\t\treturn move;\r\n\t\t},\r\n\t};\r\n\r\n\titems = {\r\n\t\tget: (name: string): Item => {\r\n\t\t\tlet id = toID(name);\r\n\t\t\tif (window.BattleAliases && id in BattleAliases) {\r\n\t\t\t\tname = BattleAliases[id];\r\n\t\t\t\tid = toID(name);\r\n\t\t\t}\r\n\t\t\tif (this.cache.Items.hasOwnProperty(id)) return this.cache.Items[id];\r\n\r\n\t\t\tlet data = {...Dex.items.get(name)};\r\n\r\n\t\t\tfor (let i = this.gen; i < 8; i++) {\r\n\t\t\t\tconst table = window.BattleTeambuilderTable['gen' + i];\r\n\t\t\t\tif (id in table.overrideItemDesc) {\r\n\t\t\t\t\tdata.shortDesc = table.overrideItemDesc[id];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst item = new Item(id, name, data);\r\n\t\t\tthis.cache.Items[id] = item;\r\n\t\t\treturn item;\r\n\t\t},\r\n\t};\r\n\r\n\tabilities = {\r\n\t\tget: (name: string): Ability => {\r\n\t\t\tlet id = toID(name);\r\n\t\t\tif (window.BattleAliases && id in BattleAliases) {\r\n\t\t\t\tname = BattleAliases[id];\r\n\t\t\t\tid = toID(name);\r\n\t\t\t}\r\n\t\t\tif (this.cache.Abilities.hasOwnProperty(id)) return this.cache.Abilities[id];\r\n\r\n\t\t\tlet data = {...Dex.abilities.get(name)};\r\n\r\n\t\t\tfor (let i = this.gen; i < 8; i++) {\r\n\t\t\t\tconst table = window.BattleTeambuilderTable['gen' + i];\r\n\t\t\t\tif (id in table.overrideAbilityDesc) {\r\n\t\t\t\t\tdata.shortDesc = table.overrideAbilityDesc[id];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst ability = new Ability(id, name, data);\r\n\t\t\tthis.cache.Abilities[id] = ability;\r\n\t\t\treturn ability;\r\n\t\t},\r\n\t};\r\n\r\n\tspecies = {\r\n\t\tget: (name: string): Species => {\r\n\t\t\tlet id = toID(name);\r\n\t\t\tif (window.BattleAliases && id in BattleAliases) {\r\n\t\t\t\tname = BattleAliases[id];\r\n\t\t\t\tid = toID(name);\r\n\t\t\t}\r\n\t\t\tif (this.cache.Species.hasOwnProperty(id)) return this.cache.Species[id];\r\n\r\n\t\t\tlet data = {...Dex.species.get(name)};\r\n\r\n\t\t\tfor (let i = Dex.gen - 1; i >= this.gen; i--) {\r\n\t\t\t\tconst table = window.BattleTeambuilderTable[`gen${i}`];\r\n\t\t\t\tif (id in table.overrideSpeciesData) {\r\n\t\t\t\t\tObject.assign(data, table.overrideSpeciesData[id]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.gen < 3 || this.modid === 'gen7letsgo') {\r\n\t\t\t\tdata.abilities = {0: \"No Ability\"};\r\n\t\t\t}\r\n\r\n\t\t\tconst table = window.BattleTeambuilderTable[this.modid];\r\n\t\t\tif (id in table.overrideTier) data.tier = table.overrideTier[id];\r\n\t\t\tif (!data.tier && id.slice(-5) === 'totem') {\r\n\t\t\t\tdata.tier = this.species.get(id.slice(0, -5)).tier;\r\n\t\t\t}\r\n\t\t\tif (!data.tier && data.baseSpecies && toID(data.baseSpecies) !== id) {\r\n\t\t\t\tdata.tier = this.species.get(data.baseSpecies).tier;\r\n\t\t\t}\r\n\t\t\tif (data.gen > this.gen) data.tier = 'Illegal';\r\n\r\n\t\t\tconst species = new Species(id, name, data);\r\n\t\t\tthis.cache.Species[id] = species;\r\n\t\t\treturn species;\r\n\t\t},\r\n\t};\r\n\r\n\ttypes = {\r\n\t\tget: (name: string): Effect => {\r\n\t\t\tconst id = toID(name) as ID;\r\n\t\t\tname = id.substr(0, 1).toUpperCase() + id.substr(1);\r\n\r\n\t\t\tif (this.cache.Types.hasOwnProperty(id)) return this.cache.Types[id];\r\n\r\n\t\t\tlet data = {...Dex.types.get(name)};\r\n\r\n\t\t\tfor (let i = 7; i >= this.gen; i--) {\r\n\t\t\t\tconst table = window.BattleTeambuilderTable['gen' + i];\r\n\t\t\t\tif (id in table.removeType) {\r\n\t\t\t\t\tdata.exists = false;\r\n\t\t\t\t\t// don't bother correcting its attributes given it doesn't exist\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (id in table.overrideTypeChart) {\r\n\t\t\t\t\tdata = {...data, ...table.overrideTypeChart[id]};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.cache.Types[id] = data;\r\n\t\t\treturn data;\r\n\t\t},\r\n\t};\r\n\r\n\tgetPokeballs() {\r\n\t\tif (this.pokeballs) return this.pokeballs;\r\n\t\tthis.pokeballs = [];\r\n\t\tif (!window.BattleItems) window.BattleItems = {};\r\n\t\tfor (const data of Object.values(window.BattleItems) as AnyObject[]) {\r\n\t\t\tif (data.gen && data.gen > this.gen) continue;\r\n\t\t\tif (!data.isPokeball) continue;\r\n\t\t\tthis.pokeballs.push(data.name);\r\n\t\t}\r\n\t\treturn this.pokeballs;\r\n\t}\r\n}\r\n\r\nif (typeof require === 'function') {\r\n\t// in Node\r\n\t(global as any).Dex = Dex;\r\n\t(global as any).toID = toID;\r\n}\r\n","/**\r\n * Pokemon Showdown Dex Data\r\n *\r\n * A collection of data and definitions for src/battle-dex.ts.\r\n *\r\n * Larger data has their own files in data/, so this is just for small\r\n * miscellaneous data that doesn't need its own file.\r\n *\r\n * Licensing note: PS's client has complicated licensing:\r\n * - The client as a whole is AGPLv3\r\n * - The battle replay/animation engine (battle-*.ts) by itself is MIT\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license MIT\r\n */\r\n\r\n/**\r\n * String that contains only lowercase alphanumeric characters.\r\n */\r\ntype ID = string & {__isID: true};\r\n\r\nconst BattleNatures: {[k in NatureName]: {plus?: StatName, minus?: StatName}} = {\r\n\tAdamant: {\r\n\t\tplus: 'atk',\r\n\t\tminus: 'spa',\r\n\t},\r\n\tBashful: {},\r\n\tBold: {\r\n\t\tplus: 'def',\r\n\t\tminus: 'atk',\r\n\t},\r\n\tBrave: {\r\n\t\tplus: 'atk',\r\n\t\tminus: 'spe',\r\n\t},\r\n\tCalm: {\r\n\t\tplus: 'spd',\r\n\t\tminus: 'atk',\r\n\t},\r\n\tCareful: {\r\n\t\tplus: 'spd',\r\n\t\tminus: 'spa',\r\n\t},\r\n\tDocile: {},\r\n\tGentle: {\r\n\t\tplus: 'spd',\r\n\t\tminus: 'def',\r\n\t},\r\n\tHardy: {},\r\n\tHasty: {\r\n\t\tplus: 'spe',\r\n\t\tminus: 'def',\r\n\t},\r\n\tImpish: {\r\n\t\tplus: 'def',\r\n\t\tminus: 'spa',\r\n\t},\r\n\tJolly: {\r\n\t\tplus: 'spe',\r\n\t\tminus: 'spa',\r\n\t},\r\n\tLax: {\r\n\t\tplus: 'def',\r\n\t\tminus: 'spd',\r\n\t},\r\n\tLonely: {\r\n\t\tplus: 'atk',\r\n\t\tminus: 'def',\r\n\t},\r\n\tMild: {\r\n\t\tplus: 'spa',\r\n\t\tminus: 'def',\r\n\t},\r\n\tModest: {\r\n\t\tplus: 'spa',\r\n\t\tminus: 'atk',\r\n\t},\r\n\tNaive: {\r\n\t\tplus: 'spe',\r\n\t\tminus: 'spd',\r\n\t},\r\n\tNaughty: {\r\n\t\tplus: 'atk',\r\n\t\tminus: 'spd',\r\n\t},\r\n\tQuiet: {\r\n\t\tplus: 'spa',\r\n\t\tminus: 'spe',\r\n\t},\r\n\tQuirky: {},\r\n\tRash: {\r\n\t\tplus: 'spa',\r\n\t\tminus: 'spd',\r\n\t},\r\n\tRelaxed: {\r\n\t\tplus: 'def',\r\n\t\tminus: 'spe',\r\n\t},\r\n\tSassy: {\r\n\t\tplus: 'spd',\r\n\t\tminus: 'spe',\r\n\t},\r\n\tSerious: {},\r\n\tTimid: {\r\n\t\tplus: 'spe',\r\n\t\tminus: 'atk',\r\n\t},\r\n};\r\nconst BattleStatIDs: {[k: string]: StatName | undefined} = {\r\n\tHP: 'hp',\r\n\thp: 'hp',\r\n\tAtk: 'atk',\r\n\tatk: 'atk',\r\n\tDef: 'def',\r\n\tdef: 'def',\r\n\tSpA: 'spa',\r\n\tSAtk: 'spa',\r\n\tSpAtk: 'spa',\r\n\tspa: 'spa',\r\n\tspc: 'spa',\r\n\tSpc: 'spa',\r\n\tSpD: 'spd',\r\n\tSDef: 'spd',\r\n\tSpDef: 'spd',\r\n\tspd: 'spd',\r\n\tSpe: 'spe',\r\n\tSpd: 'spe',\r\n\tspe: 'spe',\r\n};\r\n/** Stat short names */\r\nconst BattleStatNames = {\r\n\thp: 'HP',\r\n\tatk: 'Atk',\r\n\tdef: 'Def',\r\n\tspa: 'SpA',\r\n\tspd: 'SpD',\r\n\tspe: 'Spe',\r\n} as const;\r\n\r\nconst BattleBaseSpeciesChart = [\r\n\t\"unown\", \"burmy\", \"shellos\", \"gastrodon\", \"deerling\", \"sawsbuck\", \"vivillon\", \"flabebe\", \"floette\", \"florges\", \"furfrou\", \"minior\", \"alcremie\", \"pokestarufo\", \"pokestarbrycenman\", \"pokestarmt\", \"pokestarmt2\", \"pokestartransport\", \"pokestargiant\", \"pokestarhumanoid\", \"pokestarmonster\", \"pokestarf00\", \"pokestarf002\", \"pokestarspirit\", \"pokestarblackdoor\", \"pokestarwhitedoor\", \"pokestarblackbelt\",\r\n] as ID[];\r\n\r\nconst BattlePokemonIconIndexes: {[id: string]: number} = {\r\n\tegg: 900 + 1,\r\n\tpikachubelle: 900 + 2,\r\n\tpikachulibre: 900 + 3,\r\n\tpikachuphd: 900 + 4,\r\n\tpikachupopstar: 900 + 5,\r\n\tpikachurockstar: 900 + 6,\r\n\tpikachucosplay: 900 + 7,\r\n\tunownexclamation: 900 + 8,\r\n\tunownquestion: 900 + 9,\r\n\tunownb: 900 + 10,\r\n\tunownc: 900 + 11,\r\n\tunownd: 900 + 12,\r\n\tunowne: 900 + 13,\r\n\tunownf: 900 + 14,\r\n\tunowng: 900 + 15,\r\n\tunownh: 900 + 16,\r\n\tunowni: 900 + 17,\r\n\tunownj: 900 + 18,\r\n\tunownk: 900 + 19,\r\n\tunownl: 900 + 20,\r\n\tunownm: 900 + 21,\r\n\tunownn: 900 + 22,\r\n\tunowno: 900 + 23,\r\n\tunownp: 900 + 24,\r\n\tunownq: 900 + 25,\r\n\tunownr: 900 + 26,\r\n\tunowns: 900 + 27,\r\n\tunownt: 900 + 28,\r\n\tunownu: 900 + 29,\r\n\tunownv: 900 + 30,\r\n\tunownw: 900 + 31,\r\n\tunownx: 900 + 32,\r\n\tunowny: 900 + 33,\r\n\tunownz: 900 + 34,\r\n\tcastformrainy: 900 + 35,\r\n\tcastformsnowy: 900 + 36,\r\n\tcastformsunny: 900 + 37,\r\n\tdeoxysattack: 900 + 38,\r\n\tdeoxysdefense: 900 + 39,\r\n\tdeoxysspeed: 900 + 40,\r\n\tburmysandy: 900 + 41,\r\n\tburmytrash: 900 + 42,\r\n\twormadamsandy: 900 + 43,\r\n\twormadamtrash: 900 + 44,\r\n\tcherrimsunshine: 900 + 45,\r\n\tshelloseast: 900 + 46,\r\n\tgastrodoneast: 900 + 47,\r\n\trotomfan: 900 + 48,\r\n\trotomfrost: 900 + 49,\r\n\trotomheat: 900 + 50,\r\n\trotommow: 900 + 51,\r\n\trotomwash: 900 + 52,\r\n\tgiratinaorigin: 900 + 53,\r\n\tshayminsky: 900 + 54,\r\n\tunfezantf: 900 + 55,\r\n\tbasculinbluestriped: 900 + 56,\r\n\tdarmanitanzen: 900 + 57,\r\n\tdeerlingautumn: 900 + 58,\r\n\tdeerlingsummer: 900 + 59,\r\n\tdeerlingwinter: 900 + 60,\r\n\tsawsbuckautumn: 900 + 61,\r\n\tsawsbucksummer: 900 + 62,\r\n\tsawsbuckwinter: 900 + 63,\r\n\tfrillishf: 900 + 64,\r\n\tjellicentf: 900 + 65,\r\n\ttornadustherian: 900 + 66,\r\n\tthundurustherian: 900 + 67,\r\n\tlandorustherian: 900 + 68,\r\n\tkyuremblack: 900 + 69,\r\n\tkyuremwhite: 900 + 70,\r\n\tkeldeoresolute: 900 + 71,\r\n\tmeloettapirouette: 900 + 72,\r\n\tvivillonarchipelago: 900 + 73,\r\n\tvivilloncontinental: 900 + 74,\r\n\tvivillonelegant: 900 + 75,\r\n\tvivillonfancy: 900 + 76,\r\n\tvivillongarden: 900 + 77,\r\n\tvivillonhighplains: 900 + 78,\r\n\tvivillonicysnow: 900 + 79,\r\n\tvivillonjungle: 900 + 80,\r\n\tvivillonmarine: 900 + 81,\r\n\tvivillonmodern: 900 + 82,\r\n\tvivillonmonsoon: 900 + 83,\r\n\tvivillonocean: 900 + 84,\r\n\tvivillonpokeball: 900 + 85,\r\n\tvivillonpolar: 900 + 86,\r\n\tvivillonriver: 900 + 87,\r\n\tvivillonsandstorm: 900 + 88,\r\n\tvivillonsavanna: 900 + 89,\r\n\tvivillonsun: 900 + 90,\r\n\tvivillontundra: 900 + 91,\r\n\tpyroarf: 900 + 92,\r\n\tflabebeblue: 900 + 93,\r\n\tflabebeorange: 900 + 94,\r\n\tflabebewhite: 900 + 95,\r\n\tflabebeyellow: 900 + 96,\r\n\tfloetteblue: 900 + 97,\r\n\tfloetteeternal: 900 + 98,\r\n\tfloetteorange: 900 + 99,\r\n\tfloettewhite: 900 + 100,\r\n\tfloetteyellow: 900 + 101,\r\n\tflorgesblue: 900 + 102,\r\n\tflorgesorange: 900 + 103,\r\n\tflorgeswhite: 900 + 104,\r\n\tflorgesyellow: 900 + 105,\r\n\tfurfroudandy: 900 + 106,\r\n\tfurfroudebutante: 900 + 107,\r\n\tfurfroudiamond: 900 + 108,\r\n\tfurfrouheart: 900 + 109,\r\n\tfurfroukabuki: 900 + 110,\r\n\tfurfroulareine: 900 + 111,\r\n\tfurfroumatron: 900 + 112,\r\n\tfurfroupharaoh: 900 + 113,\r\n\tfurfroustar: 900 + 114,\r\n\tmeowsticf: 900 + 115,\r\n\taegislashblade: 900 + 116,\r\n\txerneasneutral: 900 + 117,\r\n\thoopaunbound: 900 + 118,\r\n\trattataalola: 900 + 119,\r\n\traticatealola: 900 + 120,\r\n\traichualola: 900 + 121,\r\n\tsandshrewalola: 900 + 122,\r\n\tsandslashalola: 900 + 123,\r\n\tvulpixalola: 900 + 124,\r\n\tninetalesalola: 900 + 125,\r\n\tdiglettalola: 900 + 126,\r\n\tdugtrioalola: 900 + 127,\r\n\tmeowthalola: 900 + 128,\r\n\tpersianalola: 900 + 129,\r\n\tgeodudealola: 900 + 130,\r\n\tgraveleralola: 900 + 131,\r\n\tgolemalola: 900 + 132,\r\n\tgrimeralola: 900 + 133,\r\n\tmukalola: 900 + 134,\r\n\texeggutoralola: 900 + 135,\r\n\tmarowakalola: 900 + 136,\r\n\tgreninjaash: 900 + 137,\r\n\tzygarde10: 900 + 138,\r\n\tzygardecomplete: 900 + 139,\r\n\toricoriopompom: 900 + 140,\r\n\toricoriopau: 900 + 141,\r\n\toricoriosensu: 900 + 142,\r\n\tlycanrocmidnight: 900 + 143,\r\n\twishiwashischool: 900 + 144,\r\n\tminiormeteor: 900 + 145,\r\n\tminiororange: 900 + 146,\r\n\tminioryellow: 900 + 147,\r\n\tminiorgreen: 900 + 148,\r\n\tminiorblue: 900 + 149,\r\n\tminiorindigo: 900 + 150,\r\n\tminiorviolet: 900 + 151,\r\n\tmagearnaoriginal: 900 + 152,\r\n\tpikachuoriginal: 900 + 153,\r\n\tpikachuhoenn: 900 + 154,\r\n\tpikachusinnoh: 900 + 155,\r\n\tpikachuunova: 900 + 156,\r\n\tpikachukalos: 900 + 157,\r\n\tpikachualola: 900 + 158,\r\n\tpikachupartner: 900 + 159,\r\n\tlycanrocdusk: 900 + 160,\r\n\tnecrozmaduskmane: 900 + 161,\r\n\tnecrozmadawnwings: 900 + 162,\r\n\tnecrozmaultra: 900 + 163,\r\n\tpikachustarter: 900 + 164,\r\n\teeveestarter: 900 + 165,\r\n\tmeowthgalar: 900 + 166,\r\n\tponytagalar: 900 + 167,\r\n\trapidashgalar: 900 + 168,\r\n\tfarfetchdgalar: 900 + 169,\r\n\tweezinggalar: 900 + 170,\r\n\tmrmimegalar: 900 + 171,\r\n\tcorsolagalar: 900 + 172,\r\n\tzigzagoongalar: 900 + 173,\r\n\tlinoonegalar: 900 + 174,\r\n\tdarumakagalar: 900 + 175,\r\n\tdarmanitangalar: 900 + 176,\r\n\tdarmanitangalarzen: 900 + 177,\r\n\tyamaskgalar: 900 + 178,\r\n\tstunfiskgalar: 900 + 179,\r\n\tcramorantgulping: 900 + 180,\r\n\tcramorantgorging: 900 + 181,\r\n\ttoxtricitylowkey: 900 + 182,\r\n\tsinisteaantique: 854,\r\n\tpolteageistantique: 855,\r\n\talcremierubycream: 900 + 183,\r\n\talcremiematchacream: 900 + 184,\r\n\talcremiemintcream: 900 + 185,\r\n\talcremielemoncream: 900 + 186,\r\n\talcremiesaltedcream: 900 + 187,\r\n\talcremierubyswirl: 900 + 188,\r\n\talcremiecaramelswirl: 900 + 189,\r\n\talcremierainbowswirl: 900 + 190,\r\n\teiscuenoice: 900 + 191,\r\n\tindeedeef: 900 + 192,\r\n\tmorpekohangry: 900 + 193,\r\n\tzaciancrowned: 900 + 194,\r\n\tzamazentacrowned: 900 + 195,\r\n\tslowpokegalar: 900 + 196,\r\n\tslowbrogalar: 900 + 197,\r\n\tzarudedada: 900 + 198,\r\n\tpikachuworld: 900 + 199,\r\n\tarticunogalar: 900 + 200,\r\n\tzapdosgalar: 900 + 201,\r\n\tmoltresgalar: 900 + 202,\r\n\tslowkinggalar: 900 + 203,\r\n\tcalyrexice: 900 + 204,\r\n\tcalyrexshadow: 900 + 205,\r\n\r\n\tgumshoostotem: 735,\r\n\traticatealolatotem: 900 + 120,\r\n\tmarowakalolatotem: 900 + 136,\r\n\taraquanidtotem: 752,\r\n\tlurantistotem: 754,\r\n\tsalazzletotem: 758,\r\n\tvikavolttotem: 738,\r\n\ttogedemarutotem: 777,\r\n\tmimikyutotem: 778,\r\n\tmimikyubustedtotem: 778,\r\n\tribombeetotem: 743,\r\n\tkommoototem: 784,\r\n\r\n\tvenusaurmega: 1116 + 0,\r\n\tcharizardmegax: 1116 + 1,\r\n\tcharizardmegay: 1116 + 2,\r\n\tblastoisemega: 1116 + 3,\r\n\tbeedrillmega: 1116 + 4,\r\n\tpidgeotmega: 1116 + 5,\r\n\talakazammega: 1116 + 6,\r\n\tslowbromega: 1116 + 7,\r\n\tgengarmega: 1116 + 8,\r\n\tkangaskhanmega: 1116 + 9,\r\n\tpinsirmega: 1116 + 10,\r\n\tgyaradosmega: 1116 + 11,\r\n\taerodactylmega: 1116 + 12,\r\n\tmewtwomegax: 1116 + 13,\r\n\tmewtwomegay: 1116 + 14,\r\n\tampharosmega: 1116 + 15,\r\n\tsteelixmega: 1116 + 16,\r\n\tscizormega: 1116 + 17,\r\n\theracrossmega: 1116 + 18,\r\n\thoundoommega: 1116 + 19,\r\n\ttyranitarmega: 1116 + 20,\r\n\tsceptilemega: 1116 + 21,\r\n\tblazikenmega: 1116 + 22,\r\n\tswampertmega: 1116 + 23,\r\n\tgardevoirmega: 1116 + 24,\r\n\tsableyemega: 1116 + 25,\r\n\tmawilemega: 1116 + 26,\r\n\taggronmega: 1116 + 27,\r\n\tmedichammega: 1116 + 28,\r\n\tmanectricmega: 1116 + 29,\r\n\tsharpedomega: 1116 + 30,\r\n\tcameruptmega: 1116 + 31,\r\n\taltariamega: 1116 + 32,\r\n\tbanettemega: 1116 + 33,\r\n\tabsolmega: 1116 + 34,\r\n\tglaliemega: 1116 + 35,\r\n\tsalamencemega: 1116 + 36,\r\n\tmetagrossmega: 1116 + 37,\r\n\tlatiasmega: 1116 + 38,\r\n\tlatiosmega: 1116 + 39,\r\n\tkyogreprimal: 1116 + 40,\r\n\tgroudonprimal: 1116 + 41,\r\n\trayquazamega: 1116 + 42,\r\n\tlopunnymega: 1116 + 43,\r\n\tgarchompmega: 1116 + 44,\r\n\tlucariomega: 1116 + 45,\r\n\tabomasnowmega: 1116 + 46,\r\n\tgallademega: 1116 + 47,\r\n\taudinomega: 1116 + 48,\r\n\tdianciemega: 1116 + 49,\r\n\tcharizardgmax: 1116 + 50,\r\n\tbutterfreegmax: 1116 + 51,\r\n\tpikachugmax: 1116 + 52,\r\n\tmeowthgmax: 1116 + 53,\r\n\tmachampgmax: 1116 + 54,\r\n\tgengargmax: 1116 + 55,\r\n\tkinglergmax: 1116 + 56,\r\n\tlaprasgmax: 1116 + 57,\r\n\teeveegmax: 1116 + 58,\r\n\tsnorlaxgmax: 1116 + 59,\r\n\tgarbodorgmax: 1116 + 60,\r\n\tmelmetalgmax: 1116 + 61,\r\n\tcorviknightgmax: 1116 + 62,\r\n\torbeetlegmax: 1116 + 63,\r\n\tdrednawgmax: 1116 + 64,\r\n\tcoalossalgmax: 1116 + 65,\r\n\tflapplegmax: 1116 + 66,\r\n\tappletungmax: 1116 + 67,\r\n\tsandacondagmax: 1116 + 68,\r\n\ttoxtricitygmax: 1116 + 69,\r\n\ttoxtricitylowkeygmax: 1116 + 69,\r\n\tcentiskorchgmax: 1116 + 70,\r\n\thatterenegmax: 1116 + 71,\r\n\tgrimmsnarlgmax: 1116 + 72,\r\n\talcremiegmax: 1116 + 73,\r\n\tcopperajahgmax: 1116 + 74,\r\n\tduraludongmax: 1116 + 75,\r\n\teternatuseternamax: 1116 + 76,\r\n\tvenusaurgmax: 1116 + 77,\r\n\tblastoisegmax: 1116 + 78,\r\n\trillaboomgmax: 1116 + 79,\r\n\tcinderacegmax: 1116 + 80,\r\n\tinteleongmax: 1116 + 81,\r\n\turshifugmax: 1116 + 82,\r\n\turshifurapidstrikegmax: 1116 + 83,\r\n\r\n\tsyclant: 1308 + 0,\r\n\trevenankh: 1308 + 1,\r\n\tpyroak: 1308 + 2,\r\n\tfidgit: 1308 + 3,\r\n\tstratagem: 1308 + 4,\r\n\targhonaut: 1308 + 5,\r\n\tkitsunoh: 1308 + 6,\r\n\tcyclohm: 1308 + 7,\r\n\tcolossoil: 1308 + 8,\r\n\tkrilowatt: 1308 + 9,\r\n\tvoodoom: 1308 + 10,\r\n\ttomohawk: 1308 + 11,\r\n\tnecturna: 1308 + 12,\r\n\tmollux: 1308 + 13,\r\n\taurumoth: 1308 + 14,\r\n\tmalaconda: 1308 + 15,\r\n\tcawmodore: 1308 + 16,\r\n\tvolkraken: 1308 + 17,\r\n\tplasmanta: 1308 + 18,\r\n\tnaviathan: 1308 + 19,\r\n\tcrucibelle: 1308 + 20,\r\n\tcrucibellemega: 1308 + 21,\r\n\tkerfluffle: 1308 + 22,\r\n\tpajantom: 1308 + 23,\r\n\tjumbao: 1308 + 24,\r\n\tcaribolt: 1308 + 25,\r\n\tsmokomodo: 1308 + 26,\r\n\tsnaelstrom: 1308 + 27,\r\n\tequilibra: 1308 + 28,\r\n\tastrolotl: 1308 + 29,\r\n\tmiasmaw: 1308 + 30,\r\n\tchromera: 1308 + 31,\r\n\r\n\tsyclar: 1344 + 0,\r\n\tembirch: 1344 + 1,\r\n\tflarelm: 1344 + 2,\r\n\tbreezi: 1344 + 3,\r\n\tscratchet: 1344 + 4,\r\n\tnecturine: 1344 + 5,\r\n\tcupra: 1344 + 6,\r\n\targalis: 1344 + 7,\r\n\tbrattler: 1344 + 8,\r\n\tcawdet: 1344 + 9,\r\n\tvolkritter: 1344 + 10,\r\n\tsnugglow: 1344 + 11,\r\n\tfloatoy: 1344 + 12,\r\n\tcaimanoe: 1344 + 13,\r\n\tpluffle: 1344 + 14,\r\n\trebble: 1344 + 15,\r\n\ttactite: 1344 + 16,\r\n\tprivatyke: 1344 + 17,\r\n\tnohface: 1344 + 18,\r\n\tmonohm: 1344 + 19,\r\n\tduohm: 1344 + 20,\r\n\tprotowatt: 1344 + 21,\r\n\tvoodoll: 1344 + 22,\r\n\tmumbao: 1344 + 23,\r\n\tfawnifer: 1344 + 24,\r\n\telectrelk: 1344 + 25,\r\n\tsmogecko: 1344 + 26,\r\n\tsmoguana: 1344 + 27,\r\n\tswirlpool: 1344 + 28,\r\n\tcoribalis: 1344 + 29,\r\n\tjustyke: 1344 + 30,\r\n\tsolotl: 1344 + 31,\r\n\tmiasmite: 1344 + 32,\r\n\tdorsoil: 1344 + 33,\r\n};\r\n\r\nconst BattlePokemonIconIndexesLeft: {[id: string]: number} = {\r\n\tpikachubelle: 1200 + 0,\r\n\tpikachupopstar: 1200 + 1,\r\n\tclefairy: 1200 + 2,\r\n\tclefable: 1200 + 3,\r\n\tjigglypuff: 1200 + 4,\r\n\twigglytuff: 1200 + 5,\r\n\tdugtrioalola: 1200 + 6,\r\n\tpoliwhirl: 1200 + 7,\r\n\tpoliwrath: 1200 + 8,\r\n\tmukalola: 1200 + 9,\r\n\tkingler: 1200 + 10,\r\n\tcroconaw: 1200 + 11,\r\n\tcleffa: 1200 + 12,\r\n\tigglybuff: 1200 + 13,\r\n\tpolitoed: 1200 + 14,\r\n\tunownb: 1200 + 15,\r\n\tunownc: 1200 + 16,\r\n\tunownd: 1200 + 17,\r\n\tunowne: 1200 + 18,\r\n\tunownf: 1200 + 19,\r\n\tunowng: 1200 + 20,\r\n\tunownh: 1200 + 21,\r\n\tunownj: 1200 + 22,\r\n\tunownk: 1200 + 23,\r\n\tunownl: 1200 + 24,\r\n\tunownm: 1200 + 25,\r\n\tunownn: 1200 + 26,\r\n\tunownp: 1200 + 27,\r\n\tunownq: 1200 + 28,\r\n\tunownquestion: 1200 + 29,\r\n\tunownr: 1200 + 30,\r\n\tunowns: 1200 + 31,\r\n\tunownt: 1200 + 32,\r\n\tunownv: 1200 + 33,\r\n\tunownz: 1200 + 34,\r\n\tsneasel: 1200 + 35,\r\n\tteddiursa: 1200 + 36,\r\n\troselia: 1200 + 37,\r\n\tzangoose: 1200 + 38,\r\n\tseviper: 1200 + 39,\r\n\tcastformsnowy: 1200 + 40,\r\n\tabsolmega: 1200 + 41,\r\n\tabsol: 1200 + 42,\r\n\tregirock: 1200 + 43,\r\n\ttorterra: 1200 + 44,\r\n\tbudew: 1200 + 45,\r\n\troserade: 1200 + 46,\r\n\tmagmortar: 1200 + 47,\r\n\ttogekiss: 1200 + 48,\r\n\trotomwash: 1200 + 49,\r\n\tshayminsky: 1200 + 50,\r\n\temboar: 1200 + 51,\r\n\tpansear: 1200 + 52,\r\n\tsimisear: 1200 + 53,\r\n\tdrilbur: 1200 + 54,\r\n\texcadrill: 1200 + 55,\r\n\tsawk: 1200 + 56,\r\n\tlilligant: 1200 + 57,\r\n\tgarbodor: 1200 + 58,\r\n\tsolosis: 1200 + 59,\r\n\tvanilluxe: 1200 + 60,\r\n\tamoonguss: 1200 + 61,\r\n\tklink: 1200 + 62,\r\n\tklang: 1200 + 63,\r\n\tklinklang: 1200 + 64,\r\n\tlitwick: 1200 + 65,\r\n\tgolett: 1200 + 66,\r\n\tgolurk: 1200 + 67,\r\n\tkyuremblack: 1200 + 68,\r\n\tkyuremwhite: 1200 + 69,\r\n\tkyurem: 1200 + 70,\r\n\tkeldeoresolute: 1200 + 71,\r\n\tmeloetta: 1200 + 72,\r\n\tgreninja: 1200 + 73,\r\n\tgreninjaash: 1200 + 74,\r\n\tfurfroudebutante: 1200 + 75,\r\n\tbarbaracle: 1200 + 76,\r\n\tclauncher: 1200 + 77,\r\n\tclawitzer: 1200 + 78,\r\n\tsylveon: 1200 + 79,\r\n\tklefki: 1200 + 80,\r\n\tzygarde: 1200 + 81,\r\n\tzygarde10: 1200 + 82,\r\n\tzygardecomplete: 1200 + 83,\r\n\tdartrix: 1200 + 84,\r\n\tsteenee: 1200 + 85,\r\n\ttsareena: 1200 + 86,\r\n\tcomfey: 1200 + 87,\r\n\tminiormeteor: 1200 + 88,\r\n\tminior: 1200 + 89,\r\n\tminiororange: 1200 + 90,\r\n\tminioryellow: 1200 + 91,\r\n\tminiorgreen: 1200 + 92,\r\n\tminiorblue: 1200 + 93,\r\n\tminiorviolet: 1200 + 94,\r\n\tminiorindigo: 1200 + 95,\r\n\tdhelmise: 1200 + 96,\r\n\tnecrozma: 1200 + 97,\r\n\tmarshadow: 1200 + 98,\r\n\tpikachuoriginal: 1200 + 99,\r\n\tpikachupartner: 1200 + 100,\r\n\tnecrozmaduskmane: 1200 + 101,\r\n\tnecrozmadawnwings: 1200 + 102,\r\n\tnecrozmaultra: 1200 + 103,\r\n\tstakataka: 1200 + 104,\r\n\tblacephalon: 1200 + 105,\r\n};\r\n\r\nconst BattleAvatarNumbers: {[k: string]: string} = {\r\n\t1: 'lucas',\r\n\t2: 'dawn',\r\n\t3: 'youngster-gen4dp',\r\n\t4: 'lass-gen4dp',\r\n\t5: 'camper',\r\n\t6: 'picnicker',\r\n\t7: 'bugcatcher-gen4dp',\r\n\t8: 'aromalady',\r\n\t9: 'twins-gen4dp',\r\n\t10: 'hiker-gen4',\r\n\t11: 'battlegirl-gen4',\r\n\t12: 'fisherman-gen4',\r\n\t13: 'cyclist-gen4',\r\n\t14: 'cyclistf-gen4',\r\n\t15: 'blackbelt-gen4dp',\r\n\t16: 'artist-gen4',\r\n\t17: 'pokemonbreeder-gen4',\r\n\t18: 'pokemonbreederf-gen4',\r\n\t19: 'cowgirl',\r\n\t20: 'jogger',\r\n\t21: 'pokefan-gen4',\r\n\t22: 'pokefanf-gen4',\r\n\t23: 'pokekid',\r\n\t24: 'youngcouple-gen4dp',\r\n\t25: 'acetrainer-gen4dp',\r\n\t26: 'acetrainerf-gen4dp',\r\n\t27: 'waitress-gen4',\r\n\t28: 'veteran-gen4',\r\n\t29: 'ninjaboy',\r\n\t30: 'dragontamer',\r\n\t31: 'birdkeeper-gen4dp',\r\n\t32: 'doubleteam',\r\n\t33: 'richboy-gen4',\r\n\t34: 'lady-gen4',\r\n\t35: 'gentleman-gen4dp',\r\n\t36: 'madame-gen4dp',\r\n\t37: 'beauty-gen4dp',\r\n\t38: 'collector',\r\n\t39: 'policeman-gen4',\r\n\t40: 'pokemonranger-gen4',\r\n\t41: 'pokemonrangerf-gen4',\r\n\t42: 'scientist-gen4dp',\r\n\t43: 'swimmer-gen4dp',\r\n\t44: 'swimmerf-gen4dp',\r\n\t45: 'tuber',\r\n\t46: 'tuberf',\r\n\t47: 'sailor',\r\n\t48: 'sisandbro',\r\n\t49: 'ruinmaniac',\r\n\t50: 'psychic-gen4',\r\n\t51: 'psychicf-gen4',\r\n\t52: 'gambler',\r\n\t53: 'guitarist-gen4',\r\n\t54: 'acetrainersnow',\r\n\t55: 'acetrainersnowf',\r\n\t56: 'skier',\r\n\t57: 'skierf-gen4dp',\r\n\t58: 'roughneck-gen4',\r\n\t59: 'clown',\r\n\t60: 'worker-gen4',\r\n\t61: 'schoolkid-gen4dp',\r\n\t62: 'schoolkidf-gen4',\r\n\t63: 'roark',\r\n\t64: 'barry',\r\n\t65: 'byron',\r\n\t66: 'aaron',\r\n\t67: 'bertha',\r\n\t68: 'flint',\r\n\t69: 'lucian',\r\n\t70: 'cynthia-gen4',\r\n\t71: 'bellepa',\r\n\t72: 'rancher',\r\n\t73: 'mars',\r\n\t74: 'galacticgrunt',\r\n\t75: 'gardenia',\r\n\t76: 'crasherwake',\r\n\t77: 'maylene',\r\n\t78: 'fantina',\r\n\t79: 'candice',\r\n\t80: 'volkner',\r\n\t81: 'parasollady-gen4',\r\n\t82: 'waiter-gen4dp',\r\n\t83: 'interviewers',\r\n\t84: 'cameraman',\r\n\t85: 'reporter',\r\n\t86: 'idol',\r\n\t87: 'cyrus',\r\n\t88: 'jupiter',\r\n\t89: 'saturn',\r\n\t90: 'galacticgruntf',\r\n\t91: 'argenta',\r\n\t92: 'palmer',\r\n\t93: 'thorton',\r\n\t94: 'buck',\r\n\t95: 'darach',\r\n\t96: 'marley',\r\n\t97: 'mira',\r\n\t98: 'cheryl',\r\n\t99: 'riley',\r\n\t100: 'dahlia',\r\n\t101: 'ethan',\r\n\t102: 'lyra',\r\n\t103: 'twins-gen4',\r\n\t104: 'lass-gen4',\r\n\t105: 'acetrainer-gen4',\r\n\t106: 'acetrainerf-gen4',\r\n\t107: 'juggler',\r\n\t108: 'sage',\r\n\t109: 'li',\r\n\t110: 'gentleman-gen4',\r\n\t111: 'teacher',\r\n\t112: 'beauty',\r\n\t113: 'birdkeeper',\r\n\t114: 'swimmer-gen4',\r\n\t115: 'swimmerf-gen4',\r\n\t116: 'kimonogirl',\r\n\t117: 'scientist-gen4',\r\n\t118: 'acetrainercouple',\r\n\t119: 'youngcouple',\r\n\t120: 'supernerd',\r\n\t121: 'medium',\r\n\t122: 'schoolkid-gen4',\r\n\t123: 'blackbelt-gen4',\r\n\t124: 'pokemaniac',\r\n\t125: 'firebreather',\r\n\t126: 'burglar',\r\n\t127: 'biker-gen4',\r\n\t128: 'skierf',\r\n\t129: 'boarder',\r\n\t130: 'rocketgrunt',\r\n\t131: 'rocketgruntf',\r\n\t132: 'archer',\r\n\t133: 'ariana',\r\n\t134: 'proton',\r\n\t135: 'petrel',\r\n\t136: 'eusine',\r\n\t137: 'lucas-gen4pt',\r\n\t138: 'dawn-gen4pt',\r\n\t139: 'madame-gen4',\r\n\t140: 'waiter-gen4',\r\n\t141: 'falkner',\r\n\t142: 'bugsy',\r\n\t143: 'whitney',\r\n\t144: 'morty',\r\n\t145: 'chuck',\r\n\t146: 'jasmine',\r\n\t147: 'pryce',\r\n\t148: 'clair',\r\n\t149: 'will',\r\n\t150: 'koga',\r\n\t151: 'bruno',\r\n\t152: 'karen',\r\n\t153: 'lance',\r\n\t154: 'brock',\r\n\t155: 'misty',\r\n\t156: 'ltsurge',\r\n\t157: 'erika',\r\n\t158: 'janine',\r\n\t159: 'sabrina',\r\n\t160: 'blaine',\r\n\t161: 'blue',\r\n\t162: 'red',\r\n\t163: 'red',\r\n\t164: 'silver',\r\n\t165: 'giovanni',\r\n\t166: 'unknownf',\r\n\t167: 'unknown',\r\n\t168: 'unknown',\r\n\t169: 'hilbert',\r\n\t170: 'hilda',\r\n\t171: 'youngster',\r\n\t172: 'lass',\r\n\t173: 'schoolkid',\r\n\t174: 'schoolkidf',\r\n\t175: 'smasher',\r\n\t176: 'linebacker',\r\n\t177: 'waiter',\r\n\t178: 'waitress',\r\n\t179: 'chili',\r\n\t180: 'cilan',\r\n\t181: 'cress',\r\n\t182: 'nurseryaide',\r\n\t183: 'preschoolerf',\r\n\t184: 'preschooler',\r\n\t185: 'twins',\r\n\t186: 'pokemonbreeder',\r\n\t187: 'pokemonbreederf',\r\n\t188: 'lenora',\r\n\t189: 'burgh',\r\n\t190: 'elesa',\r\n\t191: 'clay',\r\n\t192: 'skyla',\r\n\t193: 'pokemonranger',\r\n\t194: 'pokemonrangerf',\r\n\t195: 'worker',\r\n\t196: 'backpacker',\r\n\t197: 'backpackerf',\r\n\t198: 'fisherman',\r\n\t199: 'musician',\r\n\t200: 'dancer',\r\n\t201: 'harlequin',\r\n\t202: 'artist',\r\n\t203: 'baker',\r\n\t204: 'psychic',\r\n\t205: 'psychicf',\r\n\t206: 'cheren',\r\n\t207: 'bianca',\r\n\t208: 'plasmagrunt-gen5bw',\r\n\t209: 'n',\r\n\t210: 'richboy',\r\n\t211: 'lady',\r\n\t212: 'pilot',\r\n\t213: 'workerice',\r\n\t214: 'hoopster',\r\n\t215: 'scientistf',\r\n\t216: 'clerkf',\r\n\t217: 'acetrainerf',\r\n\t218: 'acetrainer',\r\n\t219: 'blackbelt',\r\n\t220: 'scientist',\r\n\t221: 'striker',\r\n\t222: 'brycen',\r\n\t223: 'iris',\r\n\t224: 'drayden',\r\n\t225: 'roughneck',\r\n\t226: 'janitor',\r\n\t227: 'pokefan',\r\n\t228: 'pokefanf',\r\n\t229: 'doctor',\r\n\t230: 'nurse',\r\n\t231: 'hooligans',\r\n\t232: 'battlegirl',\r\n\t233: 'parasollady',\r\n\t234: 'clerk',\r\n\t235: 'clerk-boss',\r\n\t236: 'backers',\r\n\t237: 'backersf',\r\n\t238: 'veteran',\r\n\t239: 'veteranf',\r\n\t240: 'biker',\r\n\t241: 'infielder',\r\n\t242: 'hiker',\r\n\t243: 'madame',\r\n\t244: 'gentleman',\r\n\t245: 'plasmagruntf-gen5bw',\r\n\t246: 'shauntal',\r\n\t247: 'marshal',\r\n\t248: 'grimsley',\r\n\t249: 'caitlin',\r\n\t250: 'ghetsis-gen5bw',\r\n\t251: 'depotagent',\r\n\t252: 'swimmer',\r\n\t253: 'swimmerf',\r\n\t254: 'policeman',\r\n\t255: 'maid',\r\n\t256: 'ingo',\r\n\t257: 'alder',\r\n\t258: 'cyclist',\r\n\t259: 'cyclistf',\r\n\t260: 'cynthia',\r\n\t261: 'emmet',\r\n\t262: 'hilbert-wonderlauncher',\r\n\t263: 'hilda-wonderlauncher',\r\n\t264: 'hugh',\r\n\t265: 'rosa',\r\n\t266: 'nate',\r\n\t267: 'colress',\r\n\t268: 'beauty-gen5bw2',\r\n\t269: 'ghetsis',\r\n\t270: 'plasmagrunt',\r\n\t271: 'plasmagruntf',\r\n\t272: 'iris-gen5bw2',\r\n\t273: 'brycenman',\r\n\t274: 'shadowtriad',\r\n\t275: 'rood',\r\n\t276: 'zinzolin',\r\n\t277: 'cheren-gen5bw2',\r\n\t278: 'marlon',\r\n\t279: 'roxie',\r\n\t280: 'roxanne',\r\n\t281: 'brawly',\r\n\t282: 'wattson',\r\n\t283: 'flannery',\r\n\t284: 'norman',\r\n\t285: 'winona',\r\n\t286: 'tate',\r\n\t287: 'liza',\r\n\t288: 'juan',\r\n\t289: 'guitarist',\r\n\t290: 'steven',\r\n\t291: 'wallace',\r\n\t292: 'bellelba',\r\n\t293: 'benga',\r\n\t294: 'ash',\r\n\t'#bw2elesa': 'elesa-gen5bw2',\r\n\t'#teamrocket': 'teamrocket',\r\n\t'#yellow': 'yellow',\r\n\t'#zinnia': 'zinnia',\r\n\t'#clemont': 'clemont',\r\n\t'#wally': 'wally',\r\n\tbreeder: 'pokemonbreeder',\r\n\tbreederf: 'pokemonbreederf',\r\n\t'hilbert-dueldisk': 'hilbert-wonderlauncher',\r\n\t'hilda-dueldisk': 'hilda-wonderlauncher',\r\n\t'nate-dueldisk': 'nate-wonderlauncher',\r\n\t'rosa-dueldisk': 'rosa-wonderlauncher',\r\n\r\n\t1001: '#1001',\r\n\t1002: '#1002',\r\n\t1003: '#1003',\r\n\t1005: '#1005',\r\n\t1010: '#1010',\r\n};\r\n\r\ntype StatName = 'hp' | 'atk' | 'def' | 'spa' | 'spd' | 'spe';\r\ntype NatureName = 'Adamant' | 'Bashful' | 'Bold' | 'Brave' | 'Calm' | 'Careful' | 'Docile' | 'Gentle' |\r\n\t'Hardy' | 'Hasty' | 'Impish' | 'Jolly' | 'Lax' | 'Lonely' | 'Mild' | 'Modest' | 'Naive' | 'Naughty' |\r\n\t'Quiet' | 'Quirky' | 'Rash' | 'Relaxed' | 'Sassy' | 'Serious' | 'Timid';\r\ntype StatNameExceptHP = 'atk' | 'def' | 'spa' | 'spd' | 'spe';\r\ntype TypeName = 'Normal' | 'Fighting' | 'Flying' | 'Poison' | 'Ground' | 'Rock' | 'Bug' | 'Ghost' | 'Steel' |\r\n\t'Fire' | 'Water' | 'Grass' | 'Electric' | 'Psychic' | 'Ice' | 'Dragon' | 'Dark' | 'Fairy' | '???';\r\ntype StatusName = 'par' | 'psn' | 'frz' | 'slp' | 'brn';\r\ntype BoostStatName = 'atk' | 'def' | 'spa' | 'spd' | 'spe' | 'evasion' | 'accuracy' | 'spc';\r\ntype GenderName = 'M' | 'F' | 'N';\r\n\r\ninterface Effect {\r\n\treadonly id: ID;\r\n\treadonly name: string;\r\n\treadonly gen: number;\r\n\treadonly effectType: 'Item' | 'Move' | 'Ability' | 'Species' | 'PureEffect';\r\n\t/**\r\n\t * Do we have data on this item/move/ability/species?\r\n\t * WARNING: Always false if the relevant data files aren't loaded.\r\n\t */\r\n\treadonly exists: boolean;\r\n}\r\n\r\nclass PureEffect implements Effect {\r\n\treadonly effectType = 'PureEffect';\r\n\treadonly id: ID;\r\n\treadonly name: string;\r\n\treadonly gen: number;\r\n\treadonly exists: boolean;\r\n\tconstructor(id: ID, name: string) {\r\n\t\tthis.id = id;\r\n\t\tthis.name = name;\r\n\t\tthis.gen = 0;\r\n\t\tthis.exists = false;\r\n\t}\r\n}\r\n\r\nclass Item implements Effect {\r\n\t// effect\r\n\treadonly effectType = 'Item';\r\n\treadonly id: ID;\r\n\treadonly name: string;\r\n\treadonly gen: number;\r\n\treadonly exists: boolean;\r\n\r\n\treadonly num: number;\r\n\treadonly spritenum: number;\r\n\treadonly desc: string;\r\n\treadonly shortDesc: string;\r\n\r\n\treadonly megaStone: string;\r\n\treadonly megaEvolves: string;\r\n\treadonly zMove: string | true | null;\r\n\treadonly zMoveType: TypeName | '';\r\n\treadonly zMoveFrom: string;\r\n\treadonly zMoveUser: readonly string[] | null;\r\n\treadonly onPlate: TypeName;\r\n\treadonly onMemory: TypeName;\r\n\treadonly onDrive: TypeName;\r\n\treadonly fling: any;\r\n\treadonly naturalGift: any;\r\n\treadonly isPokeball: boolean;\r\n\treadonly itemUser?: readonly string[];\r\n\r\n\tconstructor(id: ID, name: string, data: any) {\r\n\t\tif (!data || typeof data !== 'object') data = {};\r\n\t\tif (data.name) name = data.name;\r\n\t\tthis.name = Dex.sanitizeName(name);\r\n\t\tthis.id = id;\r\n\t\tthis.gen = data.gen || 0;\r\n\t\tthis.exists = ('exists' in data ? !!data.exists : true);\r\n\r\n\t\tthis.num = data.num || 0;\r\n\t\tthis.spritenum = data.spritenum || 0;\r\n\t\tthis.desc = data.desc || data.shortDesc || '';\r\n\t\tthis.shortDesc = data.shortDesc || this.desc;\r\n\r\n\t\tthis.megaStone = data.megaStone || '';\r\n\t\tthis.megaEvolves = data.megaEvolves || '';\r\n\t\tthis.zMove = data.zMove || null;\r\n\t\tthis.zMoveType = data.zMoveType || '';\r\n\t\tthis.zMoveFrom = data.zMoveFrom || '';\r\n\t\tthis.zMoveUser = data.zMoveUser || null;\r\n\t\tthis.onPlate = data.onPlate || '';\r\n\t\tthis.onMemory = data.onMemory || '';\r\n\t\tthis.onDrive = data.onDrive || '';\r\n\t\tthis.fling = data.fling || null;\r\n\t\tthis.naturalGift = data.naturalGift || null;\r\n\t\tthis.isPokeball = !!data.isPokeball;\r\n\t\tthis.itemUser = data.itemUser;\r\n\r\n\t\tif (!this.gen) {\r\n\t\t\tif (this.num >= 577) {\r\n\t\t\t\tthis.gen = 6;\r\n\t\t\t} else if (this.num >= 537) {\r\n\t\t\t\tthis.gen = 5;\r\n\t\t\t} else if (this.num >= 377) {\r\n\t\t\t\tthis.gen = 4;\r\n\t\t\t} else {\r\n\t\t\t\tthis.gen = 3;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\ninterface MoveFlags {\r\n\t/** The move has an animation when used on an ally. */\r\n\tallyanim?: 1 | 0;\r\n\t/** Power is multiplied by 1.5 when used by a Pokemon with the Strong Jaw Ability. */\r\n\tbite?: 1 | 0;\r\n\t/** Has no effect on Pokemon with the Bulletproof Ability. */\r\n\tbullet?: 1 | 0;\r\n\t/** Ignores a target's substitute. */\r\n\tbypasssub?: 1 | 0;\r\n\t/** The user is unable to make a move between turns. */\r\n\tcharge?: 1 | 0;\r\n\t/** Makes contact. */\r\n\tcontact?: 1 | 0;\r\n\t/** When used by a Pokemon, other Pokemon with the Dancer Ability can attempt to execute the same move. */\r\n\tdance?: 1 | 0;\r\n\t/** Thaws the user if executed successfully while the user is frozen. */\r\n\tdefrost?: 1 | 0;\r\n\t/** Can target a Pokemon positioned anywhere in a Triple Battle. */\r\n\tdistance?: 1 | 0;\r\n\t/** Prevented from being executed or selected during Gravity's effect. */\r\n\tgravity?: 1 | 0;\r\n\t/** Prevented from being executed or selected during Heal Block's effect. */\r\n\theal?: 1 | 0;\r\n\t/** Can be copied by Mirror Move. */\r\n\tmirror?: 1 | 0;\r\n\t/** Prevented from being executed or selected in a Sky Battle. */\r\n\tnonsky?: 1 | 0;\r\n\t/** Has no effect on Grass-type Pokemon, Pokemon with the Overcoat Ability, and Pokemon holding Safety Goggles. */\r\n\tpowder?: 1 | 0;\r\n\t/** Blocked by Detect, Protect, Spiky Shield, and if not a Status move, King's Shield. */\r\n\tprotect?: 1 | 0;\r\n\t/** Power is multiplied by 1.5 when used by a Pokemon with the Mega Launcher Ability. */\r\n\tpulse?: 1 | 0;\r\n\t/** Power is multiplied by 1.2 when used by a Pokemon with the Iron Fist Ability. */\r\n\tpunch?: 1 | 0;\r\n\t/** If this move is successful, the user must recharge on the following turn and cannot make a move. */\r\n\trecharge?: 1 | 0;\r\n\t/** Bounced back to the original user by Magic Coat or the Magic Bounce Ability. */\r\n\treflectable?: 1 | 0;\r\n\t/** Can be stolen from the original user and instead used by another Pokemon using Snatch. */\r\n\tsnatch?: 1 | 0;\r\n\t/** Has no effect on Pokemon with the Soundproof Ability. */\r\n\tsound?: 1 | 0;\r\n}\r\n\r\ntype MoveTarget = 'normal' | 'any' | 'adjacentAlly' | 'adjacentFoe' | 'adjacentAllyOrSelf' | // single-target\r\n\t'self' | 'randomNormal' | // single-target, automatic\r\n\t'allAdjacent' | 'allAdjacentFoes' | // spread\r\n\t'allySide' | 'foeSide' | 'all'; // side and field\r\n\r\nclass Move implements Effect {\r\n\t// effect\r\n\treadonly effectType = 'Move';\r\n\treadonly id: ID;\r\n\treadonly name: string;\r\n\treadonly gen: number;\r\n\treadonly exists: boolean;\r\n\r\n\treadonly basePower: number;\r\n\treadonly accuracy: number | true;\r\n\treadonly pp: number;\r\n\treadonly type: TypeName;\r\n\treadonly category: 'Physical' | 'Special' | 'Status';\r\n\treadonly priority: number;\r\n\treadonly target: MoveTarget;\r\n\treadonly flags: Readonly<MoveFlags>;\r\n\treadonly critRatio: number;\r\n\r\n\treadonly desc: string;\r\n\treadonly shortDesc: string;\r\n\treadonly isNonstandard: string | null;\r\n\treadonly isZ: ID;\r\n\treadonly zMove?: {\r\n\t\tbasePower?: number,\r\n\t\teffect?: string,\r\n\t\tboost?: {[stat in StatName]?: number},\r\n\t};\r\n\treadonly isMax: boolean | string;\r\n\treadonly maxMove: {basePower: number};\r\n\treadonly ohko: true | 'Ice' | null;\r\n\treadonly recoil: number[] | null;\r\n\treadonly heal: number[] | null;\r\n\treadonly multihit: number[] | number | null;\r\n\treadonly hasCrashDamage: boolean;\r\n\treadonly noPPBoosts: boolean;\r\n\treadonly secondaries: ReadonlyArray<any> | null;\r\n\treadonly num: number;\r\n\r\n\tconstructor(id: ID, name: string, data: any) {\r\n\t\tif (!data || typeof data !== 'object') data = {};\r\n\t\tif (data.name) name = data.name;\r\n\t\tthis.name = Dex.sanitizeName(name);\r\n\t\tthis.id = id;\r\n\t\tthis.gen = data.gen || 0;\r\n\t\tthis.exists = ('exists' in data ? !!data.exists : true);\r\n\r\n\t\tthis.basePower = data.basePower || 0;\r\n\t\tthis.accuracy = data.accuracy || 0;\r\n\t\tthis.pp = data.pp || 1;\r\n\t\tthis.type = data.type || '???';\r\n\t\tthis.category = data.category || 'Physical';\r\n\t\tthis.priority = data.priority || 0;\r\n\t\tthis.target = data.target || 'normal';\r\n\t\tthis.flags = data.flags || {};\r\n\t\tthis.critRatio = data.critRatio === 0 ? 0 : (data.critRatio || 1);\r\n\r\n\t\t// TODO: move to text.js\r\n\t\tthis.desc = data.desc;\r\n\t\tthis.shortDesc = data.shortDesc;\r\n\t\tthis.isNonstandard = data.isNonstandard || null;\r\n\t\tthis.isZ = data.isZ || '';\r\n\t\tthis.zMove = data.zMove || {};\r\n\t\tthis.ohko = data.ohko || null;\r\n\t\tthis.recoil = data.recoil || null;\r\n\t\tthis.heal = data.heal || null;\r\n\t\tthis.multihit = data.multihit || null;\r\n\t\tthis.hasCrashDamage = data.hasCrashDamage || false;\r\n\t\tthis.noPPBoosts = data.noPPBoosts || false;\r\n\t\tthis.secondaries = data.secondaries || (data.secondary ? [data.secondary] : null);\r\n\r\n\t\tthis.isMax = data.isMax || false;\r\n\t\tthis.maxMove = data.maxMove || {basePower: 0};\r\n\t\tif (this.category !== 'Status' && !this.maxMove?.basePower) {\r\n\t\t\tif (this.isZ || this.isMax) {\r\n\t\t\t\tthis.maxMove = {basePower: 1};\r\n\t\t\t} else if (!this.basePower) {\r\n\t\t\t\tthis.maxMove = {basePower: 100};\r\n\t\t\t} else if (['Fighting', 'Poison'].includes(this.type)) {\r\n\t\t\t\tif (this.basePower >= 150) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 100};\r\n\t\t\t\t} else if (this.basePower >= 110) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 95};\r\n\t\t\t\t} else if (this.basePower >= 75) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 90};\r\n\t\t\t\t} else if (this.basePower >= 65) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 85};\r\n\t\t\t\t} else if (this.basePower >= 55) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 80};\r\n\t\t\t\t} else if (this.basePower >= 45) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 75};\r\n\t\t\t\t} else  {\r\n\t\t\t\t\tthis.maxMove = {basePower: 70};\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.basePower >= 150) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 150};\r\n\t\t\t\t} else if (this.basePower >= 110) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 140};\r\n\t\t\t\t} else if (this.basePower >= 75) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 130};\r\n\t\t\t\t} else if (this.basePower >= 65) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 120};\r\n\t\t\t\t} else if (this.basePower >= 55) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 110};\r\n\t\t\t\t} else if (this.basePower >= 45) {\r\n\t\t\t\t\tthis.maxMove = {basePower: 100};\r\n\t\t\t\t} else  {\r\n\t\t\t\t\tthis.maxMove = {basePower: 90};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.category !== 'Status' && !this.isZ && !this.isMax) {\r\n\t\t\tlet basePower = this.basePower;\r\n\t\t\tthis.zMove = {};\r\n\t\t\tif (Array.isArray(this.multihit)) basePower *= 3;\r\n\t\t\tif (!basePower) {\r\n\t\t\t\tthis.zMove.basePower = 100;\r\n\t\t\t} else if (basePower >= 140) {\r\n\t\t\t\tthis.zMove.basePower = 200;\r\n\t\t\t} else if (basePower >= 130) {\r\n\t\t\t\tthis.zMove.basePower = 195;\r\n\t\t\t} else if (basePower >= 120) {\r\n\t\t\t\tthis.zMove.basePower = 190;\r\n\t\t\t} else if (basePower >= 110) {\r\n\t\t\t\tthis.zMove.basePower = 185;\r\n\t\t\t} else if (basePower >= 100) {\r\n\t\t\t\tthis.zMove.basePower = 180;\r\n\t\t\t} else if (basePower >= 90) {\r\n\t\t\t\tthis.zMove.basePower = 175;\r\n\t\t\t} else if (basePower >= 80) {\r\n\t\t\t\tthis.zMove.basePower = 160;\r\n\t\t\t} else if (basePower >= 70) {\r\n\t\t\t\tthis.zMove.basePower = 140;\r\n\t\t\t} else if (basePower >= 60) {\r\n\t\t\t\tthis.zMove.basePower = 120;\r\n\t\t\t} else {\r\n\t\t\t\tthis.zMove.basePower = 100;\r\n\t\t\t}\r\n\t\t\tif (data.zMove) this.zMove.basePower = data.zMove.basePower;\r\n\t\t}\r\n\r\n\t\tthis.num = data.num || 0;\r\n\t\tif (!this.gen) {\r\n\t\t\tif (this.num >= 743) {\r\n\t\t\t\tthis.gen = 8;\r\n\t\t\t} else if (this.num >= 622) {\r\n\t\t\t\tthis.gen = 7;\r\n\t\t\t} else if (this.num >= 560) {\r\n\t\t\t\tthis.gen = 6;\r\n\t\t\t} else if (this.num >= 468) {\r\n\t\t\t\tthis.gen = 5;\r\n\t\t\t} else if (this.num >= 355) {\r\n\t\t\t\tthis.gen = 4;\r\n\t\t\t} else if (this.num >= 252) {\r\n\t\t\t\tthis.gen = 3;\r\n\t\t\t} else if (this.num >= 166) {\r\n\t\t\t\tthis.gen = 2;\r\n\t\t\t} else if (this.num >= 1) {\r\n\t\t\t\tthis.gen = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Ability implements Effect {\r\n\t// effect\r\n\treadonly effectType = 'Ability';\r\n\treadonly id: ID;\r\n\treadonly name: string;\r\n\treadonly gen: number;\r\n\treadonly exists: boolean;\r\n\r\n\treadonly num: number;\r\n\treadonly shortDesc: string;\r\n\treadonly desc: string;\r\n\r\n\treadonly rating: number;\r\n\treadonly isPermanent: boolean;\r\n\treadonly isNonstandard: boolean;\r\n\r\n\tconstructor(id: ID, name: string, data: any) {\r\n\t\tif (!data || typeof data !== 'object') data = {};\r\n\t\tif (data.name) name = data.name;\r\n\t\tthis.name = Dex.sanitizeName(name);\r\n\t\tthis.id = id;\r\n\t\tthis.gen = data.gen || 0;\r\n\t\tthis.exists = ('exists' in data ? !!data.exists : true);\r\n\t\tthis.num = data.num || 0;\r\n\t\tthis.shortDesc = data.shortDesc || data.desc || '';\r\n\t\tthis.desc = data.desc || data.shortDesc || '';\r\n\t\tthis.rating = data.rating || 1;\r\n\t\tthis.isPermanent = !!data.isPermanent;\r\n\t\tthis.isNonstandard = !!data.isNonstandard;\r\n\t\tif (!this.gen) {\r\n\t\t\tif (this.num >= 234) {\r\n\t\t\t\tthis.gen = 8;\r\n\t\t\t} else if (this.num >= 192) {\r\n\t\t\t\tthis.gen = 7;\r\n\t\t\t} else if (this.num >= 165) {\r\n\t\t\t\tthis.gen = 6;\r\n\t\t\t} else if (this.num >= 124) {\r\n\t\t\t\tthis.gen = 5;\r\n\t\t\t} else if (this.num >= 77) {\r\n\t\t\t\tthis.gen = 4;\r\n\t\t\t} else if (this.num >= 1) {\r\n\t\t\t\tthis.gen = 3;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass Species implements Effect {\r\n\t// effect\r\n\treadonly effectType = 'Species';\r\n\treadonly id: ID;\r\n\treadonly name: string;\r\n\treadonly gen: number;\r\n\treadonly exists: boolean;\r\n\r\n\t// name\r\n\treadonly baseSpecies: string;\r\n\treadonly forme: string;\r\n\treadonly formeid: string;\r\n\treadonly spriteid: string;\r\n\treadonly baseForme: string;\r\n\r\n\t// basic data\r\n\treadonly num: number;\r\n\treadonly types: ReadonlyArray<TypeName>;\r\n\treadonly abilities: Readonly<{\r\n\t\t0: string, 1?: string, H?: string, S?: string,\r\n\t}>;\r\n\treadonly baseStats: Readonly<{\r\n\t\thp: number, atk: number, def: number, spa: number, spd: number, spe: number,\r\n\t}>;\r\n\treadonly weightkg: number;\r\n\r\n\t// flavor data\r\n\treadonly heightm: number;\r\n\treadonly gender: GenderName;\r\n\treadonly color: string;\r\n\treadonly genderRatio: Readonly<{M: number, F: number}> | null;\r\n\treadonly eggGroups: ReadonlyArray<string>;\r\n\treadonly tags: ReadonlyArray<string>;\r\n\r\n\t// format data\r\n\treadonly otherFormes: ReadonlyArray<string> | null;\r\n\treadonly cosmeticFormes: ReadonlyArray<string> | null;\r\n\treadonly evos: ReadonlyArray<string> | null;\r\n\treadonly prevo: string;\r\n\treadonly evoType: 'trade' | 'useItem' | 'levelMove' | 'levelExtra' | 'levelFriendship' | 'levelHold' | 'other' | '';\r\n\treadonly evoLevel: number;\r\n\treadonly evoMove: string;\r\n\treadonly evoItem: string;\r\n\treadonly evoCondition: string;\r\n\treadonly requiredItem: string;\r\n\treadonly tier: string;\r\n\treadonly isTotem: boolean;\r\n\treadonly isMega: boolean;\r\n\treadonly canGigantamax: boolean;\r\n\treadonly isPrimal: boolean;\r\n\treadonly battleOnly: string | string[] | undefined;\r\n\treadonly isNonstandard: string | null;\r\n\treadonly unreleasedHidden: boolean | 'Past';\r\n\treadonly changesFrom: string | undefined;\r\n\r\n\tconstructor(id: ID, name: string, data: any) {\r\n\t\tif (!data || typeof data !== 'object') data = {};\r\n\t\tif (data.name) name = data.name;\r\n\t\tthis.name = Dex.sanitizeName(name);\r\n\t\tthis.id = id;\r\n\t\tthis.gen = data.gen || 0;\r\n\t\tthis.exists = ('exists' in data ? !!data.exists : true);\r\n\t\tthis.baseSpecies = data.baseSpecies || name;\r\n\t\tthis.forme = data.forme || '';\r\n\t\tconst baseId = toID(this.baseSpecies);\r\n\t\tthis.formeid = (baseId === this.id ? '' : '-' + toID(this.forme));\r\n\t\tthis.spriteid = baseId + this.formeid;\r\n\t\tif (this.spriteid.slice(-5) === 'totem') this.spriteid = this.spriteid.slice(0, -5);\r\n\t\tif (this.spriteid.slice(-1) === '-') this.spriteid = this.spriteid.slice(0, -1);\r\n\t\tthis.baseForme = data.baseForme || '';\r\n\r\n\t\tthis.num = data.num || 0;\r\n\t\tthis.types = data.types || ['???'];\r\n\t\tthis.abilities = data.abilities || {0: \"No Ability\"};\r\n\t\tthis.baseStats = data.baseStats || {hp: 0, atk: 0, def: 0, spa: 0, spd: 0, spe: 0};\r\n\t\tthis.weightkg = data.weightkg || 0;\r\n\r\n\t\tthis.heightm = data.heightm || 0;\r\n\t\tthis.gender = data.gender || '';\r\n\t\tthis.color = data.color || '';\r\n\t\tthis.genderRatio = data.genderRatio || null;\r\n\t\tthis.eggGroups = data.eggGroups || [];\r\n\t\tthis.tags = data.tags || [];\r\n\r\n\t\tthis.otherFormes = data.otherFormes || null;\r\n\t\tthis.cosmeticFormes = data.cosmeticFormes || null;\r\n\t\tthis.evos = data.evos || null;\r\n\t\tthis.prevo = data.prevo || '';\r\n\t\tthis.evoType = data.evoType || '';\r\n\t\tthis.evoLevel = data.evoLevel || 0;\r\n\t\tthis.evoMove = data.evoMove || '';\r\n\t\tthis.evoItem = data.evoItem || '';\r\n\t\tthis.evoCondition = data.evoCondition || '';\r\n\t\tthis.requiredItem = data.requiredItem || '';\r\n\t\tthis.tier = data.tier || '';\r\n\r\n\t\tthis.isTotem = false;\r\n\t\tthis.isMega = !!(this.forme && ['-mega', '-megax', '-megay'].includes(this.formeid));\r\n\t\tthis.canGigantamax = !!data.canGigantamax;\r\n\t\tthis.isPrimal = !!(this.forme && this.formeid === '-primal');\r\n\t\tthis.battleOnly = data.battleOnly || undefined;\r\n\t\tthis.isNonstandard = data.isNonstandard || null;\r\n\t\tthis.unreleasedHidden = data.unreleasedHidden || false;\r\n\t\tthis.changesFrom = data.changesFrom || undefined;\r\n\t\tif (!this.gen) {\r\n\t\t\tif (this.num >= 810 || this.formeid.startsWith('-galar')) {\r\n\t\t\t\tthis.gen = 8;\r\n\t\t\t} else if (this.num >= 722 || this.formeid === '-alola' || this.formeid === '-starter') {\r\n\t\t\t\tthis.gen = 7;\r\n\t\t\t} else if (this.isMega || this.isPrimal) {\r\n\t\t\t\tthis.gen = 6;\r\n\t\t\t\tthis.battleOnly = this.baseSpecies;\r\n\t\t\t} else if (this.formeid === '-totem' || this.formeid === '-alolatotem') {\r\n\t\t\t\tthis.gen = 7;\r\n\t\t\t\tthis.isTotem = true;\r\n\t\t\t} else if (this.num >= 650) {\r\n\t\t\t\tthis.gen = 6;\r\n\t\t\t} else if (this.num >= 494) {\r\n\t\t\t\tthis.gen = 5;\r\n\t\t\t} else if (this.num >= 387) {\r\n\t\t\t\tthis.gen = 4;\r\n\t\t\t} else if (this.num >= 252) {\r\n\t\t\t\tthis.gen = 3;\r\n\t\t\t} else if (this.num >= 152) {\r\n\t\t\t\tthis.gen = 2;\r\n\t\t\t} else if (this.num >= 1) {\r\n\t\t\t\tthis.gen = 1;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\ninterface Type extends Effect {\r\n\tdamageTaken?: AnyObject;\r\n\tHPivs?: Partial<StatsTable>;\r\n\tHPdvs?: Partial<StatsTable>;\r\n}\r\n\r\nif (typeof require === 'function') {\r\n\t// in Node\r\n\t(global as any).BattleBaseSpeciesChart = BattleBaseSpeciesChart;\r\n\t(global as any).BattleNatures = BattleNatures;\r\n\t(global as any).PureEffect = PureEffect;\r\n\t(global as any).Species = Species;\r\n\t(global as any).Ability = Ability;\r\n\t(global as any).Item = Item;\r\n\t(global as any).Move = Move;\r\n}\r\n","/**\r\n * Battle log\r\n *\r\n * An exercise in minimalism! This is a dependency of the client, which\r\n * requires IE9+ and uses Preact, and the replay player, which requires\r\n * IE7+ and uses jQuery. Therefore, this has to be compatible with IE7+\r\n * and use the DOM directly!\r\n *\r\n * Special thanks to PPK for QuirksMode.org, one of the few resources\r\n * available for how to do web development in these conditions.\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license MIT\r\n */\r\n\r\nimport type {BattleScene} from './battle-animations';\r\n\r\n// Caja\r\ndeclare const html4: any;\r\ndeclare const html: any;\r\n\r\n// defined in battle-log-misc\r\ndeclare function MD5(input: string): string;\r\ndeclare function formatText(input: string, isTrusted?: boolean): string;\r\n\r\nexport class BattleLog {\r\n\telem: HTMLDivElement;\r\n\tinnerElem: HTMLDivElement;\r\n\tscene: BattleScene | null = null;\r\n\tpreemptElem: HTMLDivElement = null!;\r\n\tatBottom = true;\r\n\tclassName: string;\r\n\tbattleParser: BattleTextParser | null = null;\r\n\tjoinLeave: {\r\n\t\tjoins: string[],\r\n\t\tleaves: string[],\r\n\t\telement: HTMLDivElement,\r\n\t} | null = null;\r\n\tlastRename: {\r\n\t\tfrom: string,\r\n\t\tto: string,\r\n\t\telement: HTMLDivElement,\r\n\t} | null = null;\r\n\t/**\r\n\t * * -1 = spectator: \"Red sent out Pikachu!\" \"Blue's Eevee used Tackle!\"\r\n\t * * 0 = player 1: \"Go! Pikachu!\" \"The opposing Eevee used Tackle!\"\r\n\t * * 1 = player 2: \"Red sent out Pikachu!\" \"Eevee used Tackle!\"\r\n\t */\r\n\tperspective: -1 | 0 | 1 = -1;\r\n\tconstructor(elem: HTMLDivElement, scene?: BattleScene | null, innerElem?: HTMLDivElement) {\r\n\t\tthis.elem = elem;\r\n\r\n\t\tif (!innerElem) {\r\n\t\t\telem.setAttribute('role', 'log');\r\n\t\t\telem.innerHTML = '';\r\n\t\t\tinnerElem = document.createElement('div');\r\n\t\t\tinnerElem.className = 'inner message-log';\r\n\t\t\telem.appendChild(innerElem);\r\n\t\t}\r\n\t\tthis.innerElem = innerElem;\r\n\r\n\t\tif (scene) {\r\n\t\t\tthis.scene = scene;\r\n\t\t\tconst preemptElem = document.createElement('div');\r\n\t\t\tpreemptElem.className = 'inner-preempt message-log';\r\n\t\t\telem.appendChild(preemptElem);\r\n\t\t\tthis.preemptElem = preemptElem;\r\n\t\t\tthis.battleParser = new BattleTextParser();\r\n\t\t}\r\n\r\n\t\tthis.className = elem.className;\r\n\t\telem.onscroll = this.onScroll;\r\n\t}\r\n\tonScroll = () => {\r\n\t\tconst distanceFromBottom = this.elem.scrollHeight - this.elem.scrollTop - this.elem.clientHeight;\r\n\t\tthis.atBottom = (distanceFromBottom < 30);\r\n\t};\r\n\treset() {\r\n\t\tthis.innerElem.innerHTML = '';\r\n\t\tthis.atBottom = true;\r\n\t}\r\n\tdestroy() {\r\n\t\tthis.elem.onscroll = null;\r\n\t}\r\n\tadd(args: Args, kwArgs?: KWArgs, preempt?: boolean) {\r\n\t\tif (kwArgs?.silent) return;\r\n\t\tlet divClass = 'chat';\r\n\t\tlet divHTML = '';\r\n\t\tlet noNotify: boolean | undefined;\r\n\t\tif (!['join', 'j', 'leave', 'l'].includes(args[0])) this.joinLeave = null;\r\n\t\tif (!['name', 'n'].includes(args[0])) this.lastRename = null;\r\n\t\tswitch (args[0]) {\r\n\t\tcase 'chat': case 'c': case 'c:':\r\n\t\t\tlet battle = this.scene?.battle;\r\n\t\t\tlet name;\r\n\t\t\tlet message;\r\n\t\t\tif (args[0] === 'c:') {\r\n\t\t\t\tname = args[2];\r\n\t\t\t\tmessage = args[3];\r\n\t\t\t} else {\r\n\t\t\t\tname = args[1];\r\n\t\t\t\tmessage = args[2];\r\n\t\t\t}\r\n\t\t\tlet rank = name.charAt(0);\r\n\t\t\tif (battle?.ignoreSpects && ' +'.includes(rank)) return;\r\n\t\t\tif (battle?.ignoreOpponent) {\r\n\t\t\t\tif ('\\u2605\\u2606'.includes(rank) && toUserid(name) !== app.user.get('userid')) return;\r\n\t\t\t}\r\n\t\t\tif (window.app?.ignore?.[toUserid(name)] && ' +\\u2605\\u2606'.includes(rank)) return;\r\n\t\t\tlet isHighlighted = window.app?.rooms?.[battle!.roomid].getHighlight(message);\r\n\t\t\t[divClass, divHTML, noNotify] = this.parseChatMessage(message, name, '', isHighlighted);\r\n\t\t\tif (!noNotify && isHighlighted) {\r\n\t\t\t\tlet notifyTitle = \"Mentioned by \" + name + \" in \" + battle!.roomid;\r\n\t\t\t\tapp.rooms[battle!.roomid].notifyOnce(notifyTitle, \"\\\"\" + message + \"\\\"\", 'highlight');\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'join': case 'j': case 'leave': case 'l': {\r\n\t\t\tconst user = BattleTextParser.parseNameParts(args[1]);\r\n\t\t\tif (battle?.ignoreSpects && ' +'.includes(user.group)) return;\r\n\t\t\tconst formattedUser = user.group + user.name;\r\n\t\t\tconst isJoin = (args[0].charAt(0) === 'j');\r\n\t\t\tif (!this.joinLeave) {\r\n\t\t\t\tthis.joinLeave = {\r\n\t\t\t\t\tjoins: [],\r\n\t\t\t\t\tleaves: [],\r\n\t\t\t\t\telement: document.createElement('div'),\r\n\t\t\t\t};\r\n\t\t\t\tthis.joinLeave.element.className = 'chat';\r\n\t\t\t}\r\n\r\n\t\t\tif (isJoin && this.joinLeave.leaves.includes(formattedUser)) {\r\n\t\t\t\tthis.joinLeave.leaves.splice(this.joinLeave.leaves.indexOf(formattedUser), 1);\r\n\t\t\t} else {\r\n\t\t\t\tthis.joinLeave[isJoin ? \"joins\" : \"leaves\"].push(formattedUser);\r\n\t\t\t}\r\n\r\n\t\t\tlet buf = '';\r\n\t\t\tif (this.joinLeave.joins.length) {\r\n\t\t\t\tbuf += `${this.textList(this.joinLeave.joins)} joined`;\r\n\t\t\t}\r\n\t\t\tif (this.joinLeave.leaves.length) {\r\n\t\t\t\tif (this.joinLeave.joins.length) buf += `; `;\r\n\t\t\t\tbuf += `${this.textList(this.joinLeave.leaves)} left`;\r\n\t\t\t}\r\n\t\t\tthis.joinLeave.element.innerHTML = `<small>${BattleLog.escapeHTML(buf)}</small>`;\r\n\t\t\t(preempt ? this.preemptElem : this.innerElem).appendChild(this.joinLeave.element);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tcase 'name': case 'n': {\r\n\t\t\tconst user = BattleTextParser.parseNameParts(args[1]);\r\n\t\t\tif (toID(args[2]) === toID(user.name)) return;\r\n\t\t\tif (!this.lastRename || toID(this.lastRename.to) !== toID(user.name)) {\r\n\t\t\t\tthis.lastRename = {\r\n\t\t\t\t\tfrom: args[2],\r\n\t\t\t\t\tto: '',\r\n\t\t\t\t\telement: document.createElement('div'),\r\n\t\t\t\t};\r\n\t\t\t\tthis.lastRename.element.className = 'chat';\r\n\t\t\t}\r\n\t\t\tthis.lastRename.to = user.group + user.name;\r\n\t\t\tthis.lastRename.element.innerHTML = `<small>${BattleLog.escapeHTML(this.lastRename.to)} renamed from ${BattleLog.escapeHTML(this.lastRename.from)}.</small>`;\r\n\t\t\t(preempt ? this.preemptElem : this.innerElem).appendChild(this.lastRename.element);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tcase 'chatmsg': case '':\r\n\t\t\tdivHTML = BattleLog.escapeHTML(args[1]);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'chatmsg-raw': case 'raw': case 'html':\r\n\t\t\tdivHTML = BattleLog.sanitizeHTML(args[1]);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'uhtml': case 'uhtmlchange':\r\n\t\t\tthis.changeUhtml(args[1], args[2], args[0] === 'uhtml');\r\n\t\t\treturn ['', ''];\r\n\r\n\t\tcase 'error': case 'inactive': case 'inactiveoff':\r\n\t\t\tdivClass = 'chat message-error';\r\n\t\t\tdivHTML = BattleLog.escapeHTML(args[1]);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'bigerror':\r\n\t\t\tthis.message('<div class=\"broadcast-red\">' + BattleLog.escapeHTML(args[1]).replace(/\\|/g, '<br />') + '</div>');\r\n\t\t\treturn;\r\n\r\n\t\tcase 'pm':\r\n\t\t\tdivHTML = '<strong>' + BattleLog.escapeHTML(args[1]) + ':</strong> <span class=\"message-pm\"><i style=\"cursor:pointer\" onclick=\"selectTab(\\'lobby\\');rooms.lobby.popupOpen(\\'' + BattleLog.escapeHTML(args[2], true) + '\\')\">(Private to ' + BattleLog.escapeHTML(args[3]) + ')</i> ' + BattleLog.parseMessage(args[4]) + '</span>';\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'askreg':\r\n\t\t\tthis.addDiv('chat', '<div class=\"broadcast-blue\"><b>Register an account to protect your ladder rating!</b><br /><button name=\"register\" value=\"' + BattleLog.escapeHTML(args[1]) + '\"><b>Register</b></button></div>');\r\n\t\t\treturn;\r\n\r\n\t\tcase 'unlink': {\r\n\t\t\t// |unlink| is deprecated in favor of |hidelines|\r\n\t\t\tconst user = toID(args[2]) || toID(args[1]);\r\n\t\t\tthis.unlinkChatFrom(user);\r\n\t\t\tif (args[2]) {\r\n\t\t\t\tconst lineCount = parseInt(args[3], 10);\r\n\t\t\t\tthis.hideChatFrom(user, true, lineCount);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tcase 'hidelines': {\r\n\t\t\tconst user = toID(args[2]);\r\n\t\t\tthis.unlinkChatFrom(user);\r\n\t\t\tif (args[1] !== 'unlink') {\r\n\t\t\t\tconst lineCount = parseInt(args[3], 10);\r\n\t\t\t\tthis.hideChatFrom(user, args[1] === 'hide', lineCount);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tcase 'debug':\r\n\t\t\tdivClass = 'debug';\r\n\t\t\tdivHTML = '<div class=\"chat\"><small style=\"color:#999\">[DEBUG] ' + BattleLog.escapeHTML(args[1]) + '.</small></div>';\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'notify':\r\n\t\t\tconst title = args[1];\r\n\t\t\tconst body = args[2];\r\n\t\t\tconst roomid = this.scene?.battle.roomid;\r\n\t\t\tif (!roomid) break;\r\n\t\t\tapp.rooms[roomid].notifyOnce(title, body, 'highlight');\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'seed': case 'choice': case ':': case 'timer': case 't:':\r\n\t\tcase 'J': case 'L': case 'N': case 'spectator': case 'spectatorleave':\r\n\t\tcase 'initdone':\r\n\t\t\treturn;\r\n\r\n\t\tdefault:\r\n\t\t\tthis.addBattleMessage(args, kwArgs);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (divHTML) this.addDiv(divClass, divHTML, preempt);\r\n\t}\r\n\taddBattleMessage(args: Args, kwArgs?: KWArgs) {\r\n\t\tswitch (args[0]) {\r\n\t\tcase 'warning':\r\n\t\t\tthis.message('<strong>Warning:</strong> ' + BattleLog.escapeHTML(args[1]));\r\n\t\t\tthis.message(`Bug? Report it to <a href=\"http://www.smogon.com/forums/showthread.php?t=3453192\">the replay viewer's Smogon thread</a>`);\r\n\t\t\tif (this.scene) this.scene.wait(1000);\r\n\t\t\treturn;\r\n\r\n\t\tcase 'variation':\r\n\t\t\tthis.addDiv('', '<small>Variation: <em>' + BattleLog.escapeHTML(args[1]) + '</em></small>');\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'rule':\r\n\t\t\tconst ruleArgs = args[1].split(': ');\r\n\t\t\tthis.addDiv('', '<small><em>' + BattleLog.escapeHTML(ruleArgs[0]) + (ruleArgs[1] ? ':' : '') + '</em> ' + BattleLog.escapeHTML(ruleArgs[1] || '') + '</small>');\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'rated':\r\n\t\t\tthis.addDiv('rated', '<strong>' + (BattleLog.escapeHTML(args[1]) || 'Rated battle') + '</strong>');\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'tier':\r\n\t\t\tthis.addDiv('', '<small>Format:</small> <br /><strong>' + BattleLog.escapeHTML(args[1]) + '</strong>');\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'turn':\r\n\t\t\tconst h2elem = document.createElement('h2');\r\n\t\t\th2elem.className = 'battle-history';\r\n\t\t\tlet turnMessage;\r\n\t\t\tif (this.battleParser) {\r\n\t\t\t\tturnMessage = this.battleParser.parseArgs(args, {}).trim();\r\n\t\t\t\tif (!turnMessage.startsWith('==') || !turnMessage.endsWith('==')) {\r\n\t\t\t\t\tthrow new Error(\"Turn message must be a heading.\");\r\n\t\t\t\t}\r\n\t\t\t\tturnMessage = turnMessage.slice(2, -2).trim();\r\n\t\t\t\tthis.battleParser.curLineSection = 'break';\r\n\t\t\t} else {\r\n\t\t\t\tturnMessage = `Turn ${args[1]}`;\r\n\t\t\t}\r\n\t\t\th2elem.innerHTML = BattleLog.escapeHTML(turnMessage);\r\n\t\t\tthis.addSpacer();\r\n\t\t\tthis.addNode(h2elem);\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tlet line = null;\r\n\t\t\tif (this.battleParser) {\r\n\t\t\t\tline = this.battleParser.parseArgs(args, kwArgs || {}, true);\r\n\t\t\t}\r\n\t\t\tif (line === null) {\r\n\t\t\t\tthis.addDiv('chat message-error', 'Unrecognized: |' + BattleLog.escapeHTML(args.join('|')));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!line) return;\r\n\t\t\tthis.message(...this.parseLogMessage(line));\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\ttextList(list: string[]) {\r\n\t\tlet message = '';\r\n\t\tconst listNoDuplicates: string[] = [];\r\n\t\tfor (const user of list) {\r\n\t\t\tif (!listNoDuplicates.includes(user)) listNoDuplicates.push(user);\r\n\t\t}\r\n\t\tlist = listNoDuplicates;\r\n\r\n\t\tif (list.length === 1) return list[0];\r\n\t\tif (list.length === 2) return `${list[0]} and ${list[1]}`;\r\n\t\tfor (let i = 0; i < list.length - 1; i++) {\r\n\t\t\tif (i >= 5) {\r\n\t\t\t\treturn `${message}and ${list.length - 5} others`;\r\n\t\t\t}\r\n\t\t\tmessage += `${list[i]}, `;\r\n\t\t}\r\n\t\treturn `${message}and ${list[list.length - 1]}`;\r\n\t\treturn message;\r\n\t}\r\n\t/**\r\n\t * To avoid trolling with nicknames, we can't just run this through\r\n\t * parseMessage\r\n\t */\r\n\tparseLogMessage(message: string): [string, string] {\r\n\t\tconst messages = message.split('\\n').map(line => {\r\n\t\t\tline = BattleLog.escapeHTML(line);\r\n\t\t\tline = line.replace(/\\*\\*(.*)\\*\\*/, '<strong>$1</strong>');\r\n\t\t\tline = line.replace(/\\|\\|([^\\|]*)\\|\\|([^\\|]*)\\|\\|/, '<abbr title=\"$1\">$2</abbr>');\r\n\t\t\tif (line.startsWith('  ')) line = '<small>' + line.trim() + '</small>';\r\n\t\t\treturn line;\r\n\t\t});\r\n\t\treturn [\r\n\t\t\tmessages.join('<br />'),\r\n\t\t\tmessages.filter(line => !line.startsWith('<small>[')).join('<br />'),\r\n\t\t];\r\n\t}\r\n\tmessage(message: string, sceneMessage = message) {\r\n\t\tif (this.scene) this.scene.message(sceneMessage);\r\n\t\tthis.addDiv('battle-history', message);\r\n\t}\r\n\taddNode(node: HTMLElement, preempt?: boolean) {\r\n\t\t(preempt ? this.preemptElem : this.innerElem).appendChild(node);\r\n\t\tif (this.atBottom) {\r\n\t\t\tthis.elem.scrollTop = this.elem.scrollHeight;\r\n\t\t}\r\n\t}\r\n\tupdateScroll() {\r\n\t\tif (this.atBottom) {\r\n\t\t\tthis.elem.scrollTop = this.elem.scrollHeight;\r\n\t\t}\r\n\t}\r\n\taddDiv(className: string, innerHTML: string, preempt?: boolean) {\r\n\t\tconst el = document.createElement('div');\r\n\t\tel.className = className;\r\n\t\tel.innerHTML = innerHTML;\r\n\t\tthis.addNode(el, preempt);\r\n\t}\r\n\tprependDiv(className: string, innerHTML: string, preempt?: boolean) {\r\n\t\tconst el = document.createElement('div');\r\n\t\tel.className = className;\r\n\t\tel.innerHTML = innerHTML;\r\n\t\tif (this.innerElem.childNodes.length) {\r\n\t\t\tthis.innerElem.insertBefore(el, this.innerElem.childNodes[0]);\r\n\t\t} else {\r\n\t\t\tthis.innerElem.appendChild(el);\r\n\t\t}\r\n\t\tthis.updateScroll();\r\n\t}\r\n\taddSpacer() {\r\n\t\tthis.addDiv('spacer battle-history', '<br />');\r\n\t}\r\n\tchangeUhtml(id: string, htmlSrc: string, forceAdd?: boolean) {\r\n\t\tid = toID(id);\r\n\t\tconst classContains = ' uhtml-' + id + ' ';\r\n\t\tlet elements = [] as HTMLDivElement[];\r\n\t\tfor (const node of this.innerElem.childNodes as any) {\r\n\t\t\tif (node.className && (' ' + node.className + ' ').includes(classContains)) {\r\n\t\t\t\telements.push(node);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.preemptElem) {\r\n\t\t\tfor (const node of this.preemptElem.childNodes as any) {\r\n\t\t\t\tif (node.className && (' ' + node.className + ' ').includes(classContains)) {\r\n\t\t\t\t\telements.push(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (htmlSrc && elements.length && !forceAdd) {\r\n\t\t\tfor (const element of elements) {\r\n\t\t\t\telement.innerHTML = BattleLog.sanitizeHTML(htmlSrc);\r\n\t\t\t}\r\n\t\t\tthis.updateScroll();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (const element of elements) {\r\n\t\t\telement.parentElement!.removeChild(element);\r\n\t\t}\r\n\t\tif (!htmlSrc) return;\r\n\t\tif (forceAdd) {\r\n\t\t\tthis.addDiv('notice uhtml-' + id, BattleLog.sanitizeHTML(htmlSrc));\r\n\t\t} else {\r\n\t\t\tthis.prependDiv('notice uhtml-' + id, BattleLog.sanitizeHTML(htmlSrc));\r\n\t\t}\r\n\t}\r\n\thideChatFrom(userid: ID, showRevealButton = true, lineCount = 0) {\r\n\t\tconst classStart = 'chat chatmessage-' + userid + ' ';\r\n\t\tlet nodes: HTMLElement[] = [];\r\n\t\tfor (const node of this.innerElem.childNodes as any as HTMLElement[]) {\r\n\t\t\tif (node.className && (node.className + ' ').startsWith(classStart)) {\r\n\t\t\t\tnodes.push(node);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.preemptElem) {\r\n\t\t\tfor (const node of this.preemptElem.childNodes as any as HTMLElement[]) {\r\n\t\t\t\tif (node.className && (node.className + ' ').startsWith(classStart)) {\r\n\t\t\t\t\tnodes.push(node);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (lineCount) nodes = nodes.slice(-lineCount);\r\n\r\n\t\tfor (const node of nodes) {\r\n\t\t\tnode.style.display = 'none';\r\n\t\t\tnode.className = 'revealed ' + node.className;\r\n\t\t}\r\n\t\tif (!nodes.length || !showRevealButton) return;\r\n\t\tconst button = document.createElement('button');\r\n\t\tbutton.name = 'toggleMessages';\r\n\t\tbutton.value = userid;\r\n\t\tbutton.className = 'subtle';\r\n\t\tbutton.innerHTML = `<small>(${nodes.length} line${nodes.length > 1 ? 's' : ''} from ${userid} hidden)</small>`;\r\n\t\tconst lastNode = nodes[nodes.length - 1];\r\n\t\tlastNode.appendChild(document.createTextNode(' '));\r\n\t\tlastNode.appendChild(button);\r\n\t}\r\n\r\n\tstatic unlinkNodeList(nodeList: ArrayLike<HTMLElement>, classStart: string) {\r\n\t\tfor (const node of nodeList as HTMLElement[]) {\r\n\t\t\tif (node.className && (node.className + ' ').startsWith(classStart)) {\r\n\t\t\t\tconst linkList = node.getElementsByTagName('a');\r\n\t\t\t\t// iterate in reverse because linkList will update as links are removed\r\n\t\t\t\tfor (let i = linkList.length - 1; i >= 0; i--) {\r\n\t\t\t\t\tconst linkNode = linkList[i];\r\n\t\t\t\t\tconst parent = linkNode.parentElement;\r\n\t\t\t\t\tif (!parent) continue;\r\n\t\t\t\t\tfor (const childNode of linkNode.childNodes as any) {\r\n\t\t\t\t\t\tparent.insertBefore(childNode, linkNode);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparent.removeChild(linkNode);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tunlinkChatFrom(userid: ID) {\r\n\t\tconst classStart = 'chat chatmessage-' + userid + ' ';\r\n\t\tconst innerNodeList = this.innerElem.childNodes;\r\n\t\tBattleLog.unlinkNodeList(innerNodeList as NodeListOf<HTMLElement>, classStart);\r\n\r\n\t\tif (this.preemptElem) {\r\n\t\t\tconst preemptNodeList = this.preemptElem.childNodes;\r\n\t\t\tBattleLog.unlinkNodeList(preemptNodeList as NodeListOf<HTMLElement>, classStart);\r\n\t\t}\r\n\t}\r\n\r\n\tpreemptCatchup() {\r\n\t\tif (!this.preemptElem.firstChild) return;\r\n\t\tthis.innerElem.appendChild(this.preemptElem.firstChild);\r\n\t}\r\n\r\n\tstatic escapeFormat(formatid: string): string {\r\n\t\tlet atIndex = formatid.indexOf('@@@');\r\n\t\tif (atIndex >= 0) {\r\n\t\t\treturn this.escapeFormat(formatid.slice(0, atIndex)) +\r\n\t\t\t\t'<br />Custom rules: ' + this.escapeHTML(formatid.slice(atIndex + 3));\r\n\t\t}\r\n\t\tif (window.BattleFormats && BattleFormats[formatid]) {\r\n\t\t\treturn this.escapeHTML(BattleFormats[formatid].name);\r\n\t\t}\r\n\t\tif (window.NonBattleGames && NonBattleGames[formatid]) {\r\n\t\t\treturn this.escapeHTML(NonBattleGames[formatid]);\r\n\t\t}\r\n\t\treturn this.escapeHTML(formatid);\r\n\t}\r\n\r\n\tstatic escapeHTML(str: string, jsEscapeToo?: boolean) {\r\n\t\tif (typeof str !== 'string') return '';\r\n\t\tstr = str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n\t\tif (jsEscapeToo) str = str.replace(/\\\\/g, '\\\\\\\\').replace(/'/g, '\\\\\\'');\r\n\t\treturn str;\r\n\t}\r\n\r\n\tstatic unescapeHTML(str: string) {\r\n\t\tstr = (str ? '' + str : '');\r\n\t\treturn str.replace(/&quot;/g, '\"').replace(/&gt;/g, '>').replace(/&lt;/g, '<').replace(/&amp;/g, '&');\r\n\t}\r\n\r\n\tstatic colorCache: {[userid: string]: string} = {};\r\n\r\n\t/** @deprecated */\r\n\tstatic hashColor(name: ID) {\r\n\t\treturn `color:${this.usernameColor(name)};`;\r\n\t}\r\n\r\n\tstatic usernameColor(name: ID) {\r\n\t\tif (this.colorCache[name]) return this.colorCache[name];\r\n\t\tlet hash;\r\n\t\tif (Config.customcolors[name]) {\r\n\t\t\thash = MD5(Config.customcolors[name]);\r\n\t\t} else {\r\n\t\t\thash = MD5(name);\r\n\t\t}\r\n\t\tlet H = parseInt(hash.substr(4, 4), 16) % 360; // 0 to 360\r\n\t\tlet S = parseInt(hash.substr(0, 4), 16) % 50 + 40; // 40 to 89\r\n\t\tlet L = Math.floor(parseInt(hash.substr(8, 4), 16) % 20 + 30); // 30 to 49\r\n\r\n\t\tlet {R, G, B} = this.HSLToRGB(H, S, L);\r\n\t\tlet lum = R * R * R * 0.2126 + G * G * G * 0.7152 + B * B * B * 0.0722; // 0.013 (dark blue) to 0.737 (yellow)\r\n\r\n\t\tlet HLmod = (lum - 0.2) * -150; // -80 (yellow) to 28 (dark blue)\r\n\t\tif (HLmod > 18) HLmod = (HLmod - 18) * 2.5;\r\n\t\telse if (HLmod < 0) HLmod = (HLmod - 0) / 3;\r\n\t\telse HLmod = 0;\r\n\t\t// let mod = ';border-right: ' + Math.abs(HLmod) + 'px solid ' + (HLmod > 0 ? 'red' : '#0088FF');\r\n\t\tlet Hdist = Math.min(Math.abs(180 - H), Math.abs(240 - H));\r\n\t\tif (Hdist < 15) {\r\n\t\t\tHLmod += (15 - Hdist) / 3;\r\n\t\t}\r\n\r\n\t\tL += HLmod;\r\n\r\n\t\tlet {R: r, G: g, B: b} = this.HSLToRGB(H, S, L);\r\n\t\tconst toHex = (x: number) => {\r\n\t\t\tconst hex = Math.round(x * 255).toString(16);\r\n\t\t\treturn hex.length === 1 ? '0' + hex : hex;\r\n\t\t};\r\n\t\tthis.colorCache[name] = `#${toHex(r)}${toHex(g)}${toHex(b)}`;\r\n\t\treturn this.colorCache[name];\r\n\t}\r\n\r\n\tstatic HSLToRGB(H: number, S: number, L: number) {\r\n\t\tlet C = (100 - Math.abs(2 * L - 100)) * S / 100 / 100;\r\n\t\tlet X = C * (1 - Math.abs((H / 60) % 2 - 1));\r\n\t\tlet m = L / 100 - C / 2;\r\n\r\n\t\tlet R1;\r\n\t\tlet G1;\r\n\t\tlet B1;\r\n\t\tswitch (Math.floor(H / 60)) {\r\n\t\tcase 1: R1 = X; G1 = C; B1 = 0; break;\r\n\t\tcase 2: R1 = 0; G1 = C; B1 = X; break;\r\n\t\tcase 3: R1 = 0; G1 = X; B1 = C; break;\r\n\t\tcase 4: R1 = X; G1 = 0; B1 = C; break;\r\n\t\tcase 5: R1 = C; G1 = 0; B1 = X; break;\r\n\t\tcase 0: default: R1 = C; G1 = X; B1 = 0; break;\r\n\t\t}\r\n\t\tlet R = R1 + m;\r\n\t\tlet G = G1 + m;\r\n\t\tlet B = B1 + m;\r\n\t\treturn {R, G, B};\r\n\t}\r\n\r\n\tstatic prefs(name: string) {\r\n\t\t// @ts-ignore\r\n\t\tif (window.Storage?.prefs) return Storage.prefs(name);\r\n\t\t// @ts-ignore\r\n\t\tif (window.PS) return PS.prefs[name];\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tparseChatMessage(\r\n\t\tmessage: string, name: string, timestamp: string, isHighlighted?: boolean\r\n\t): [string, string, boolean?] {\r\n\t\tlet showMe = !BattleLog.prefs('chatformatting')?.hideme;\r\n\t\tlet group = ' ';\r\n\t\tif (!/[A-Za-z0-9]/.test(name.charAt(0))) {\r\n\t\t\t// Backwards compatibility\r\n\t\t\tgroup = name.charAt(0);\r\n\t\t\tname = name.substr(1);\r\n\t\t}\r\n\t\tconst colorStyle = ` style=\"color:${BattleLog.usernameColor(toID(name))}\"`;\r\n\t\tconst clickableName = `<small>${BattleLog.escapeHTML(group)}</small><span class=\"username\" data-name=\"${BattleLog.escapeHTML(name)}\">${BattleLog.escapeHTML(name)}</span>`;\r\n\t\tlet hlClass = isHighlighted ? ' highlighted' : '';\r\n\t\tlet isMine = (window.app?.user?.get('name') === name) || (window.PS?.user.name === name);\r\n\t\tlet mineClass = isMine ? ' mine' : '';\r\n\r\n\t\tlet cmd = '';\r\n\t\tlet target = '';\r\n\t\tif (message.charAt(0) === '/') {\r\n\t\t\tif (message.charAt(1) === '/') {\r\n\t\t\t\tmessage = message.slice(1);\r\n\t\t\t} else {\r\n\t\t\t\tlet spaceIndex = message.indexOf(' ');\r\n\t\t\t\tcmd = (spaceIndex >= 0 ? message.slice(1, spaceIndex) : message.slice(1));\r\n\t\t\t\tif (spaceIndex >= 0) target = message.slice(spaceIndex + 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tswitch (cmd) {\r\n\t\tcase 'me':\r\n\t\tcase 'mee':\r\n\t\t\tlet parsedMessage = BattleLog.parseMessage(' ' + target);\r\n\t\t\tif (cmd === 'mee') parsedMessage = parsedMessage.slice(1);\r\n\t\t\tif (!showMe) {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t'chat chatmessage-' + toID(name) + hlClass + mineClass,\r\n\t\t\t\t\t`${timestamp}<strong${colorStyle}>${clickableName}:</strong> <em>/me${parsedMessage}</em>`,\r\n\t\t\t\t];\r\n\t\t\t}\r\n\t\t\treturn [\r\n\t\t\t\t'chat chatmessage-' + toID(name) + hlClass + mineClass,\r\n\t\t\t\t`${timestamp}<em><i><strong${colorStyle}>&bull; ${clickableName}</strong>${parsedMessage}</i></em>`,\r\n\t\t\t];\r\n\t\tcase 'invite':\r\n\t\t\tlet roomid = toRoomid(target);\r\n\t\t\treturn [\r\n\t\t\t\t'chat',\r\n\t\t\t\t`${timestamp}<em>${clickableName} invited you to join the room \"${roomid}\"</em>' +\r\n\t\t\t\t'<div class=\"notice\"><button name=\"joinRoom\" value=\"${roomid}\">Join ${roomid}</button></div>`,\r\n\t\t\t];\r\n\t\tcase 'announce':\r\n\t\t\treturn [\r\n\t\t\t\t'chat chatmessage-' + toID(name) + hlClass + mineClass,\r\n\t\t\t\t`${timestamp}<strong${colorStyle}>${clickableName}:</strong> <span class=\"message-announce\">${BattleLog.parseMessage(target)}</span>`,\r\n\t\t\t];\r\n\t\tcase 'log':\r\n\t\t\treturn [\r\n\t\t\t\t'chat chatmessage-' + toID(name) + hlClass + mineClass,\r\n\t\t\t\t`${timestamp}<span class=\"message-log\">${BattleLog.parseMessage(target)}</span>`,\r\n\t\t\t];\r\n\t\tcase 'data-pokemon':\r\n\t\tcase 'data-item':\r\n\t\tcase 'data-ability':\r\n\t\tcase 'data-move':\r\n\t\t\treturn ['chat message-error', '[outdated code no longer supported]'];\r\n\t\tcase 'text':\r\n\t\t\treturn ['chat', BattleLog.parseMessage(target)];\r\n\t\tcase 'error':\r\n\t\t\treturn ['chat message-error', formatText(target, true)];\r\n\t\tcase 'html':\r\n\t\t\treturn [\r\n\t\t\t\t'chat chatmessage-' + toID(name) + hlClass + mineClass,\r\n\t\t\t\t`${timestamp}<strong${colorStyle}>${clickableName}:</strong> <em>${BattleLog.sanitizeHTML(target)}</em>`,\r\n\t\t\t];\r\n\t\tcase 'uhtml':\r\n\t\tcase 'uhtmlchange':\r\n\t\t\tlet parts = target.split(',');\r\n\t\t\tlet htmlSrc = parts.slice(1).join(',').trim();\r\n\t\t\tthis.changeUhtml(parts[0], htmlSrc, cmd === 'uhtml');\r\n\t\t\treturn ['', ''];\r\n\t\tcase 'raw':\r\n\t\t\treturn ['chat', BattleLog.sanitizeHTML(target)];\r\n\t\tcase 'nonotify':\r\n\t\t\treturn ['chat', BattleLog.sanitizeHTML(target), true];\r\n\t\tdefault:\r\n\t\t\t// Not a command or unsupported. Parsed as a normal chat message.\r\n\t\t\tif (!name) {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t'chat' + hlClass,\r\n\t\t\t\t\t`${timestamp}<em>${BattleLog.parseMessage(message)}</em>`,\r\n\t\t\t\t];\r\n\t\t\t}\r\n\t\t\treturn [\r\n\t\t\t\t'chat chatmessage-' + toID(name) + hlClass + mineClass,\r\n\t\t\t\t`${timestamp}<strong${colorStyle}>${clickableName}:</strong> <em>${BattleLog.parseMessage(message)}</em>`,\r\n\t\t\t];\r\n\t\t}\r\n\t}\r\n\r\n\tstatic parseMessage(str: string, isTrusted = false) {\r\n\t\t// Don't format console commands (>>).\r\n\t\tif (str.substr(0, 3) === '>> ' || str.substr(0, 4) === '>>> ') return this.escapeHTML(str);\r\n\t\t// Don't format console results (<<).\r\n\t\tif (str.substr(0, 3) === '<< ') return this.escapeHTML(str);\r\n\t\tstr = formatText(str, isTrusted);\r\n\r\n\t\tlet options = BattleLog.prefs('chatformatting') || {};\r\n\r\n\t\tif (options.hidelinks) {\r\n\t\t\tstr = str.replace(/<a[^>]*>/g, '<u>').replace(/<\\/a>/g, '</u>');\r\n\t\t}\r\n\t\tif (options.hidespoiler) {\r\n\t\t\tstr = str.replace(/<span class=\"spoiler\">/g, '<span class=\"spoiler spoiler-shown\">');\r\n\t\t}\r\n\t\tif (options.hidegreentext) {\r\n\t\t\tstr = str.replace(/<span class=\"greentext\">/g, '<span>');\r\n\t\t}\r\n\r\n\t\treturn str;\r\n\t}\r\n\r\n\tstatic interstice = (() => {\r\n\t\tconst whitelist: string[] = Config.whitelist;\r\n\t\tconst patterns = whitelist.map(entry => new RegExp(\r\n\t\t\t`^(https?:)?//([A-Za-z0-9-]*\\\\.)?${entry.replace(/\\./g, '\\\\.')}(/.*)?`,\r\n\t\t'i'));\r\n\t\treturn {\r\n\t\t\tisWhitelisted(uri: string) {\r\n\t\t\t\tif (uri[0] === '/' && uri[1] !== '/') {\r\n\t\t\t\t\t// domain-relative URIs are safe\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tfor (const pattern of patterns) {\r\n\t\t\t\t\tif (pattern.test(uri)) return true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tgetURI(uri: string) {\r\n\t\t\t\treturn `http://${Config.routes.root}/interstice?uri=${encodeURIComponent(uri)}`;\r\n\t\t\t},\r\n\t\t};\r\n\t})();\r\n\r\n\tstatic tagPolicy: ((tagName: string, attribs: string[]) => any) | null = null;\r\n\tstatic initSanitizeHTML() {\r\n\t\tif (this.tagPolicy) return;\r\n\t\tif (!('html4' in window)) {\r\n\t\t\tthrow new Error('sanitizeHTML requires caja');\r\n\t\t}\r\n\r\n\t\t// By default, Caja will ban any HTML tags it doesn't recognize.\r\n\t\t// Additional HTML tags to allow:\r\n\t\tObject.assign(html4.ELEMENTS, {\r\n\t\t\tmarquee: 0,\r\n\t\t\tblink: 0,\r\n\t\t\tpsicon: html4.eflags['OPTIONAL_ENDTAG'] | html4.eflags['EMPTY'],\r\n\t\t\tusername: 0,\r\n\t\t\tspotify: 0,\r\n\t\t\tyoutube: 0,\r\n\t\t\ttwitch: 0,\r\n\t\t});\r\n\r\n\t\t// By default, Caja will ban any attributes it doesn't recognize.\r\n\t\t// Additional attributes to allow:\r\n\t\tObject.assign(html4.ATTRIBS, {\r\n\t\t\t// See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/marquee\r\n\t\t\t'marquee::behavior': 0,\r\n\t\t\t'marquee::bgcolor': 0,\r\n\t\t\t'marquee::direction': 0,\r\n\t\t\t'marquee::height': 0,\r\n\t\t\t'marquee::hspace': 0,\r\n\t\t\t'marquee::loop': 0,\r\n\t\t\t'marquee::scrollamount': 0,\r\n\t\t\t'marquee::scrolldelay': 0,\r\n\t\t\t'marquee::truespeed': 0,\r\n\t\t\t'marquee::vspace': 0,\r\n\t\t\t'marquee::width': 0,\r\n\t\t\t'psicon::pokemon': 0,\r\n\t\t\t'psicon::item': 0,\r\n\t\t\t'psicon::type': 0,\r\n\t\t\t'psicon::category': 0,\r\n\t\t\t'username::name': 0,\r\n\t\t\t'form::data-submitsend': 0,\r\n\t\t\t'button::data-send': 0,\r\n\t\t\t'form::data-delimiter': 0,\r\n\t\t\t'button::data-delimiter': 0,\r\n\t\t\t'*::aria-label': 0,\r\n\t\t\t'*::aria-hidden': 0,\r\n\t\t});\r\n\r\n\t\t// Caja unfortunately doesn't document how `tagPolicy` works, so\r\n\t\t// here's how it goes:\r\n\r\n\t\t// Every opening tag and attributes is filtered through\r\n\t\t// `tagPolicy`, being replaced by the {tagName, attribs} returned.\r\n\t\t// Returning `undefined` means that the tag will be removed entirely.\r\n\r\n\t\t// We run Caja's built-in tag sanitization in the first line of our\r\n\t\t// custom tagPolicy, and its attribs sanitization midway through, with\r\n\t\t// `sanitizeAttribs`.\r\n\r\n\t\t// (n.b. tag contents etc can't be modified in this step.)\r\n\r\n\t\t/**\r\n\t\t * @param tagName Lowercase tag name\r\n\t\t * @param attribs attribs in the form of [key, value, key, value]\r\n\t\t * @return undefined to remove the tag\r\n\t\t */\r\n\t\tthis.tagPolicy = (tagName: string, attribs: string[]) => {\r\n\t\t\tif (html4.ELEMENTS[tagName] & html4.eflags['UNSAFE']) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfunction getAttrib(key: string) {\r\n\t\t\t\tfor (let i = 0; i < attribs.length - 1; i += 2) {\r\n\t\t\t\t\tif (attribs[i] === key) {\r\n\t\t\t\t\t\treturn attribs[i + 1];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t\tfunction setAttrib(key: string, value: string) {\r\n\t\t\t\tfor (let i = 0; i < attribs.length - 1; i += 2) {\r\n\t\t\t\t\tif (attribs[i] === key) {\r\n\t\t\t\t\t\tattribs[i + 1] = value;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tattribs.push(key, value);\r\n\t\t\t}\r\n\t\t\tfunction deleteAttrib(key: string) {\r\n\t\t\t\tfor (let i = 0; i < attribs.length - 1; i += 2) {\r\n\t\t\t\t\tif (attribs[i] === key) {\r\n\t\t\t\t\t\tattribs.splice(i, 2);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet dataUri = '';\r\n\t\t\tlet targetReplace = false;\r\n\r\n\t\t\tif (tagName === 'a') {\r\n\t\t\t\tif (getAttrib('target') === 'replace') {\r\n\t\t\t\t\ttargetReplace = true;\r\n\t\t\t\t}\r\n\t\t\t} else if (tagName === 'img') {\r\n\t\t\t\tconst src = getAttrib('src') || '';\r\n\t\t\t\tif (src.startsWith('data:image/')) {\r\n\t\t\t\t\tdataUri = src;\r\n\t\t\t\t}\r\n\t\t\t\tif (src.startsWith('//')) {\r\n\t\t\t\t\tif (location.protocol !== 'http:' && location.protocol !== 'https:') {\r\n\t\t\t\t\t\t// in testclient with `file://`, fix src so it still works\r\n\t\t\t\t\t\tsetAttrib('src', 'https:' + src);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (tagName === 'twitch') {\r\n\t\t\t\t// <iframe src=\"https://player.twitch.tv/?channel=ninja&parent=www.example.com\" allowfullscreen=\"true\" height=\"378\" width=\"620\"></iframe>\r\n\t\t\t\tconst src = getAttrib('src') || \"\";\r\n\t\t\t\tconst channelId = /(https?:\\/\\/)?twitch.tv\\/([A-Za-z0-9]+)/i.exec(src)?.[2];\r\n\t\t\t\tconst height = parseInt(getAttrib('height') || \"\", 10) || 400;\r\n\t\t\t\tconst width = parseInt(getAttrib('width') || \"\", 10) || 340;\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttagName: 'iframe',\r\n\t\t\t\t\tattribs: [\r\n\t\t\t\t\t\t'src', `https://player.twitch.tv/?channel=${channelId}&parent=${location.hostname}&autoplay=false`,\r\n\t\t\t\t\t\t'allowfullscreen', 'true', 'height', `${height}`, 'width', `${width}`,\r\n\t\t\t\t\t],\r\n\t\t\t\t};\r\n\t\t\t} else if (tagName === 'username') {\r\n\t\t\t\t// <username> is a custom element that handles namecolors\r\n\t\t\t\ttagName = 'strong';\r\n\t\t\t\tconst color = this.usernameColor(toID(getAttrib('name')));\r\n\t\t\t\tconst style = getAttrib('style');\r\n\t\t\t\tsetAttrib('style', `${style};color:${color}`);\r\n\t\t\t} else if (tagName === 'spotify') {\r\n\t\t\t\t// <iframe src=\"https://open.spotify.com/embed/track/6aSYnCIwcLpnDXngGKAEzZ\" width=\"300\" height=\"380\" frameborder=\"0\" allowtransparency=\"true\" allow=\"encrypted-media\"></iframe>\r\n\t\t\t\tconst src = getAttrib('src') || '';\r\n\t\t\t\tconst songId = /(?:\\?v=|\\/track\\/)([A-Za-z0-9]+)/.exec(src)?.[1];\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttagName: 'iframe',\r\n\t\t\t\t\tattribs: ['src', `https://open.spotify.com/embed/track/${songId}`, 'width', '300', 'height', '380', 'frameborder', '0', 'allowtransparency', 'true', 'allow', 'encrypted-media'],\r\n\t\t\t\t};\r\n\t\t\t} else if (tagName === 'youtube') {\r\n\t\t\t\t// <iframe width=\"320\" height=\"180\" src=\"https://www.youtube.com/embed/dQw4w9WgXcQ\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\r\n\r\n\t\t\t\tconst src = getAttrib('src') || '';\r\n\t\t\t\t// Google's ToS requires a minimum of 200x200\r\n\t\t\t\tlet width = '320';\r\n\t\t\t\tlet height = '200';\r\n\t\t\t\tif (window.innerWidth >= 400) {\r\n\t\t\t\t\twidth = '400';\r\n\t\t\t\t\theight = '225';\r\n\t\t\t\t}\r\n\t\t\t\tconst videoId = /(?:\\?v=|\\/embed\\/)([A-Za-z0-9_\\-]+)/.exec(src)?.[1];\r\n\t\t\t\tif (!videoId) return {tagName: 'img', attribs: ['alt', `invalid src for <youtube>`]};\r\n\r\n\t\t\t\tconst time = /(?:\\?|&)(?:t|start)=([0-9]+)/.exec(src)?.[1];\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttagName: 'iframe',\r\n\t\t\t\t\tattribs: [\r\n\t\t\t\t\t\t'width', width, 'height', height,\r\n\t\t\t\t\t\t'src', `https://www.youtube.com/embed/${videoId}${time ? `?start=${time}` : ''}`,\r\n\t\t\t\t\t\t'frameborder', '0', 'allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture', 'allowfullscreen', 'allowfullscreen',\r\n\t\t\t\t\t],\r\n\t\t\t\t};\r\n\t\t\t} else if (tagName === 'psicon') {\r\n\t\t\t\t// <psicon> is a custom element which supports a set of mutually incompatible attributes:\r\n\t\t\t\t// <psicon pokemon> and <psicon item>\r\n\t\t\t\tlet iconType = null;\r\n\t\t\t\tlet iconValue = null;\r\n\t\t\t\tfor (let i = 0; i < attribs.length - 1; i += 2) {\r\n\t\t\t\t\tif (attribs[i] === 'pokemon' || attribs[i] === 'item' || attribs[i] === 'type' || attribs[i] === 'category') {\r\n\t\t\t\t\t\t[iconType, iconValue] = attribs.slice(i, i + 2);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttagName = 'span';\r\n\r\n\t\t\t\tif (iconType) {\r\n\t\t\t\t\tconst className = getAttrib('class');\r\n\t\t\t\t\tconst style = getAttrib('style');\r\n\r\n\t\t\t\t\tif (iconType === 'pokemon') {\r\n\t\t\t\t\t\tsetAttrib('class', 'picon' + (className ? ' ' + className : ''));\r\n\t\t\t\t\t\tsetAttrib('style', Dex.getPokemonIcon(iconValue) + (style ? '; ' + style : ''));\r\n\t\t\t\t\t} else if (iconType === 'item') {\r\n\t\t\t\t\t\tsetAttrib('class', 'itemicon' + (className ? ' ' + className : ''));\r\n\t\t\t\t\t\tsetAttrib('style', Dex.getItemIcon(iconValue) + (style ? '; ' + style : ''));\r\n\t\t\t\t\t} else if (iconType === 'type') {\r\n\t\t\t\t\t\ttagName = Dex.getTypeIcon(iconValue).slice(1, -3);\r\n\t\t\t\t\t} else if (iconType === 'category') {\r\n\t\t\t\t\t\ttagName = Dex.getCategoryIcon(iconValue).slice(1, -3);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tattribs = html.sanitizeAttribs(tagName, attribs, (urlData: any) => {\r\n\t\t\t\tif (urlData.scheme_ === 'geo' || urlData.scheme_ === 'sms' || urlData.scheme_ === 'tel') return null;\r\n\t\t\t\treturn urlData;\r\n\t\t\t});\r\n\r\n\t\t\tif (dataUri && tagName === 'img') {\r\n\t\t\t\tsetAttrib('src', dataUri);\r\n\t\t\t}\r\n\t\t\tif (tagName === 'a' || (tagName === 'form' && !getAttrib('data-submitsend'))) {\r\n\t\t\t\tif (targetReplace) {\r\n\t\t\t\t\tsetAttrib('data-target', 'replace');\r\n\t\t\t\t\tdeleteAttrib('target');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetAttrib('target', '_blank');\r\n\t\t\t\t}\r\n\t\t\t\tif (tagName === 'a') {\r\n\t\t\t\t\tsetAttrib('rel', 'noopener');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {tagName, attribs};\r\n\t\t};\r\n\t}\r\n\tstatic localizeTime(full: string, date: string, time: string, timezone?: string) {\r\n\t\tlet parsedTime = new Date(date + 'T' + time + (timezone || 'Z').toUpperCase());\r\n\t\t// Very old (pre-ES5) web browsers may be incapable of parsing ISO 8601\r\n\t\t// dates. In such a case, gracefully continue without replacing the date\r\n\t\t// format.\r\n\t\tif (!parsedTime.getTime()) return full;\r\n\r\n\t\tlet formattedTime;\r\n\t\t// Try using Intl API if it exists\r\n\t\tif ((window as any).Intl?.DateTimeFormat) {\r\n\t\t\tformattedTime = new Intl.DateTimeFormat(undefined, {\r\n\t\t\t\tmonth: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric',\r\n\t\t\t}).format(parsedTime);\r\n\t\t} else {\r\n\t\t\t// toLocaleString even exists in ECMAScript 1, so no need to check\r\n\t\t\t// if it exists.\r\n\t\t\tformattedTime = parsedTime.toLocaleString();\r\n\t\t}\r\n\t\treturn '<time>' + BattleLog.escapeHTML(formattedTime) + '</time>';\r\n\t}\r\n\tstatic sanitizeHTML(input: string) {\r\n\t\tif (typeof input !== 'string') return '';\r\n\r\n\t\tthis.initSanitizeHTML();\r\n\r\n\t\tinput = input.replace(/<username([^>]*)>([^<]*)<\\/username>/gi, (match, attrs, username) => {\r\n\t\t\tif (/\\bname\\s*=\\s*\"/.test(attrs)) return match;\r\n\t\t\tconst escapedUsername = username.replace(/\"/g, '&quot;').replace(/>/g, '&gt;');\r\n\t\t\treturn `<username${attrs} name=\"${escapedUsername}\">${username}</username>`;\r\n\t\t});\r\n\r\n\t\t// Our custom element support happens in `tagPolicy`, which is set\r\n\t\t// up in `initSanitizeHTML` above.\r\n\t\tconst sanitized = html.sanitizeWithPolicy(input, this.tagPolicy) as string;\r\n\r\n\t\t// <time> parsing requires ISO 8601 time. While more time formats are\r\n\t\t// supported by most JavaScript implementations, it isn't required, and\r\n\t\t// how to exactly enforce ignoring user agent timezone setting is not obvious.\r\n\t\t// As dates come from the server which isn't aware of client timezone, a\r\n\t\t// particular timezone is required.\r\n\t\t//\r\n\t\t// This regular expression is split into three groups.\r\n\t\t//\r\n\t\t// Group 1 - date\r\n\t\t// Group 2 - time (seconds and milliseconds are optional)\r\n\t\t// Group 3 - optional timezone\r\n\t\t//\r\n\t\t// Group 1 and group 2 are split to allow using space as a separator\r\n\t\t// instead of T. Stricly speaking ECMAScript 5 specification only\r\n\t\t// allows T, however it's more practical to also allow spaces.\r\n\t\treturn sanitized.replace(\r\n\t\t\t/<time>\\s*([+-]?\\d{4,}-\\d{2}-\\d{2})[T ](\\d{2}:\\d{2}(?::\\d{2}(?:\\.\\d{3})?)?)(Z|[+-]\\d{2}:\\d{2})?\\s*<\\/time>/ig,\r\n\t\tthis.localizeTime);\r\n\t}\r\n\r\n\t/*********************************************************\r\n\t * Replay files\r\n\t *********************************************************/\r\n\r\n\t// Replay files are .html files that display a replay for a battle.\r\n\r\n\t// The .html files mainly contain replay log data; the actual replay\r\n\t// player is downloaded online. Also included is a textual log and\r\n\t// some minimal CSS to make it look pretty, for offline viewing.\r\n\r\n\t// This strategy helps keep the replay file reasonably small; of\r\n\t// the 30 KB or so for a 50-turn battle, around 10 KB is the log\r\n\t// data, and around 20 KB is the textual log.\r\n\r\n\t// The actual replay player is downloaded from replay-embed.js,\r\n\t// which handles loading all the necessary resources for turning the log\r\n\t// data into a playable replay.\r\n\r\n\t// Battle log data is stored in and loaded from a\r\n\t// <script type=\"text/plain\" class=\"battle-log-data\"> tag.\r\n\r\n\t// replay-embed.js is loaded through a cache-buster that rotates daily.\r\n\t// This allows pretty much anything about the replay viewer to be\r\n\t// updated as desired.\r\n\r\n\tstatic createReplayFile(room: any) {\r\n\t\tlet battle = room.battle;\r\n\t\tlet replayid = room.id;\r\n\t\tif (replayid) {\r\n\t\t\t// battle room\r\n\t\t\treplayid = replayid.slice(7);\r\n\t\t\tif (Config.server.id !== 'showdown') {\r\n\t\t\t\tif (!Config.server.registered) {\r\n\t\t\t\t\treplayid = 'unregisteredserver-' + replayid;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treplayid = Config.server.id + '-' + replayid;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// replay panel\r\n\t\t\treplayid = room.fragment;\r\n\t\t}\r\n\t\tbattle.seekTurn(Infinity);\r\n\t\tlet buf = '<!DOCTYPE html>\\n';\r\n\t\tbuf += '<meta charset=\"utf-8\" />\\n';\r\n\t\tbuf += '<!-- version 1 -->\\n';\r\n\t\tbuf += `<title>${BattleLog.escapeHTML(battle.tier)} replay: ${BattleLog.escapeHTML(battle.p1.name)} vs. ${BattleLog.escapeHTML(battle.p2.name)}</title>\\n`;\r\n\t\tbuf += '<style>\\n';\r\n\t\tbuf += 'html,body {font-family:Verdana, sans-serif;font-size:10pt;margin:0;padding:0;}body{padding:12px 0;} .battle-log {font-family:Verdana, sans-serif;font-size:10pt;} .battle-log-inline {border:1px solid #AAAAAA;background:#EEF2F5;color:black;max-width:640px;margin:0 auto 80px;padding-bottom:5px;} .battle-log .inner {padding:4px 8px 0px 8px;} .battle-log .inner-preempt {padding:0 8px 4px 8px;} .battle-log .inner-after {margin-top:0.5em;} .battle-log h2 {margin:0.5em -8px;padding:4px 8px;border:1px solid #AAAAAA;background:#E0E7EA;border-left:0;border-right:0;font-family:Verdana, sans-serif;font-size:13pt;} .battle-log .chat {vertical-align:middle;padding:3px 0 3px 0;font-size:8pt;} .battle-log .chat strong {color:#40576A;} .battle-log .chat em {padding:1px 4px 1px 3px;color:#000000;font-style:normal;} .chat.mine {background:rgba(0,0,0,0.05);margin-left:-8px;margin-right:-8px;padding-left:8px;padding-right:8px;} .spoiler {color:#BBBBBB;background:#BBBBBB;padding:0px 3px;} .spoiler:hover, .spoiler:active, .spoiler-shown {color:#000000;background:#E2E2E2;padding:0px 3px;} .spoiler a {color:#BBBBBB;} .spoiler:hover a, .spoiler:active a, .spoiler-shown a {color:#2288CC;} .chat code, .chat .spoiler:hover code, .chat .spoiler:active code, .chat .spoiler-shown code {border:1px solid #C0C0C0;background:#EEEEEE;color:black;padding:0 2px;} .chat .spoiler code {border:1px solid #CCCCCC;background:#CCCCCC;color:#CCCCCC;} .battle-log .rated {padding:3px 4px;} .battle-log .rated strong {color:white;background:#89A;padding:1px 4px;border-radius:4px;} .spacer {margin-top:0.5em;} .message-announce {background:#6688AA;color:white;padding:1px 4px 2px;} .message-announce a, .broadcast-green a, .broadcast-blue a, .broadcast-red a {color:#DDEEFF;} .broadcast-green {background-color:#559955;color:white;padding:2px 4px;} .broadcast-blue {background-color:#6688AA;color:white;padding:2px 4px;} .infobox {border:1px solid #6688AA;padding:2px 4px;} .infobox-limited {max-height:200px;overflow:auto;overflow-x:hidden;} .broadcast-red {background-color:#AA5544;color:white;padding:2px 4px;} .message-learn-canlearn {font-weight:bold;color:#228822;text-decoration:underline;} .message-learn-cannotlearn {font-weight:bold;color:#CC2222;text-decoration:underline;} .message-effect-weak {font-weight:bold;color:#CC2222;} .message-effect-resist {font-weight:bold;color:#6688AA;} .message-effect-immune {font-weight:bold;color:#666666;} .message-learn-list {margin-top:0;margin-bottom:0;} .message-throttle-notice, .message-error {color:#992222;} .message-overflow, .chat small.message-overflow {font-size:0pt;} .message-overflow::before {font-size:9pt;content:\\'...\\';} .subtle {color:#3A4A66;}\\n';\r\n\t\tbuf += '</style>\\n';\r\n\t\tbuf += '<div class=\"wrapper replay-wrapper\" style=\"max-width:1180px;margin:0 auto\">\\n';\r\n\t\tbuf += '<input type=\"hidden\" name=\"replayid\" value=\"' + replayid + '\" />\\n';\r\n\t\tbuf += '<div class=\"battle\"></div><div class=\"battle-log\"></div><div class=\"replay-controls\"></div><div class=\"replay-controls-2\"></div>\\n';\r\n\t\tbuf += `<h1 style=\"font-weight:normal;text-align:center\"><strong>${BattleLog.escapeHTML(battle.tier)}</strong><br /><a href=\"http://${Config.routes.users}/${toID(battle.p1.name)}\" class=\"subtle\" target=\"_blank\">${BattleLog.escapeHTML(battle.p1.name)}</a> vs. <a href=\"http://${Config.routes.users}/${toID(battle.p2.name)}\" class=\"subtle\" target=\"_blank\">${BattleLog.escapeHTML(battle.p2.name)}</a></h1>\\n`;\r\n\t\tbuf += '<script type=\"text/plain\" class=\"battle-log-data\">' + battle.stepQueue.join('\\n').replace(/\\//g, '\\\\/') + '</script>\\n'; // lgtm [js/incomplete-sanitization]\r\n\t\tbuf += '</div>\\n';\r\n\t\tbuf += '<div class=\"battle-log battle-log-inline\"><div class=\"inner\">' + battle.scene.log.elem.innerHTML + '</div></div>\\n';\r\n\t\tbuf += '</div>\\n';\r\n\t\tbuf += '<script>\\n';\r\n\t\tbuf += `let daily = Math.floor(Date.now()/1000/60/60/24);document.write('<script src=\"https://${Config.routes.client}/js/replay-embed.js?version'+daily+'\"></'+'script>');\\n`;\r\n\t\tbuf += '</script>\\n';\r\n\t\treturn buf;\r\n\t}\r\n\r\n\tstatic createReplayFileHref(room: any) {\r\n\t\t// unescape(encodeURIComponent()) is necessary because btoa doesn't support Unicode\r\n\t\t// @ts-ignore\r\n\t\treturn 'data:text/plain;base64,' + encodeURIComponent(btoa(unescape(encodeURIComponent(BattleLog.createReplayFile(room)))));\r\n\t}\r\n}\r\n","/**\r\n * Pokemon Showdown Log Misc\r\n *\r\n * Some miscellaneous helper functions for battle-log.ts, namely:\r\n *\r\n * - an MD5 hasher\r\n *\r\n * - a parseText function (for converting chat text to HTML),\r\n *   cross-compiled from the server\r\n *\r\n * Licensing note: PS's client has complicated licensing:\r\n * - The client as a whole is AGPLv3\r\n * - The battle replay/animation engine (battle-*.ts) by itself is MIT\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license MIT\r\n */\r\n\r\n/* eslint-disable */\r\n\r\n// MD5 minified\r\nfunction MD5(f){function i(b,c){var d,e,f,g,h;f=b&2147483648;g=c&2147483648;d=b&1073741824;e=c&1073741824;h=(b&1073741823)+(c&1073741823);return d&e?h^2147483648^f^g:d|e?h&1073741824?h^3221225472^f^g:h^1073741824^f^g:h^f^g}function j(b,c,d,e,f,g,h){b=i(b,i(i(c&d|~c&e,f),h));return i(b<<g|b>>>32-g,c)}function k(b,c,d,e,f,g,h){b=i(b,i(i(c&e|d&~e,f),h));return i(b<<g|b>>>32-g,c)}function l(b,c,e,d,f,g,h){b=i(b,i(i(c^e^d,f),h));return i(b<<g|b>>>32-g,c)}function m(b,c,e,d,f,g,h){b=i(b,i(i(e^(c|~d),\r\nf),h));return i(b<<g|b>>>32-g,c)}function n(b){var c=\"\",e=\"\",d;for(d=0;d<=3;d++)e=b>>>d*8&255,e=\"0\"+e.toString(16),c+=e.substr(e.length-2,2);return c}var g=[],o,p,q,r,b,c,d,e,f=function(b){for(var b=b.replace(/\\r\\n/g,\"\\n\"),c=\"\",e=0;e<b.length;e++){var d=b.charCodeAt(e);d<128?c+=String.fromCharCode(d):(d>127&&d<2048?c+=String.fromCharCode(d>>6|192):(c+=String.fromCharCode(d>>12|224),c+=String.fromCharCode(d>>6&63|128)),c+=String.fromCharCode(d&63|128))}return c}(f),g=function(b){var c,d=b.length;c=\r\nd+8;for(var e=((c-c%64)/64+1)*16,f=Array(e-1),g=0,h=0;h<d;)c=(h-h%4)/4,g=h%4*8,f[c]|=b.charCodeAt(h)<<g,h++;f[(h-h%4)/4]|=128<<h%4*8;f[e-2]=d<<3;f[e-1]=d>>>29;return f}(f);b=1732584193;c=4023233417;d=2562383102;e=271733878;for(f=0;f<g.length;f+=16)o=b,p=c,q=d,r=e,b=j(b,c,d,e,g[f+0],7,3614090360),e=j(e,b,c,d,g[f+1],12,3905402710),d=j(d,e,b,c,g[f+2],17,606105819),c=j(c,d,e,b,g[f+3],22,3250441966),b=j(b,c,d,e,g[f+4],7,4118548399),e=j(e,b,c,d,g[f+5],12,1200080426),d=j(d,e,b,c,g[f+6],17,2821735955),c=\r\nj(c,d,e,b,g[f+7],22,4249261313),b=j(b,c,d,e,g[f+8],7,1770035416),e=j(e,b,c,d,g[f+9],12,2336552879),d=j(d,e,b,c,g[f+10],17,4294925233),c=j(c,d,e,b,g[f+11],22,2304563134),b=j(b,c,d,e,g[f+12],7,1804603682),e=j(e,b,c,d,g[f+13],12,4254626195),d=j(d,e,b,c,g[f+14],17,2792965006),c=j(c,d,e,b,g[f+15],22,1236535329),b=k(b,c,d,e,g[f+1],5,4129170786),e=k(e,b,c,d,g[f+6],9,3225465664),d=k(d,e,b,c,g[f+11],14,643717713),c=k(c,d,e,b,g[f+0],20,3921069994),b=k(b,c,d,e,g[f+5],5,3593408605),e=k(e,b,c,d,g[f+10],9,38016083),\r\nd=k(d,e,b,c,g[f+15],14,3634488961),c=k(c,d,e,b,g[f+4],20,3889429448),b=k(b,c,d,e,g[f+9],5,568446438),e=k(e,b,c,d,g[f+14],9,3275163606),d=k(d,e,b,c,g[f+3],14,4107603335),c=k(c,d,e,b,g[f+8],20,1163531501),b=k(b,c,d,e,g[f+13],5,2850285829),e=k(e,b,c,d,g[f+2],9,4243563512),d=k(d,e,b,c,g[f+7],14,1735328473),c=k(c,d,e,b,g[f+12],20,2368359562),b=l(b,c,d,e,g[f+5],4,4294588738),e=l(e,b,c,d,g[f+8],11,2272392833),d=l(d,e,b,c,g[f+11],16,1839030562),c=l(c,d,e,b,g[f+14],23,4259657740),b=l(b,c,d,e,g[f+1],4,2763975236),\r\ne=l(e,b,c,d,g[f+4],11,1272893353),d=l(d,e,b,c,g[f+7],16,4139469664),c=l(c,d,e,b,g[f+10],23,3200236656),b=l(b,c,d,e,g[f+13],4,681279174),e=l(e,b,c,d,g[f+0],11,3936430074),d=l(d,e,b,c,g[f+3],16,3572445317),c=l(c,d,e,b,g[f+6],23,76029189),b=l(b,c,d,e,g[f+9],4,3654602809),e=l(e,b,c,d,g[f+12],11,3873151461),d=l(d,e,b,c,g[f+15],16,530742520),c=l(c,d,e,b,g[f+2],23,3299628645),b=m(b,c,d,e,g[f+0],6,4096336452),e=m(e,b,c,d,g[f+7],10,1126891415),d=m(d,e,b,c,g[f+14],15,2878612391),c=m(c,d,e,b,g[f+5],21,4237533241),\r\nb=m(b,c,d,e,g[f+12],6,1700485571),e=m(e,b,c,d,g[f+3],10,2399980690),d=m(d,e,b,c,g[f+10],15,4293915773),c=m(c,d,e,b,g[f+1],21,2240044497),b=m(b,c,d,e,g[f+8],6,1873313359),e=m(e,b,c,d,g[f+15],10,4264355552),d=m(d,e,b,c,g[f+6],15,2734768916),c=m(c,d,e,b,g[f+13],21,1309151649),b=m(b,c,d,e,g[f+4],6,4149444226),e=m(e,b,c,d,g[f+11],10,3174756917),d=m(d,e,b,c,g[f+2],15,718787259),c=m(c,d,e,b,g[f+9],21,3951481745),b=i(b,o),c=i(c,p),d=i(d,q),e=i(e,r);return(n(b)+n(c)+n(d)+n(e)).toLowerCase()};\r\n/* eslint-enable */\r\n","/**\r\n * Text parser\r\n *\r\n * No dependencies\r\n * Optional dependency: BattleText\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license MIT\r\n */\r\n\r\ndeclare const BattleText: {[id: string]: {[templateName: string]: string}};\r\n\r\ntype Args = [string, ...string[]];\r\ntype KWArgs = {[kw: string]: string};\r\ntype SideID = 'p1' | 'p2' | 'p3' | 'p4';\r\n\r\nclass BattleTextParser {\r\n\tp1 = \"Player 1\";\r\n\tp2 = \"Player 2\";\r\n\tp3 = \"Player 3\";\r\n\tp4 = \"Player 4\";\r\n\tperspective: SideID;\r\n\tgen = 7;\r\n\tturn = 0;\r\n\tcurLineSection: 'break' | 'preMajor' | 'major' | 'postMajor' = 'break';\r\n\tlowercaseRegExp: RegExp | null | undefined = undefined;\r\n\r\n\tconstructor(perspective: SideID = 'p1') {\r\n\t\tthis.perspective = perspective;\r\n\t}\r\n\r\n\tstatic parseLine(line: string, noDefault: true): Args | null;\r\n\tstatic parseLine(line: string): Args;\r\n\tstatic parseLine(line: string, noDefault?: boolean): Args | null {\r\n\t\tif (!line.startsWith('|')) {\r\n\t\t\treturn ['', line];\r\n\t\t}\r\n\t\tif (line === '|') {\r\n\t\t\treturn ['done'];\r\n\t\t}\r\n\t\tconst index = line.indexOf('|', 1);\r\n\t\tconst cmd = line.slice(1, index);\r\n\t\tswitch (cmd) {\r\n\t\tcase 'chatmsg': case 'chatmsg-raw': case 'raw': case 'error': case 'html':\r\n\t\tcase 'inactive': case 'inactiveoff': case 'warning':\r\n\t\tcase 'fieldhtml': case 'controlshtml': case 'bigerror':\r\n\t\tcase 'debug': case 'tier': case 'challstr': case 'popup': case '':\r\n\t\t\treturn [cmd, line.slice(index + 1)];\r\n\t\tcase 'c': case 'chat': case 'uhtml': case 'uhtmlchange': case 'queryresponse':\r\n\t\t\t// three parts\r\n\t\t\tconst index2a = line.indexOf('|', index + 1);\r\n\t\t\treturn [cmd, line.slice(index + 1, index2a), line.slice(index2a + 1)];\r\n\t\tcase 'c:': case 'pm':\r\n\t\t\t// four parts\r\n\t\t\tconst index2b = line.indexOf('|', index + 1);\r\n\t\t\tconst index3b = line.indexOf('|', index2b + 1);\r\n\t\t\treturn [cmd, line.slice(index + 1, index2b), line.slice(index2b + 1, index3b), line.slice(index3b + 1)];\r\n\t\t}\r\n\t\tif (noDefault) return null;\r\n\t\treturn line.slice(1).split('|') as [string, ...string[]];\r\n\t}\r\n\r\n\tstatic parseBattleLine(line: string): {args: Args, kwArgs: KWArgs} {\r\n\t\tlet args = this.parseLine(line, true);\r\n\t\tif (args) return {args, kwArgs: {}};\r\n\r\n\t\targs = line.slice(1).split('|') as [string, ...string[]];\r\n\t\tconst kwArgs: KWArgs = {};\r\n\t\twhile (args.length > 1) {\r\n\t\t\tconst lastArg = args[args.length - 1];\r\n\t\t\tif (lastArg.charAt(0) !== '[') break;\r\n\t\t\tconst bracketPos = lastArg.indexOf(']');\r\n\t\t\tif (bracketPos <= 0) break;\r\n\t\t\t// default to '.' so it evaluates to boolean true\r\n\t\t\tkwArgs[lastArg.slice(1, bracketPos)] = lastArg.slice(bracketPos + 1).trim() || '.';\r\n\t\t\targs.pop();\r\n\t\t}\r\n\t\treturn BattleTextParser.upgradeArgs({args, kwArgs});\r\n\t}\r\n\r\n\tstatic parseNameParts(text: string) {\r\n\t\tlet group = '';\r\n\t\t// names can't start with a symbol\r\n\t\tif (!/[A-Za-z0-9]/.test(text.charAt(0))) {\r\n\t\t\tgroup = text.charAt(0);\r\n\t\t\ttext = text.slice(1);\r\n\t\t}\r\n\r\n\t\tlet name = text;\r\n\t\tconst atIndex = text.indexOf('@');\r\n\t\tlet status = '';\r\n\t\tlet away = false;\r\n\t\tif (atIndex > 0) {\r\n\t\t\tname = text.slice(0, atIndex);\r\n\t\t\tstatus = text.slice(atIndex + 1);\r\n\t\t\tif (status.startsWith('!')) {\r\n\t\t\t\taway = true;\r\n\t\t\t\tstatus = status.slice(1);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {group, name, away, status};\r\n\t}\r\n\r\n\tstatic upgradeArgs({args, kwArgs}: {args: Args, kwArgs: KWArgs}): {args: Args, kwArgs: KWArgs} {\r\n\t\tswitch (args[0]) {\r\n\t\tcase '-activate': {\r\n\t\t\tif (kwArgs.item || kwArgs.move || kwArgs.number || kwArgs.ability) return {args, kwArgs};\r\n\t\t\tlet [, pokemon, effect, arg3, arg4] = args;\r\n\t\t\tlet target = kwArgs.of;\r\n\t\t\tconst id = BattleTextParser.effectId(effect);\r\n\r\n\t\t\tif (kwArgs.block) return {args: ['-fail', pokemon], kwArgs};\r\n\r\n\t\t\tif (id === 'wonderguard') return {args: ['-immune', pokemon], kwArgs: {from: 'ability:Wonder Guard'}};\r\n\r\n\t\t\tif (id === 'beatup' && kwArgs.of) return {args, kwArgs: {name: kwArgs.of}};\r\n\r\n\t\t\tif ([\r\n\t\t\t\t'ingrain', 'quickguard', 'wideguard', 'craftyshield', 'matblock', 'protect', 'mist', 'safeguard',\r\n\t\t\t\t'electricterrain', 'mistyterrain', 'psychicterrain', 'telepathy', 'stickyhold', 'suctioncups', 'aromaveil',\r\n\t\t\t\t'flowerveil', 'sweetveil', 'disguise', 'safetygoggles', 'protectivepads',\r\n\t\t\t].includes(id)) {\r\n\t\t\t\tif (target) {\r\n\t\t\t\t\tkwArgs.of = pokemon;\r\n\t\t\t\t\treturn {args: ['-block', target, effect, arg3], kwArgs};\r\n\t\t\t\t}\r\n\t\t\t\treturn {args: ['-block', pokemon, effect, arg3], kwArgs};\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'charge') {\r\n\t\t\t\treturn {args: ['-singlemove', pokemon, effect], kwArgs: {of: target}};\r\n\t\t\t}\r\n\t\t\tif ([\r\n\t\t\t\t'bind', 'wrap', 'clamp', 'whirlpool', 'firespin', 'magmastorm', 'sandtomb', 'infestation', 'snaptrap', 'thundercage', 'trapped',\r\n\t\t\t].includes(id)) {\r\n\t\t\t\treturn {args: ['-start', pokemon, effect], kwArgs: {of: target}};\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'fairylock') {\r\n\t\t\t\treturn {args: ['-fieldactivate', effect], kwArgs: {}};\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'symbiosis' || id === 'poltergeist') {\r\n\t\t\t\tkwArgs.item = arg3;\r\n\t\t\t} else if (id === 'magnitude') {\r\n\t\t\t\tkwArgs.number = arg3;\r\n\t\t\t} else if (id === 'skillswap' || id === 'mummy' || id === 'wanderingspirit') {\r\n\t\t\t\tkwArgs.ability = arg3;\r\n\t\t\t\tkwArgs.ability2 = arg4;\r\n\t\t\t} else if ([\r\n\t\t\t\t'eeriespell', 'gmaxdepletion', 'spite', 'grudge', 'forewarn', 'sketch', 'leppaberry', 'mysteryberry',\r\n\t\t\t].includes(id)) {\r\n\t\t\t\tkwArgs.move = arg3;\r\n\t\t\t\tkwArgs.number = arg4;\r\n\t\t\t}\r\n\t\t\targs = ['-activate', pokemon, effect, target || ''];\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-fail': {\r\n\t\t\tif (kwArgs.from === 'ability: Flower Veil') {\r\n\t\t\t\treturn {args: ['-block', kwArgs.of, 'ability: Flower Veil'], kwArgs: {of: args[1]}};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-start': {\r\n\t\t\tif (kwArgs.from === 'Protean' || kwArgs.from === 'Color Change') kwArgs.from = 'ability:' + kwArgs.from;\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase 'move': {\r\n\t\t\tif (kwArgs.from === 'Magic Bounce') kwArgs.from = 'ability:Magic Bounce';\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase 'cant': {\r\n\t\t\tlet [, pokemon, effect, move] = args;\r\n\t\t\tif (['ability: Queenly Majesty', 'ability: Damp', 'ability: Dazzling'].includes(effect)) {\r\n\t\t\t\targs[0] = '-block';\r\n\t\t\t\treturn {args: ['-block', pokemon, effect, move, kwArgs.of], kwArgs: {}};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcase '-nothing':\r\n\t\t\t// OLD: |-nothing\r\n\t\t\t// NEW: |-activate||move:Splash\r\n\t\t\treturn {args: ['-activate', '', 'move:Splash'], kwArgs};\r\n\t\t}\r\n\t\treturn {args, kwArgs};\r\n\t}\r\n\r\n\textractMessage(buf: string) {\r\n\t\tlet out = '';\r\n\t\tfor (const line of buf.split('\\n')) {\r\n\t\t\tconst {args, kwArgs} = BattleTextParser.parseBattleLine(line);\r\n\t\t\tout += this.parseArgs(args, kwArgs) || '';\r\n\t\t}\r\n\t\treturn out;\r\n\t}\r\n\r\n\tfixLowercase(input: string) {\r\n\t\tif (this.lowercaseRegExp === undefined) {\r\n\t\t\tconst prefixes = ['pokemon', 'opposingPokemon', 'team', 'opposingTeam', 'party', 'opposingParty'].map(templateId => {\r\n\t\t\t\tconst template = BattleText.default[templateId];\r\n\t\t\t\tif (template.charAt(0) === template.charAt(0).toUpperCase()) return '';\r\n\t\t\t\tconst bracketIndex = template.indexOf('[');\r\n\t\t\t\tif (bracketIndex >= 0) return template.slice(0, bracketIndex);\r\n\t\t\t\treturn template;\r\n\t\t\t}).filter(prefix => prefix);\r\n\t\t\tif (prefixes.length) {\r\n\t\t\t\tlet buf = `((?:^|\\n)(?:  |  \\\\\\(|\\\\\\[)?)(` +\r\n\t\t\t\t\tprefixes.map(BattleTextParser.escapeRegExp).join('|') +\r\n\t\t\t\t\t`)`;\r\n\t\t\t\tthis.lowercaseRegExp = new RegExp(buf, 'g');\r\n\t\t\t} else {\r\n\t\t\t\tthis.lowercaseRegExp = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!this.lowercaseRegExp) return input;\r\n\t\treturn input.replace(this.lowercaseRegExp, (match, p1, p2) => (\r\n\t\t\tp1 + p2.charAt(0).toUpperCase() + p2.slice(1)\r\n\t\t));\r\n\t}\r\n\r\n\tstatic escapeRegExp(input: string) {\r\n\t\treturn input.replace(/[\\\\^$.*+?()[\\]{}|]/g, '\\\\$&');\r\n\t}\r\n\r\n\tpokemonName = (pokemon: string) => {\r\n\t\tif (!pokemon) return '';\r\n\t\tif (!pokemon.startsWith('p')) return `???pokemon:${pokemon}???`;\r\n\t\tif (pokemon.charAt(3) === ':') return pokemon.slice(4).trim();\r\n\t\telse if (pokemon.charAt(2) === ':') return pokemon.slice(3).trim();\r\n\t\treturn `???pokemon:${pokemon}???`;\r\n\t};\r\n\r\n\tpokemon(pokemon: string) {\r\n\t\tif (!pokemon) return '';\r\n\t\tlet side = pokemon.slice(0, 2);\r\n\t\tif (!['p1', 'p2', 'p3', 'p4'].includes(side)) return `???pokemon:${pokemon}???`;\r\n\t\tconst name = this.pokemonName(pokemon);\r\n\t\tconst isNear = side === this.perspective || side === BattleTextParser.allyID(side as SideID);\r\n\t\tconst template = BattleText.default[isNear ? 'pokemon' : 'opposingPokemon'];\r\n\t\treturn template.replace('[NICKNAME]', name);\r\n\t}\r\n\r\n\tpokemonFull(pokemon: string, details: string): [string, string] {\r\n\t\tconst nickname = this.pokemonName(pokemon);\r\n\r\n\t\tconst species = details.split(',')[0];\r\n\t\tif (nickname === species) return [pokemon.slice(0, 2), `**${species}**`];\r\n\t\treturn [pokemon.slice(0, 2), `${nickname} (**${species}**)`];\r\n\t}\r\n\r\n\ttrainer(side: string) {\r\n\t\tside = side.slice(0, 2);\r\n\t\tif (side === 'p1') return this.p1;\r\n\t\tif (side === 'p2') return this.p2;\r\n\t\tif (side === 'p3') return this.p3;\r\n\t\tif (side === 'p4') return this.p4;\r\n\t\treturn `???side:${side}???`;\r\n\t}\r\n\r\n\tstatic allyID(sideid: SideID): SideID | '' {\r\n\t\tif (sideid === 'p1') return 'p3';\r\n\t\tif (sideid === 'p2') return 'p4';\r\n\t\tif (sideid === 'p3') return 'p1';\r\n\t\tif (sideid === 'p4') return 'p2';\r\n\t\treturn '';\r\n\t}\r\n\r\n\tteam(side: string, isFar: boolean = false) {\r\n\t\tside = side.slice(0, 2);\r\n\t\tif (side === this.perspective || side === BattleTextParser.allyID(side as SideID)) {\r\n\t\t\treturn !isFar ? BattleText.default.team : BattleText.default.opposingTeam;\r\n\t\t}\r\n\t\treturn isFar ? BattleText.default.team : BattleText.default.opposingTeam;\r\n\t}\r\n\r\n\town(side: string) {\r\n\t\tside = side.slice(0, 2);\r\n\t\tif (side === this.perspective) {\r\n\t\t\treturn 'OWN';\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tparty(side: string) {\r\n\t\tside = side.slice(0, 2);\r\n\t\tif (side === this.perspective || side === BattleTextParser.allyID(side as SideID)) {\r\n\t\t\treturn BattleText.default.party;\r\n\t\t}\r\n\t\treturn BattleText.default.opposingParty;\r\n\t}\r\n\r\n\tstatic effectId(effect?: string) {\r\n\t\tif (!effect) return '';\r\n\t\tif (effect.startsWith('item:') || effect.startsWith('move:')) {\r\n\t\t\teffect = effect.slice(5);\r\n\t\t} else if (effect.startsWith('ability:')) {\r\n\t\t\teffect = effect.slice(8);\r\n\t\t}\r\n\t\treturn toID(effect);\r\n\t}\r\n\r\n\teffect(effect?: string) {\r\n\t\tif (!effect) return '';\r\n\t\tif (effect.startsWith('item:') || effect.startsWith('move:')) {\r\n\t\t\teffect = effect.slice(5);\r\n\t\t} else if (effect.startsWith('ability:')) {\r\n\t\t\teffect = effect.slice(8);\r\n\t\t}\r\n\t\treturn effect.trim();\r\n\t}\r\n\r\n\ttemplate(type: string, ...namespaces: (string | undefined)[]) {\r\n\t\tfor (const namespace of namespaces) {\r\n\t\t\tif (!namespace) continue;\r\n\t\t\tif (namespace === 'OWN') {\r\n\t\t\t\treturn BattleText.default[type + 'Own'] + '\\n';\r\n\t\t\t}\r\n\t\t\tif (namespace === 'NODEFAULT') {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\tlet id = BattleTextParser.effectId(namespace);\r\n\t\t\tif (BattleText[id] && type in BattleText[id]) {\r\n\t\t\t\tif (BattleText[id][type].charAt(1) === '.') type = BattleText[id][type].slice(2) as ID;\r\n\t\t\t\tif (BattleText[id][type].charAt(0) === '#') id = BattleText[id][type].slice(1) as ID;\r\n\t\t\t\tif (!BattleText[id][type]) return '';\r\n\t\t\t\treturn BattleText[id][type] + '\\n';\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!BattleText.default[type]) return '';\r\n\t\treturn BattleText.default[type] + '\\n';\r\n\t}\r\n\r\n\tmaybeAbility(effect: string | undefined, holder: string) {\r\n\t\tif (!effect) return '';\r\n\t\tif (!effect.startsWith('ability:')) return '';\r\n\t\treturn this.ability(effect.slice(8).trim(), holder);\r\n\t}\r\n\r\n\tability(name: string | undefined, holder: string) {\r\n\t\tif (!name) return '';\r\n\t\treturn BattleText.default.abilityActivation.replace('[POKEMON]', this.pokemon(holder)).replace('[ABILITY]', this.effect(name)) + '\\n';\r\n\t}\r\n\r\n\tstatic stat(stat: string) {\r\n\t\tconst entry = BattleText[stat || \"stats\"];\r\n\t\tif (!entry || !entry.statName) return `???stat:${stat}???`;\r\n\t\treturn entry.statName;\r\n\t}\r\n\r\n\tlineSection(args: Args, kwArgs: KWArgs) {\r\n\t\tconst cmd = args[0];\r\n\t\tswitch (cmd) {\r\n\t\tcase 'done' : case 'turn':\r\n\t\t\treturn 'break';\r\n\t\tcase 'move' : case 'cant': case 'switch': case 'drag': case 'upkeep': case 'start': case '-mega': case '-candynamax':\r\n\t\t\treturn 'major';\r\n\t\tcase 'switchout': case 'faint':\r\n\t\t\treturn 'preMajor';\r\n\t\tcase '-zpower':\r\n\t\t\treturn 'postMajor';\r\n\t\tcase '-damage': {\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (id === 'confusion') return 'major';\r\n\t\t\treturn 'postMajor';\r\n\t\t}\r\n\t\tcase '-curestatus': {\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (id === 'naturalcure') return 'preMajor';\r\n\t\t\treturn 'postMajor';\r\n\t\t}\r\n\t\tcase '-start': {\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (id === 'protean') return 'preMajor';\r\n\t\t\treturn 'postMajor';\r\n\t\t}\r\n\t\tcase '-activate': {\r\n\t\t\tconst id = BattleTextParser.effectId(args[2]);\r\n\t\t\tif (id === 'confusion' || id === 'attract') return 'preMajor';\r\n\t\t\treturn 'postMajor';\r\n\t\t}\r\n\t\t}\r\n\t\treturn (cmd.charAt(0) === '-' ? 'postMajor' : '');\r\n\t}\r\n\r\n\tsectionBreak(args: Args, kwArgs: KWArgs) {\r\n\t\tconst prevSection = this.curLineSection;\r\n\t\tconst curSection = this.lineSection(args, kwArgs);\r\n\t\tif (!curSection) return false;\r\n\t\tthis.curLineSection = curSection;\r\n\t\tswitch (curSection) {\r\n\t\tcase 'break':\r\n\t\t\tif (prevSection !== 'break') return true;\r\n\t\t\treturn false;\r\n\t\tcase 'preMajor':\r\n\t\tcase 'major':\r\n\t\t\tif (prevSection === 'postMajor' || prevSection === 'major') return true;\r\n\t\t\treturn false;\r\n\t\tcase 'postMajor':\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tparseArgs(args: Args, kwArgs: KWArgs, noSectionBreak?: boolean) {\r\n\t\tlet buf = !noSectionBreak && this.sectionBreak(args, kwArgs) ? '\\n' : '';\r\n\t\treturn buf + this.fixLowercase(this.parseArgsInner(args, kwArgs) || '');\r\n\t}\r\n\r\n\tparseArgsInner(args: Args, kwArgs: KWArgs) {\r\n\t\tlet cmd = args[0];\r\n\t\tswitch (cmd) {\r\n\t\tcase 'player': {\r\n\t\t\tconst [, side, name] = args;\r\n\t\t\tif (side === 'p1' && name) {\r\n\t\t\t\tthis.p1 = name;\r\n\t\t\t} else if (side === 'p2' && name) {\r\n\t\t\t\tthis.p2 = name;\r\n\t\t\t} else if (side === 'p3' && name) {\r\n\t\t\t\tthis.p3 = name;\r\n\t\t\t} else if (side === 'p4' && name) {\r\n\t\t\t\tthis.p4 = name;\r\n\t\t\t}\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tcase 'gen': {\r\n\t\t\tconst [, num] = args;\r\n\t\t\tthis.gen = parseInt(num, 10);\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tcase 'turn': {\r\n\t\t\tconst [, num] = args;\r\n\t\t\tthis.turn = Number.parseInt(num, 10);\r\n\t\t\treturn this.template('turn').replace('[NUMBER]', num) + '\\n';\r\n\t\t}\r\n\r\n\t\tcase 'start': {\r\n\t\t\treturn this.template('startBattle').replace('[TRAINER]', this.p1).replace('[TRAINER]', this.p2);\r\n\t\t}\r\n\r\n\t\tcase 'win': case 'tie': {\r\n\t\t\tconst [, name] = args;\r\n\t\t\tif (cmd === 'tie' || !name) {\r\n\t\t\t\treturn this.template('tieBattle').replace('[TRAINER]', this.p1).replace('[TRAINER]', this.p2);\r\n\t\t\t}\r\n\t\t\treturn this.template('winBattle').replace('[TRAINER]', name);\r\n\t\t}\r\n\r\n\t\tcase 'switch': {\r\n\t\t\tconst [, pokemon, details] = args;\r\n\t\t\tconst [side, fullname] = this.pokemonFull(pokemon, details);\r\n\t\t\tconst template = this.template('switchIn', this.own(side));\r\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[FULLNAME]', fullname);\r\n\t\t}\r\n\r\n\t\tcase 'drag': {\r\n\t\t\tconst [, pokemon, details] = args;\r\n\t\t\tconst [side, fullname] = this.pokemonFull(pokemon, details);\r\n\t\t\tconst template = this.template('drag');\r\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[FULLNAME]', fullname);\r\n\t\t}\r\n\r\n\t\tcase 'detailschange': case '-transform': case '-formechange': {\r\n\t\t\tconst [, pokemon, arg2, arg3] = args;\r\n\t\t\tlet newSpecies = '';\r\n\t\t\tswitch (cmd) {\r\n\t\t\tcase 'detailschange': newSpecies = arg2.split(',')[0].trim(); break;\r\n\t\t\tcase '-transform': newSpecies = arg3; break;\r\n\t\t\tcase '-formechange': newSpecies = arg2; break;\r\n\t\t\t}\r\n\t\t\tlet newSpeciesId = toID(newSpecies);\r\n\t\t\tlet id = '';\r\n\t\t\tlet templateName = 'transform';\r\n\t\t\tif (cmd !== '-transform') {\r\n\t\t\t\tswitch (newSpeciesId) {\r\n\t\t\t\tcase 'greninjaash': id = 'battlebond'; break;\r\n\t\t\t\tcase 'mimikyubusted': id = 'disguise'; break;\r\n\t\t\t\tcase 'zygardecomplete': id = 'powerconstruct'; break;\r\n\t\t\t\tcase 'necrozmaultra': id = 'ultranecroziumz'; break;\r\n\t\t\t\tcase 'darmanitanzen': id = 'zenmode'; break;\r\n\t\t\t\tcase 'darmanitan': id = 'zenmode'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'darmanitangalarzen': id = 'zenmode'; break;\r\n\t\t\t\tcase 'darmanitangalar': id = 'zenmode'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'aegislashblade': id = 'stancechange'; break;\r\n\t\t\t\tcase 'aegislash': id = 'stancechange'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'wishiwashischool': id = 'schooling'; break;\r\n\t\t\t\tcase 'wishiwashi': id = 'schooling'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'miniormeteor': id = 'shieldsdown'; break;\r\n\t\t\t\tcase 'minior': id = 'shieldsdown'; templateName = 'transformEnd'; break;\r\n\t\t\t\tcase 'eiscuenoice': id = 'iceface'; break;\r\n\t\t\t\tcase 'eiscue': id = 'iceface'; templateName = 'transformEnd'; break;\r\n\t\t\t\t}\r\n\t\t\t} else if (newSpecies) {\r\n\t\t\t\tid = 'transform';\r\n\t\t\t}\r\n\t\t\tconst template = this.template(templateName, id, kwArgs.msg ? '' : 'NODEFAULT');\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SPECIES]', newSpecies);\r\n\t\t}\r\n\r\n\t\tcase 'switchout': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst side = pokemon.slice(0, 2);\r\n\t\t\tconst template = this.template('switchOut', kwArgs.from, this.own(side));\r\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side)).replace('[NICKNAME]', this.pokemonName(pokemon)).replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase 'faint': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst template = this.template('faint');\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase 'swap': {\r\n\t\t\tconst [, pokemon, target] = args;\r\n\t\t\tif (!target || !isNaN(Number(target))) {\r\n\t\t\t\tconst template = this.template('swapCenter');\r\n\t\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('swap');\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase 'move': {\r\n\t\t\tconst [, pokemon, move] = args;\r\n\t\t\tlet line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (kwArgs.zeffect) {\r\n\t\t\t\tline1 = this.template('zEffect').replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('move', kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', move);\r\n\t\t}\r\n\r\n\t\tcase 'cant': {\r\n\t\t\tlet [, pokemon, effect, move] = args;\r\n\t\t\tconst template = this.template('cant', effect, 'NODEFAULT') ||\r\n\t\t\t\tthis.template(move ? 'cant' : 'cantNoMove');\r\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', move);\r\n\t\t}\r\n\r\n\t\tcase '-candynamax': {\r\n\t\t\tlet [, side] = args;\r\n\t\t\tconst own = this.own(side);\r\n\t\t\tlet template = '';\r\n\t\t\tif (this.turn === 1) {\r\n\t\t\t\tif (own) template = this.template('canDynamax', own);\r\n\t\t\t} else {\r\n\t\t\t\ttemplate = this.template('canDynamax', own);\r\n\t\t\t}\r\n\t\t\treturn template.replace('[TRAINER]', this.trainer(side));\r\n\t\t}\r\n\r\n\t\tcase 'message': {\r\n\t\t\tlet [, message] = args;\r\n\t\t\treturn '' + message + '\\n';\r\n\t\t}\r\n\r\n\t\tcase '-start': {\r\n\t\t\tlet [, pokemon, effect, arg3] = args;\r\n\t\t\tconst line1 = this.maybeAbility(effect, pokemon) || this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tif (id === 'typechange') {\r\n\t\t\t\tconst template = this.template('typeChange', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TYPE]', arg3).replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tif (id === 'typeadd') {\r\n\t\t\t\tconst template = this.template('typeAdd', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TYPE]', arg3);\r\n\t\t\t}\r\n\t\t\tif (id.startsWith('stockpile')) {\r\n\t\t\t\tconst num = id.slice(9);\r\n\t\t\t\tconst template = this.template('start', 'stockpile');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[NUMBER]', num);\r\n\t\t\t}\r\n\t\t\tif (id.startsWith('perish')) {\r\n\t\t\t\tconst num = id.slice(6);\r\n\t\t\t\tconst template = this.template('activate', 'perishsong');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[NUMBER]', num);\r\n\t\t\t}\r\n\t\t\tlet templateId = 'start';\r\n\t\t\tif (kwArgs.already) templateId = 'alreadyStarted';\r\n\t\t\tif (kwArgs.fatigue) templateId = 'startFromFatigue';\r\n\t\t\tif (kwArgs.zeffect) templateId = 'startFromZEffect';\r\n\t\t\tif (kwArgs.damage) templateId = 'activate';\r\n\t\t\tif (kwArgs.block) templateId = 'block';\r\n\t\t\tif (kwArgs.upkeep) templateId = 'upkeep';\r\n\t\t\tif (id === 'mist' && this.gen <= 2) templateId = 'startGen' + this.gen;\r\n\t\t\tif (id === 'reflect' || id === 'lightscreen') templateId = 'startGen1';\r\n\t\t\tif (templateId === 'start' && kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\ttemplateId += 'FromItem';\r\n\t\t\t}\r\n\t\t\tconst template = this.template(templateId, effect);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(effect)).replace('[MOVE]', arg3).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t}\r\n\r\n\t\tcase '-end': {\r\n\t\t\tlet [, pokemon, effect] = args;\r\n\t\t\tconst line1 = this.maybeAbility(effect, pokemon) || this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tif (id === 'doomdesire' || id === 'futuresight') {\r\n\t\t\t\tconst template = this.template('activate', effect);\r\n\t\t\t\treturn line1 + template.replace('[TARGET]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tlet templateId = 'end';\r\n\t\t\tlet template = '';\r\n\t\t\tif (kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\ttemplate = this.template('endFromItem', effect);\r\n\t\t\t}\r\n\t\t\tif (!template) template = this.template(templateId, effect);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(effect)).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t}\r\n\r\n\t\tcase '-ability': {\r\n\t\t\tlet [, pokemon, ability, oldAbility, arg4] = args;\r\n\t\t\tlet line1 = '';\r\n\t\t\tif (oldAbility && (oldAbility.startsWith('p1') || oldAbility.startsWith('p2') || oldAbility === 'boost')) {\r\n\t\t\t\targ4 = oldAbility;\r\n\t\t\t\toldAbility = '';\r\n\t\t\t}\r\n\t\t\tif (oldAbility) line1 += this.ability(oldAbility, pokemon);\r\n\t\t\tline1 += this.ability(ability, pokemon);\r\n\t\t\tif (kwArgs.fail) {\r\n\t\t\t\tconst template = this.template('block', kwArgs.from);\r\n\t\t\t\treturn line1 + template;\r\n\t\t\t}\r\n\t\t\tif (kwArgs.from) {\r\n\t\t\t\tline1 = this.maybeAbility(kwArgs.from, pokemon) + line1;\r\n\t\t\t\tconst template = this.template('changeAbility', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ABILITY]', this.effect(ability)).replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tconst id = BattleTextParser.effectId(ability);\r\n\t\t\tif (id === 'unnerve') {\r\n\t\t\t\tconst template = this.template('start', ability);\r\n\t\t\t\treturn line1 + template.replace('[TEAM]', this.team(pokemon.slice(0, 2), true));\r\n\t\t\t}\r\n\t\t\tlet templateId = 'start';\r\n\t\t\tif (id === 'anticipation' || id === 'sturdy') templateId = 'activate';\r\n\t\t\tconst template = this.template(templateId, ability, 'NODEFAULT');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-endability': {\r\n\t\t\tlet [, pokemon, ability] = args;\r\n\t\t\tif (ability) return this.ability(ability, pokemon);\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('start', 'Gastro Acid');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-item': {\r\n\t\t\tconst [, pokemon, item] = args;\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tlet target = '';\r\n\t\t\tif (['magician', 'pickpocket'].includes(id)) {\r\n\t\t\t\t[target, kwArgs.of] = [kwArgs.of, ''];\r\n\t\t\t}\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (['thief', 'covet', 'bestow', 'magician', 'pickpocket'].includes(id)) {\r\n\t\t\t\tconst template = this.template('takeItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item)).replace('[SOURCE]', this.pokemon(target || kwArgs.of));\r\n\t\t\t}\r\n\t\t\tif (id === 'frisk') {\r\n\t\t\t\tconst hasTarget = kwArgs.of && pokemon && kwArgs.of !== pokemon;\r\n\t\t\t\tconst template = this.template(hasTarget ? 'activate' : 'activateNoTarget', \"Frisk\");\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(item)).replace('[TARGET]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.from) {\r\n\t\t\t\tconst template = this.template('addItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('start', item, 'NODEFAULT');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-enditem': {\r\n\t\t\tlet [, pokemon, item] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (kwArgs.eat) {\r\n\t\t\t\tconst template = this.template('eatItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\r\n\t\t\t}\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (id === 'gem') {\r\n\t\t\t\tconst template = this.template('useGem', item);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item)).replace('[MOVE]', kwArgs.move);\r\n\t\t\t}\r\n\t\t\tif (id === 'stealeat') {\r\n\t\t\t\tconst template = this.template('removeItem', \"Bug Bite\");\r\n\t\t\t\treturn line1 + template.replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[ITEM]', this.effect(item));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.from) {\r\n\t\t\t\tconst template = this.template('removeItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item)).replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.weaken) {\r\n\t\t\t\tconst template = this.template('activateWeaken');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(item));\r\n\t\t\t}\r\n\t\t\tlet template = this.template('end', item, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('activateItem').replace('[ITEM]', this.effect(item));\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(kwArgs.of));\r\n\t\t}\r\n\r\n\t\tcase '-status': {\r\n\t\t\tconst [, pokemon, status] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'rest') {\r\n\t\t\t\tconst template = this.template('startFromRest', status);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('start', status);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-curestatus': {\r\n\t\t\tconst [, pokemon, status] = args;\r\n\t\t\tif (BattleTextParser.effectId(kwArgs.from) === 'naturalcure') {\r\n\t\t\t\tconst template = this.template('activate', kwArgs.from);\r\n\t\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\tconst template = this.template('endFromItem', status);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.thaw) {\r\n\t\t\t\tconst template = this.template('endFromMove', status);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\t\t\tlet template = this.template('end', status, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('end').replace('[EFFECT]', status);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-cureteam': {\r\n\t\t\treturn this.template('activate', kwArgs.from);\r\n\t\t}\r\n\r\n\t\tcase '-singleturn': case '-singlemove': {\r\n\t\t\tconst [, pokemon, effect] = args;\r\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon) ||\r\n\t\t\t\tthis.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tif (id === 'instruct') {\r\n\t\t\t\tconst template = this.template('activate', effect);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[TARGET]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\t\t\tlet template = this.template('start', effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('start').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[TEAM]', this.team(pokemon.slice(0, 2)));\r\n\t\t}\r\n\r\n\t\tcase '-sidestart': {\r\n\t\t\tlet [, side, effect] = args;\r\n\t\t\tlet template = this.template('start', effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('startTeamEffect').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn template.replace('[TEAM]', this.team(side)).replace('[PARTY]', this.party(side));\r\n\t\t}\r\n\r\n\t\tcase '-sideend': {\r\n\t\t\tlet [, side, effect] = args;\r\n\t\t\tlet template = this.template('end', effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('endTeamEffect').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn template.replace('[TEAM]', this.team(side)).replace('[PARTY]', this.party(side));\r\n\t\t}\r\n\r\n\t\tcase '-weather': {\r\n\t\t\tconst [, weather] = args;\r\n\t\t\tif (!weather || weather === 'none') {\r\n\t\t\t\tconst template = this.template('end', kwArgs.from, 'NODEFAULT');\r\n\t\t\t\tif (!template) return this.template('endFieldEffect').replace('[EFFECT]', this.effect(weather));\r\n\t\t\t\treturn template;\r\n\t\t\t}\r\n\t\t\tif (kwArgs.upkeep) {\r\n\t\t\t\treturn this.template('upkeep', weather, 'NODEFAULT');\r\n\t\t\t}\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of);\r\n\t\t\tlet template = this.template('start', weather, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('startFieldEffect').replace('[EFFECT]', this.effect(weather));\r\n\t\t\treturn line1 + template;\r\n\t\t}\r\n\r\n\t\tcase '-fieldstart': case '-fieldactivate': {\r\n\t\t\tconst [, effect] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of);\r\n\t\t\tlet templateId = cmd.slice(6);\r\n\t\t\tif (BattleTextParser.effectId(effect) === 'perishsong') templateId = 'start';\r\n\t\t\tlet template = this.template(templateId, effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('startFieldEffect').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of));\r\n\t\t}\r\n\r\n\t\tcase '-fieldend': {\r\n\t\t\tlet [, effect] = args;\r\n\t\t\tlet template = this.template('end', effect, 'NODEFAULT');\r\n\t\t\tif (!template) template = this.template('endFieldEffect').replace('[EFFECT]', this.effect(effect));\r\n\t\t\treturn template;\r\n\t\t}\r\n\r\n\t\tcase '-sethp': {\r\n\t\t\tlet effect = kwArgs.from;\r\n\t\t\treturn this.template('activate', effect);\r\n\t\t}\r\n\r\n\t\tcase '-message': {\r\n\t\t\tlet [, message] = args;\r\n\t\t\treturn '  ' + message + '\\n';\r\n\t\t}\r\n\r\n\t\tcase '-hint': {\r\n\t\t\tlet [, message] = args;\r\n\t\t\treturn '  (' + message + ')\\n';\r\n\t\t}\r\n\r\n\t\tcase '-activate': {\r\n\t\t\tlet [, pokemon, effect, target] = args;\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tif (id === 'celebrate') {\r\n\t\t\t\treturn this.template('activate', 'celebrate').replace('[TRAINER]', this.trainer(pokemon.slice(0, 2)));\r\n\t\t\t}\r\n\t\t\tif (!target && ['hyperspacefury', 'hyperspacehole', 'phantomforce', 'shadowforce', 'feint'].includes(id)) {\r\n\t\t\t\t[pokemon, target] = [kwArgs.of, pokemon];\r\n\t\t\t\tif (!pokemon) pokemon = target;\r\n\t\t\t}\r\n\t\t\tif (!target) target = kwArgs.of || pokemon;\r\n\r\n\t\t\tlet line1 = this.maybeAbility(effect, pokemon);\r\n\r\n\t\t\tif (id === 'lockon' || id === 'mindreader') {\r\n\t\t\t\tconst template = this.template('start', effect);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(kwArgs.of)).replace('[SOURCE]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'mummy' && kwArgs.ability) {\r\n\t\t\t\tline1 += this.ability(kwArgs.ability, target);\r\n\t\t\t\tline1 += this.ability('Mummy', target);\r\n\t\t\t\tconst template = this.template('changeAbility', 'mummy');\r\n\t\t\t\treturn line1 + template.replace('[TARGET]', this.pokemon(target));\r\n\t\t\t}\r\n\r\n\t\t\tlet templateId = 'activate';\r\n\t\t\tif (id === 'forewarn' && pokemon === target) {\r\n\t\t\t\ttemplateId = 'activateNoTarget';\r\n\t\t\t}\r\n\t\t\tlet template = this.template(templateId, effect, 'NODEFAULT');\r\n\t\t\tif (!template) {\r\n\t\t\t\tif (line1) return line1; // Abilities don't have a default template\r\n\t\t\t\ttemplate = this.template('activate');\r\n\t\t\t\treturn line1 + template.replace('[EFFECT]', this.effect(effect));\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'brickbreak') {\r\n\t\t\t\ttemplate = template.replace('[TEAM]', this.team(target.slice(0, 2)));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.ability) {\r\n\t\t\t\tline1 += this.ability(kwArgs.ability, pokemon);\r\n\t\t\t}\r\n\t\t\tif (kwArgs.ability2) {\r\n\t\t\t\tline1 += this.ability(kwArgs.ability2, target);\r\n\t\t\t}\r\n\t\t\tif (kwArgs.move || kwArgs.number || kwArgs.item || kwArgs.name) {\r\n\t\t\t\ttemplate = template.replace('[MOVE]', kwArgs.move).replace('[NUMBER]', kwArgs.number).replace('[ITEM]', kwArgs.item).replace('[NAME]', kwArgs.name);\r\n\t\t\t}\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target)).replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t}\r\n\r\n\t\tcase '-prepare': {\r\n\t\t\tconst [, pokemon, effect, target] = args;\r\n\t\t\tconst template = this.template('prepare', effect);\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase '-damage': {\r\n\t\t\tlet [, pokemon, , percentage] = args;\r\n\t\t\tlet template = this.template('damage', kwArgs.from, 'NODEFAULT');\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tif (template) {\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\r\n\t\t\tif (!kwArgs.from) {\r\n\t\t\t\ttemplate = this.template(percentage ? 'damagePercentage' : 'damage');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[PERCENTAGE]', percentage);\r\n\t\t\t}\r\n\t\t\tif (kwArgs.from.startsWith('item:')) {\r\n\t\t\t\ttemplate = this.template(kwArgs.of ? 'damageFromPokemon' : 'damageFromItem');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[ITEM]', this.effect(kwArgs.from)).replace('[SOURCE]', this.pokemon(kwArgs.of));\r\n\t\t\t}\r\n\t\t\tif (kwArgs.partiallytrapped || id === 'bind' || id === 'wrap') {\r\n\t\t\t\ttemplate = this.template('damageFromPartialTrapping');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[MOVE]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\r\n\t\t\ttemplate = this.template('damage');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-heal': {\r\n\t\t\tlet [, pokemon] = args;\r\n\t\t\tlet template = this.template('heal', kwArgs.from, 'NODEFAULT');\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, pokemon);\r\n\t\t\tif (template) {\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(kwArgs.of)).replace('[NICKNAME]', kwArgs.wisher);\r\n\t\t\t}\r\n\r\n\t\t\tif (kwArgs.from && !kwArgs.from.startsWith('ability:')) {\r\n\t\t\t\ttemplate = this.template('healFromEffect');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[EFFECT]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\r\n\t\t\ttemplate = this.template('heal');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-boost': case '-unboost': {\r\n\t\t\tlet [, pokemon, stat, num] = args;\r\n\t\t\tif (stat === 'spa' && this.gen === 1) stat = 'spc';\r\n\t\t\tconst amount = parseInt(num, 10);\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet templateId = cmd.slice(1);\r\n\t\t\tif (amount >= 3) templateId += '3';\r\n\t\t\telse if (amount >= 2) templateId += '2';\r\n\t\t\telse if (amount === 0) templateId += '0';\r\n\t\t\tif (amount && kwArgs.zeffect) {\r\n\t\t\t\ttemplateId += (kwArgs.multiple ? 'MultipleFromZEffect' : 'FromZEffect');\r\n\t\t\t} else if (amount && kwArgs.from?.startsWith('item:')) {\r\n\t\t\t\tconst template = this.template(templateId + 'FromItem', kwArgs.from);\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', BattleTextParser.stat(stat)).replace('[ITEM]', this.effect(kwArgs.from));\r\n\t\t\t}\r\n\t\t\tconst template = this.template(templateId, kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', BattleTextParser.stat(stat));\r\n\t\t}\r\n\r\n\t\tcase '-setboost': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst effect = kwArgs.from;\r\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('boost', effect);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-swapboost': {\r\n\t\t\tconst [, pokemon, target] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst id = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tlet templateId = 'swapBoost';\r\n\t\t\tif (id === 'guardswap') templateId = 'swapDefensiveBoost';\r\n\t\t\tif (id === 'powerswap') templateId = 'swapOffensiveBoost';\r\n\t\t\tconst template = this.template(templateId, kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase '-copyboost': {\r\n\t\t\tconst [, pokemon, target] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('copyBoost', kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase '-clearboost': case '-clearpositiveboost': case '-clearnegativeboost': {\r\n\t\t\tconst [, pokemon, source] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet templateId = 'clearBoost';\r\n\t\t\tif (kwArgs.zeffect) templateId = 'clearBoostFromZEffect';\r\n\t\t\tconst template = this.template(templateId, kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(source));\r\n\t\t}\r\n\r\n\t\tcase '-invertboost': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tconst template = this.template('invertBoost', kwArgs.from);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-clearallboost': {\r\n\t\t\treturn this.template('clearAllBoost', kwArgs.from);\r\n\t\t}\r\n\r\n\t\tcase '-crit': case '-supereffective': case '-resisted': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tlet templateId = cmd.slice(1);\r\n\t\t\tif (templateId === 'supereffective') templateId = 'superEffective';\r\n\t\t\tif (kwArgs.spread) templateId += 'Spread';\r\n\t\t\tconst template = this.template(templateId);\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-block': {\r\n\t\t\tlet [, pokemon, effect, move, attacker] = args;\r\n\t\t\tconst line1 = this.maybeAbility(effect, kwArgs.of || pokemon);\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tlet templateId = 'block';\r\n\t\t\tif (id === 'mist' && this.gen <= 2) templateId = 'blockGen' + this.gen;\r\n\t\t\tconst template = this.template(templateId, effect);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[SOURCE]', this.pokemon(attacker || kwArgs.of)).replace('[MOVE]', move);\r\n\t\t}\r\n\r\n\t\tcase '-fail': {\r\n\t\t\tlet [, pokemon, effect, stat] = args;\r\n\t\t\tlet id = BattleTextParser.effectId(effect);\r\n\t\t\tlet blocker = BattleTextParser.effectId(kwArgs.from);\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet templateId = 'block';\r\n\t\t\tif (['desolateland', 'primordialsea'].includes(blocker) &&\r\n\t\t\t\t!['sunnyday', 'raindance', 'sandstorm', 'hail'].includes(id)) {\r\n\t\t\t\ttemplateId = 'blockMove';\r\n\t\t\t} else if (blocker === 'uproar' && kwArgs.msg) {\r\n\t\t\t\ttemplateId = 'blockSelf';\r\n\t\t\t}\r\n\t\t\tlet template = this.template(templateId, kwArgs.from);\r\n\t\t\tif (template) {\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t\t}\r\n\r\n\t\t\tif (id === 'unboost') {\r\n\t\t\t\ttemplate = this.template(stat ? 'failSingular' : 'fail', 'unboost');\r\n\t\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[STAT]', stat);\r\n\t\t\t}\r\n\r\n\t\t\ttemplateId = 'fail';\r\n\t\t\tif (['brn', 'frz', 'par', 'psn', 'slp', 'substitute'].includes(id)) {\r\n\t\t\t\ttemplateId = 'alreadyStarted';\r\n\t\t\t}\r\n\t\t\tif (kwArgs.heavy) templateId = 'failTooHeavy';\r\n\t\t\tif (kwArgs.weak) templateId = 'fail';\r\n\t\t\tif (kwArgs.forme) templateId = 'failWrongForme';\r\n\t\t\ttemplate = this.template(templateId, id);\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-immune': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tlet template = this.template('block', kwArgs.from);\r\n\t\t\tif (!template) {\r\n\t\t\t\tconst templateId = kwArgs.ohko ? 'immuneOHKO' : 'immune';\r\n\t\t\t\ttemplate = this.template(pokemon ? templateId : 'immuneNoPokemon', kwArgs.from);\r\n\t\t\t}\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-miss': {\r\n\t\t\tconst [, source, pokemon] = args;\r\n\t\t\tconst line1 = this.maybeAbility(kwArgs.from, kwArgs.of || pokemon);\r\n\t\t\tif (!pokemon) {\r\n\t\t\t\tconst template = this.template('missNoPokemon');\r\n\t\t\t\treturn line1 + template.replace('[SOURCE]', this.pokemon(source));\r\n\t\t\t}\r\n\t\t\tconst template = this.template('miss');\r\n\t\t\treturn line1 + template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-center': case '-ohko': case '-combine': {\r\n\t\t\treturn this.template(cmd.slice(1));\r\n\t\t}\r\n\r\n\t\tcase '-notarget': {\r\n\t\t\treturn this.template('noTarget');\r\n\t\t}\r\n\r\n\t\tcase '-mega': case '-primal': {\r\n\t\t\tconst [, pokemon, species, item] = args;\r\n\t\t\tlet id = '';\r\n\t\t\tlet templateId = cmd.slice(1);\r\n\t\t\tif (species === 'Rayquaza') {\r\n\t\t\t\tid = 'dragonascent';\r\n\t\t\t\ttemplateId = 'megaNoItem';\r\n\t\t\t}\r\n\t\t\tif (!id && cmd === '-mega' && this.gen < 7) templateId = 'megaGen6';\r\n\t\t\tif (!item && cmd === '-mega') templateId = 'megaNoItem';\r\n\t\t\tlet template = this.template(templateId, id);\r\n\t\t\tconst side = pokemon.slice(0, 2);\r\n\t\t\tconst pokemonName = this.pokemon(pokemon);\r\n\t\t\tif (cmd === '-mega') {\r\n\t\t\t\tconst template2 = this.template('transformMega');\r\n\t\t\t\ttemplate += template2.replace('[POKEMON]', pokemonName).replace('[SPECIES]', species);\r\n\t\t\t}\r\n\t\t\treturn template.replace('[POKEMON]', pokemonName).replace('[ITEM]', item).replace('[TRAINER]', this.trainer(side));\r\n\t\t}\r\n\r\n\t\tcase '-zpower': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst template = this.template('zPower');\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-burst': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst template = this.template('activate', \"Ultranecrozium Z\");\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-zbroken': {\r\n\t\t\tconst [, pokemon] = args;\r\n\t\t\tconst template = this.template('zBroken');\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon));\r\n\t\t}\r\n\r\n\t\tcase '-hitcount': {\r\n\t\t\tconst [, , num] = args;\r\n\t\t\tif (num === '1') {\r\n\t\t\t\treturn this.template('hitCountSingular');\r\n\t\t\t}\r\n\t\t\treturn this.template('hitCount').replace('[NUMBER]', num);\r\n\t\t}\r\n\r\n\t\tcase '-waiting': {\r\n\t\t\tconst [, pokemon, target] = args;\r\n\t\t\tconst template = this.template('activate', \"Water Pledge\");\r\n\t\t\treturn template.replace('[POKEMON]', this.pokemon(pokemon)).replace('[TARGET]', this.pokemon(target));\r\n\t\t}\r\n\r\n\t\tcase '-anim': {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tdefault: {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nif (typeof require === 'function') {\r\n\t// in Node\r\n\t(global as any).BattleTextParser = BattleTextParser;\r\n}\r\n"]}